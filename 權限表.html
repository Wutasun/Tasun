<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tasun æ¬Šé™è¡¨</title>

  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --gold: #f6d37a;
      --gold-soft: rgba(246, 211, 122, 0.75);
      --panel-border: rgba(246, 211, 122, 0.35);
      --bg: #050302;
    }
    *{ box-sizing:border-box; margin:0; padding:0; }
    body{
      min-height:100vh;
      font-family:"Noto Serif TC","Microsoft JhengHei",serif;
      background:
        radial-gradient(circle at 50% 14%, rgba(255, 237, 180, 0.25), rgba(0,0,0,0.92) 62%),
        linear-gradient(180deg, rgba(0,0,0,0.75), rgba(0,0,0,0.95));
      color: var(--gold);
      overflow-x:hidden;
      padding: 14px 14px 24px;
    }

    .topbar{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content:flex-start;
      margin-bottom: 12px;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:.35rem 1.0rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,.55);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.18), rgba(0,0,0,0.88));
      box-shadow: 0 4px 12px rgba(0,0,0,0.65);
      color: rgba(246,211,122,0.92);
      font-size:.88rem;
      letter-spacing:.10em;
      text-indent:.10em;
    }
    .btn{
      border:1px solid rgba(246,211,122,.72);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.20), rgba(0,0,0,0.92));
      color: var(--gold);
      border-radius:999px;
      padding:.42rem 1.05rem;
      cursor:pointer;
      letter-spacing:.12em;
      text-indent:.12em;
      box-shadow: 0 10px 18px rgba(0,0,0,0.70);
      transition: transform .15s ease, box-shadow .2s ease, background .2s ease;
      white-space:nowrap;
      font-size:.92rem;
    }
    .btn:hover{ transform: translateY(-1px); box-shadow:0 14px 22px rgba(0,0,0,0.82); }
    .btn.ghost{ opacity:.9; border-color: rgba(246,211,122,.45); }

    .panel{
      max-width: 1200px;
      margin: 0 auto;
      border-radius: 22px;
      background: radial-gradient(circle at 30% 10%, rgba(246,211,122,0.14), rgba(0,0,0,0.88) 55%);
      border: 1px solid rgba(246,211,122,0.22);
      box-shadow: 0 18px 46px rgba(0,0,0,0.70);
      overflow:hidden;
    }
    .panel-hd{
      padding: 18px 18px 10px;
      border-bottom: 1px solid rgba(246,211,122,0.18);
    }
    .title{
      font-size: clamp(1.8rem, 3.2vw, 2.6rem);
      letter-spacing: .38em;
      text-indent: .38em;
      text-shadow: 0 0 18px rgba(246,211,122,0.55);
      color: rgba(246,211,122,0.92);
      font-family: "DFKai-SB","æ¨™æ¥·é«”","Noto Serif TC",serif;
    }
    .sub{
      margin-top: 8px;
      color: rgba(246,211,122,0.70);
      line-height: 1.8;
      font-size: .98rem;
      letter-spacing:.08em;
    }

    .table-wrap{
      padding: 14px 12px 18px;
      overflow:auto;
    }
    table{
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      min-width: 980px;
    }
    th{
      color: rgba(246,211,122,0.85);
      font-weight: 600;
      letter-spacing: .16em;
      text-indent: .16em;
      font-size: .92rem;
      text-align:center;
      padding: 10px 6px;
    }
    td{
      padding: 10px 6px;
      text-align:center;
      vertical-align:middle;
    }
    .cell-input{
      width: 100%;
      max-width: 260px;
      padding: .45rem .7rem;
      border-radius: 999px;
      border: 1px solid rgba(246,211,122,0.35);
      background: rgba(0,0,0,0.70);
      color: var(--gold);
      outline: none;
    }
    .cell-input:focus{
      border-color: rgba(255,238,190,0.9);
      box-shadow: 0 0 12px rgba(246,211,122,0.45);
    }
    .cell-select{
      width: 100%;
      max-width: 160px;
      padding: .45rem .7rem;
      border-radius: 999px;
      border: 1px solid rgba(246,211,122,0.35);
      background: rgba(0,0,0,0.70);
      color: var(--gold);
      outline: none;
    }

    .flag{
      width: 20px;
      height: 20px;
      accent-color: #f6d37a;
      cursor:pointer;
    }

    .row-card{
      background:
        radial-gradient(circle at 0% 0%, rgba(246,211,122,0.10), rgba(0,0,0,0.85));
      border: 1px solid rgba(246,211,122,0.18);
      border-radius: 16px;
      box-shadow: 0 10px 18px rgba(0,0,0,0.55);
    }

    .danger{
      color: #ffb3b3;
      font-size:.95rem;
      white-space: pre-line;
      margin: 10px 18px 0;
    }
    .ok{
      color: rgba(190,255,210,0.95);
      font-size:.92rem;
      white-space: pre-line;
      margin: 10px 18px 0;
    }

    .panel-ft{
      padding: 14px 18px 18px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      justify-content: space-between;
      border-top: 1px solid rgba(246,211,122,0.16);
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.00));
    }
    .ft-left, .ft-right{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; }

    /* Token overlay (same feel) */
    .token-overlay{
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 18px;
      z-index: 1200;
      background: radial-gradient(circle at 50% 18%, rgba(255, 228, 170, 0.32), rgba(0, 0, 0, 0.98));
    }
    .token-box{
      width: min(660px, 94vw);
      padding: 1.6rem 1.6rem 1.2rem;
      border-radius: 18px;
      background: radial-gradient(circle at 0% 0%, rgba(246, 211, 122, 0.22), rgba(0, 0, 0, 0.95));
      border: 1px solid rgba(246, 211, 122, 0.35);
      box-shadow: 0 0 28px rgba(0,0,0,0.92), 0 0 26px rgba(246,211,122,0.18);
      color: var(--gold-soft);
    }
    .token-title{
      text-align:center;
      font-size: 1.15rem;
      letter-spacing: 0.18em;
      text-indent: 0.18em;
      margin-bottom: 0.6rem;
      text-shadow: 0 0 14px rgba(246,211,122,0.55);
      color: rgba(246,211,122,0.92);
    }
    .token-hint{
      font-size: 0.9rem;
      line-height: 1.75;
      color: rgba(246,211,122,0.78);
      margin-bottom: 0.8rem;
      white-space: pre-line;
    }
    .token-row{ display:flex; align-items:center; gap: 0.5rem; margin-top: .5rem; flex-wrap: wrap; }
    .token-input{
      flex: 1 1 auto;
      width: 100%;
      padding: 0.55rem 0.7rem;
      border-radius: 999px;
      border: 1px solid rgba(246, 211, 122, 0.5);
      background: rgba(0, 0, 0, 0.82);
      color: var(--gold);
      outline: none;
    }
    .token-eye{
      padding: 0.26rem 0.75rem;
      border-radius: 999px;
      border: 1px solid rgba(246, 211, 122, 0.8);
      background: rgba(0,0,0,0.86);
      color: var(--gold);
      cursor: pointer;
      box-shadow: 0 0 8px rgba(0,0,0,0.65);
      white-space: nowrap;
    }
    .token-msg{
      margin-top: 0.65rem;
      min-height: 1.2rem;
      font-size: 0.85rem;
      color: rgba(255, 200, 200, 0.95);
      text-align: left;
      white-space: pre-line;
    }
    .mini-pill{
      display:inline-block;
      padding: .2rem .6rem;
      border-radius: 999px;
      border: 1px solid rgba(246,211,122,0.35);
      background: rgba(0,0,0,0.55);
      color: rgba(246,211,122,0.85);
      font-size: .82rem;
      margin-left: .35rem;
      letter-spacing: .06em;
      text-indent: .06em;
    }
    .mono{
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      color: rgba(255, 240, 200, 0.96);
    }

    @media (max-width: 980px){
      table{ min-width: 860px; }
    }
    @media (max-width: 640px){
      body{ padding: 12px 10px 18px; }
      table{ min-width: 760px; }
      .title{ letter-spacing:.28em; text-indent:.28em; }
    }
  </style>
</head>

<body>
  <div class="topbar">
    <div class="pill" id="pillUser">ç›®å‰ä½¿ç”¨è€…ï¼š-</div>
    <button class="btn" id="btnSwitch">åˆ‡æ›å¸³è™Ÿ</button>
    <button class="btn" id="btnHome">è¿”å›é¦–é </button>
    <button class="btn ghost" id="btnToken">è¨­å®š Token</button>
    <button class="btn ghost" id="btnCloudPull">é›²ç«¯ä¸‹è¼‰</button>
    <button class="btn ghost" id="btnCloudPush">å„²å­˜ä¸¦ä¸Šå‚³</button>
  </div>

  <div class="panel">
    <div class="panel-hd">
      <div class="title">Tasun æ¬Šé™è¡¨</div>
      <div class="sub" id="subHint">åªæœ‰ <b>admin</b> å¯ä»¥ç·¨è¼¯ï¼›å…¶ä»–æ¬Šé™åªèƒ½æŸ¥çœ‹ã€‚</div>
      <div class="danger" id="msgErr" style="display:none;"></div>
      <div class="ok" id="msgOk" style="display:none;"></div>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>ä½¿ç”¨è€…</th>
            <th>å¯†ç¢¼</th>
            <th>æ¬Šé™</th>
            <th>é¡¯ç¤º btn1</th>
            <th>é¡¯ç¤º btn2</th>
            <th>é¡¯ç¤º btn3</th>
            <th>é¡¯ç¤º btn4</th>
            <th>é¡¯ç¤º btn5</th>
            <th>ç³»çµ±/æ¬Šé™</th>
            <th>åˆªé™¤</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>

    <div class="panel-ft">
      <div class="ft-left">
        <button class="btn" id="btnAdd">ï¼‹ æ–°å¢ä¸€åˆ—</button>
        <button class="btn ghost" id="btnSaveLocal">åªå„²å­˜æœ¬æ©Ÿ</button>
      </div>
      <div class="ft-right">
        <span class="pill" id="pillStatus">ç‹€æ…‹ï¼š-</span>
      </div>
    </div>
  </div>

  <!-- Token overlay -->
  <div class="token-overlay" id="tokenOverlay" aria-hidden="true">
    <div class="token-box">
      <div class="token-title">Dropbox Token è¨­å®šï¼ˆApp folderï¼‰</div>
      <div class="token-hint">
â‘  ä½ çš„ Dropbox å¸³è™Ÿï¼š<b>tasun_8@hotmail.com</b>
â‘¡ Console â†’ Permissions å‹¾ scopes â†’ Submit â†’ Settings é‡æ–°ç”¢ç”Ÿ Access Token
â‘¢ æœ¬ç³»çµ±å¯«å…¥ï¼š<b class="mono">/Tasun/æ¬Šé™</b>ï¼ˆApp folder å…§ï¼‰
      </div>

      <div style="margin-top:.2rem;">
        <div style="font-size:.86rem; color:rgba(246,211,122,0.8); margin-bottom:.35rem;">
          Apps å…§ã€ŒApp è³‡æ–™å¤¾åã€<span class="mini-pill">ä¾‹å¦‚ï¼šwutasun</span>
        </div>
        <input class="token-input" id="appNameInput" type="text" placeholder="ä¾‹å¦‚ï¼šwutasun" />
      </div>

      <div style="margin-top:.65rem;">
        <div style="font-size:.86rem; color:rgba(246,211,122,0.8); margin-bottom:.35rem;">
          App keyï¼ˆinfo/&lt;é€™ä¸²&gt;#settingsï¼‰<span class="mini-pill">ä¾‹å¦‚ï¼ša5pm08kyb0bybdt</span>
        </div>
        <div class="token-row">
          <input class="token-input" id="appKeyInput" type="text" placeholder="è²¼ä¸Š App key" />
          <button class="btn ghost" id="btnOpenPerm" type="button">é–‹ Permissions</button>
          <button class="btn ghost" id="btnOpenSet" type="button">é–‹ Settings</button>
        </div>
      </div>

      <div style="margin-top:.7rem; font-size:.86rem; color:rgba(246,211,122,0.8); margin-bottom:.35rem;">
        Access Tokenï¼ˆä»¥ sl. é–‹é ­ï¼‰
      </div>
      <div class="token-row">
        <input class="token-input" id="tokenInput" type="password" placeholder="è²¼ä¸Š Access Tokenï¼ˆsl. é–‹é ­ï¼‰" />
        <button class="token-eye" id="tokenEyeBtn" type="button">ğŸ‘</button>
      </div>

      <div class="token-msg" id="tokenMsg"></div>

      <div style="margin-top: 10px; display:flex; gap:10px; justify-content:flex-end; flex-wrap:wrap;">
        <button class="btn ghost" id="btnGuide" type="button">ä¸€æ­¥ä¸€æ­¥å°è¦½</button>
        <button class="btn ghost" id="btnCloseToken" type="button">é—œé–‰</button>
        <button class="btn" id="btnSaveToken" type="button">å„²å­˜ä¸¦æ¸¬è©¦</button>
      </div>
    </div>
  </div>

  <script>
    // ==========================
    // keys / constants
    // ==========================
    const AUTH_KEY    = "tasunAuthTable_v1";
    const NAV_KEY     = "tasunNavButtons_v1";
    const CURRENT_KEY = "tasunCurrentUser_v1"; // session only (index ä¸€è‡´)

    const DBX_TOKEN_KEY   = "tasunDbxToken_v1";
    const DBX_FOLDER_KEY  = "tasunDbxFolder_v1";
    const DBX_APPNAME_KEY = "tasunDbxAppName_v1";
    const DBX_APPKEY_KEY  = "tasunDbxAppKey_v1";

    const DEFAULT_DBX_FOLDER = "/Tasun/æ¬Šé™";
    const DEFAULT_APP_NAME = "wutasun";
    const EXPECT_EMAIL = "tasun_8@hotmail.com";

    const AUTH_BRIDGE_CH = "tasunAuthBridge_v1";
    const TAB_ID_KEY = "tasunTabId_v1";
    const TAB_ID = (() => {
      let v = sessionStorage.getItem(TAB_ID_KEY);
      if(!v){
        v = "tab_" + Date.now() + "_" + Math.random().toString(16).slice(2);
        sessionStorage.setItem(TAB_ID_KEY, v);
      }
      return v;
    })();
    let bc = null;
    let bcReady = false;

    // ==========================
    // UI refs
    // ==========================
    const pillUser = document.getElementById("pillUser");
    const pillStatus = document.getElementById("pillStatus");
    const subHint = document.getElementById("subHint");
    const msgErr = document.getElementById("msgErr");
    const msgOk = document.getElementById("msgOk");

    const btnSwitch = document.getElementById("btnSwitch");
    const btnHome = document.getElementById("btnHome");
    const btnToken = document.getElementById("btnToken");
    const btnCloudPull = document.getElementById("btnCloudPull");
    const btnCloudPush = document.getElementById("btnCloudPush");
    const btnAdd = document.getElementById("btnAdd");
    const btnSaveLocal = document.getElementById("btnSaveLocal");

    const tbody = document.getElementById("tbody");

    // token overlay refs
    const tokenOverlay = document.getElementById("tokenOverlay");
    const appNameInput = document.getElementById("appNameInput");
    const appKeyInput  = document.getElementById("appKeyInput");
    const tokenInput   = document.getElementById("tokenInput");
    const tokenEyeBtn  = document.getElementById("tokenEyeBtn");
    const tokenMsg     = document.getElementById("tokenMsg");
    const btnSaveToken = document.getElementById("btnSaveToken");
    const btnCloseToken= document.getElementById("btnCloseToken");
    const btnGuide     = document.getElementById("btnGuide");
    const btnOpenPerm  = document.getElementById("btnOpenPerm");
    const btnOpenSet   = document.getElementById("btnOpenSet");

    // ==========================
    // helpers
    // ==========================
    function safeJsonParse(s, fallback){ try{ return JSON.parse(s); }catch(e){ return fallback; } }
    function mapRole(v){
      const s = String(v ?? "").trim().toLowerCase();
      if(!s) return "";
      if(s==="admin") return "admin";
      if(s==="write" || s==="edit") return "write";
      if(s==="read"  || s==="view") return "read";
      if(s==="0") return "admin";
      if(s==="1") return "write";
      if(s==="2") return "read";
      return s;
    }

    function jsonAscii(obj){
      return JSON.stringify(obj).replace(/[^\x00-\x7F]/g, (c)=>{
        const code = c.charCodeAt(0).toString(16).padStart(4,"0");
        return "\\u" + code;
      });
    }

    async function fetchWithTimeout(url, options={}, timeoutMs=15000){
      const ctrl = new AbortController();
      const id = setTimeout(()=> ctrl.abort(), timeoutMs);
      try{
        const res = await fetch(url, { ...options, signal: ctrl.signal });
        return res;
      } finally {
        clearTimeout(id);
      }
    }

    // ==========================
    // session user
    // ==========================
    function getCurrentUser(){
      const cu = safeJsonParse(sessionStorage.getItem(CURRENT_KEY) || "null", null);
      if(!cu || typeof cu !== "object") return null;
      const username = String(cu.username ?? "").trim();
      if(!username) return null;
      const role = mapRole(cu.role ?? cu.level) || "read";
      const out = { username, role, level: role };
      sessionStorage.setItem(CURRENT_KEY, JSON.stringify(out));
      return out;
    }

    function setCurrentUser(u, { broadcast=true } = {}){
      const username = String(u.username||"").trim();
      const role = mapRole(u.level ?? u.role) || "read";
      const obj = { username, role, level: role };
      sessionStorage.setItem(CURRENT_KEY, JSON.stringify(obj));
      if(broadcast) bcPost({ type:"login", user: obj });
    }

    function clearCurrentUser({ broadcast=true } = {}){
      sessionStorage.removeItem(CURRENT_KEY);
      try{ localStorage.removeItem(CURRENT_KEY); }catch(e){}
      if(broadcast) bcPost({ type:"logout" });
    }

    // ==========================
    // Dropbox settings
    // ==========================
    function getDbxToken(){ return String(localStorage.getItem(DBX_TOKEN_KEY) || "").trim(); }
    function setDbxToken(t){ localStorage.setItem(DBX_TOKEN_KEY, String(t || "").trim()); }
    function dbxEnabled(){ const t = getDbxToken(); return !!(t && t.length > 20); }
    function dbxAuthHeader(){ return "Bearer " + getDbxToken(); }

    function getDbxFolder(){
      return String(localStorage.getItem(DBX_FOLDER_KEY) || DEFAULT_DBX_FOLDER).trim() || DEFAULT_DBX_FOLDER;
    }
    function getDbxAppName(){
      return String(localStorage.getItem(DBX_APPNAME_KEY) || DEFAULT_APP_NAME).trim() || DEFAULT_APP_NAME;
    }
    function setDbxAppName(n){
      const v = String(n||"").trim() || DEFAULT_APP_NAME;
      localStorage.setItem(DBX_APPNAME_KEY, v);
    }
    function getDbxAppKey(){
      return String(localStorage.getItem(DBX_APPKEY_KEY) || "").trim();
    }
    function setDbxAppKey(k){
      localStorage.setItem(DBX_APPKEY_KEY, String(k||"").trim());
    }
    function syncAppKeyFromInput(){
      const v = String(appKeyInput?.value || "").trim();
      if(v) setDbxAppKey(v);
      return v || getDbxAppKey();
    }

    function dbxPathAuth(){ return `${getDbxFolder()}/tasunAuthTable_v1.json`; }
    function dbxPathNav(){  return `${getDbxFolder()}/tasunNavButtons_v1.json`; }
    function dbxPathMeta(){ return `${getDbxFolder()}/tasunCloudMeta_v1.json`; }

    function dropboxWebFolderUrl(){
      const appName = encodeURIComponent(getDbxAppName());
      return `https://www.dropbox.com/home/Apps/${appName}${getDbxFolder()}`;
    }

    function getConsoleBaseUrl(){
      const k = syncAppKeyFromInput();
      return k ? `https://www.dropbox.com/developers/apps/info/${encodeURIComponent(k)}` : "";
    }
    function getConsolePermUrl(){ const b = getConsoleBaseUrl(); return b ? (b + "#permissions") : ""; }
    function getConsoleSetUrl(){  const b = getConsoleBaseUrl(); return b ? (b + "#settings") : ""; }
    function openConsoleTab(url, label){
      syncAppKeyFromInput();
      if(!url){
        alert(`å°šæœªå¡« App keyï¼Œç„¡æ³•ç›´æ¥é–‹ ${label}ã€‚\n\nè«‹åœ¨æœ¬è¦–çª—ã€ŒApp keyã€è²¼ä¸Šï¼šç¶²å€ info/<App key>#settings é‚£ä¸²ã€‚`);
        return false;
      }
      const w = window.open(url, "_blank", "noopener");
      if(!w){
        alert("ç€è¦½å™¨å°é–å½ˆå‡ºè¦–çª—ã€‚\nè«‹å…è¨±æ­¤ç¶²ç«™é–‹æ–°åˆ†é å¾Œå†è©¦ä¸€æ¬¡ã€‚");
        return false;
      }
      return true;
    }

    // ==========================
    // Dropbox API
    // ==========================
    async function testTokenAndGetEmail(){
      if(!dbxEnabled()) return { ok:false, status:0, msg:"âŒ Token æœªè¨­å®š", email:"" };
      try{
        const res = await fetchWithTimeout("https://api.dropboxapi.com/2/users/get_current_account", {
          method:"POST",
          cache:"no-store",
          headers:{ "Authorization": dbxAuthHeader(), "Content-Type":"application/json" },
          body: "null"
        }, 15000);

        const txt = await res.text();
        const json = safeJsonParse(txt, null);

        if(!res.ok){
          return { ok:false, status:res.status, msg:`âŒ Token ç„¡æ•ˆæˆ–éæœŸï¼ˆHTTP ${res.status}ï¼‰\n${txt}`, email:"" };
        }
        const email = String(json && json.email ? json.email : "");
        return { ok:true, status:200, msg:`âœ… Token OK\nå°æ‡‰å¸³è™Ÿï¼š${email || "(æœªå›å‚³ email)"}`, email };
      }catch(e){
        return { ok:false, status:0, msg:"âŒ Token æ¸¬è©¦å¤±æ•—ï¼ˆå¯èƒ½ç¶²è·¯/é€¾æ™‚ï¼‰", email:"" };
      }
    }

    async function ensureFolder(){
      try{
        const res = await fetchWithTimeout("https://api.dropboxapi.com/2/files/create_folder_v2", {
          method:"POST",
          cache:"no-store",
          headers:{ "Authorization": dbxAuthHeader(), "Content-Type":"application/json" },
          body: JSON.stringify({ path: getDbxFolder(), autorename:false })
        }, 15000);

        const txt = await res.text();
        if(res.ok) return { ok:true, msg:"âœ… è³‡æ–™å¤¾å·²å»ºç«‹/ç¢ºèª" };

        const j = safeJsonParse(txt, null);
        const summary = String((j && (j.error_summary || j.error && j.error['.tag'])) || "").toLowerCase();

        if(res.status === 409){
          if(summary.includes("path/conflict") || summary.includes("conflict") || (txt||"").toLowerCase().includes("conflict")){
            return { ok:true, msg:"âœ… è³‡æ–™å¤¾å·²å­˜åœ¨" };
          }
        }

        if((txt||"").toLowerCase().includes("missing_scope") || (txt||"").toLowerCase().includes("files.content.write")){
          return { ok:false, msg:`âŒ scopes ä¸è¶³ï¼ˆéœ€è¦ files.content.writeï¼‰\n${txt}` };
        }

        return { ok:false, msg:`âŒ å»ºç«‹è³‡æ–™å¤¾å¤±æ•—ï¼ˆHTTP ${res.status}ï¼‰\n${txt}` };
      }catch(e){
        return { ok:false, msg:"âŒ å»ºç«‹è³‡æ–™å¤¾å¤±æ•—ï¼ˆé€¾æ™‚/ç¶²è·¯ï¼‰" };
      }
    }

    async function dbxDownloadJson(path){
      if(!dbxEnabled()) return null;
      try{
        const res = await fetchWithTimeout("https://content.dropboxapi.com/2/files/download", {
          method: "POST",
          cache: "no-store",
          headers: {
            "Authorization": dbxAuthHeader(),
            "Dropbox-API-Arg": jsonAscii({ path })
          }
        }, 15000);
        if(!res.ok) return null;
        const text = await res.text();
        return safeJsonParse(text, null);
      }catch(e){
        return null;
      }
    }

    async function dbxUploadJson(path, data){
      if(!dbxEnabled()) return { ok:false, msg:"âŒ æœªè¨­å®š Token" };

      const arg = {
        path,
        mode: "overwrite",
        autorename: false,
        mute: true,
        strict_conflict: false
      };

      try{
        const res = await fetchWithTimeout("https://content.dropboxapi.com/2/files/upload", {
          method: "POST",
          cache: "no-store",
          headers: {
            "Authorization": dbxAuthHeader(),
            "Content-Type": "application/octet-stream",
            "Dropbox-API-Arg": jsonAscii(arg)
          },
          body: JSON.stringify(data, null, 2)
        }, 20000);

        const txt = await res.text();
        if(res.ok) return { ok:true, msg:"âœ… å·²ä¸Šå‚³" };

        if((txt||"").toLowerCase().includes("missing_scope") || (txt||"").toLowerCase().includes("files.content.write")){
          return { ok:false, msg:`âŒ scopes ä¸è¶³ï¼ˆéœ€è¦ files.content.writeï¼‰\n${txt}` };
        }
        return { ok:false, msg:`âŒ ä¸Šå‚³å¤±æ•—ï¼ˆHTTP ${res.status}ï¼‰\n${txt}` };
      }catch(e){
        return { ok:false, msg:"âŒ ä¸Šå‚³å¤±æ•—ï¼ˆé€¾æ™‚/ç¶²è·¯ï¼‰" };
      }
    }

    function getLocalUpdatedAt(){
      const v = Number(localStorage.getItem("tasunCloudUpdatedAt_v1") || "0");
      return isFinite(v) ? v : 0;
    }
    function setLocalUpdatedAt(ts){
      localStorage.setItem("tasunCloudUpdatedAt_v1", String(ts || 0));
    }

    async function cloudPullToLocalStorage({ force=false } = {}){
      if(!dbxEnabled()) return false;

      const meta = await dbxDownloadJson(dbxPathMeta());
      const cloudTs = Number(meta && meta.updatedAt ? meta.updatedAt : 0);
      const localTs = getLocalUpdatedAt();

      if(!force && cloudTs && localTs && cloudTs <= localTs) return false;

      const auth = await dbxDownloadJson(dbxPathAuth());
      const nav  = await dbxDownloadJson(dbxPathNav());

      let changed = false;
      if(auth && Array.isArray(auth)){
        localStorage.setItem(AUTH_KEY, JSON.stringify(auth));
        changed = true;
      }
      if(nav && Array.isArray(nav)){
        localStorage.setItem(NAV_KEY, JSON.stringify(nav));
        changed = true;
      }
      if(cloudTs) setLocalUpdatedAt(cloudTs);
      return changed;
    }

    async function cloudPushFromLocalStorage(){
      if(!dbxEnabled()) return { ok:false, msg:"âŒ æœªè¨­å®š Token" };

      const folderChk = await ensureFolder();
      if(!folderChk.ok) return { ok:false, msg: folderChk.msg };

      const auth = safeJsonParse(localStorage.getItem(AUTH_KEY) || "[]", []);
      const nav  = safeJsonParse(localStorage.getItem(NAV_KEY)  || "[]", []);

      const ts = Date.now();
      const up1 = await dbxUploadJson(dbxPathAuth(), auth);
      if(!up1.ok) return up1;

      const up2 = await dbxUploadJson(dbxPathNav(), nav);
      if(!up2.ok) return up2;

      const up3 = await dbxUploadJson(dbxPathMeta(), { updatedAt: ts });
      if(!up3.ok) return up3;

      setLocalUpdatedAt(ts);
      return { ok:true, msg: "âœ… å·²ä¸Šå‚³ï¼ˆå« metaï¼‰" };
    }

    // ==========================
    // auth table local normalization
    // ==========================
    const LEGACY_BUTTON_KEYS = ["btn1","btn2","btn3","btn4","btn5"];

    function makeButtonsAll(count){ return Array(count).fill(true); }
    function makeButtonsOnlyLast(count){
      const a = Array(count).fill(false);
      if(count>0) a[count-1] = true;
      return a;
    }

    function getDefaultAuthTable(btnCount){
      return [
        { username: "alex",  password: "Tasun08040224", level: "admin", role:"admin", buttons: makeButtonsAll(btnCount) },
        { username: "tasun", password: "tasun08040224", level: "write", role:"write", buttons: makeButtonsAll(btnCount) },
        { username: "wu",    password: "123456",        level: "read",  role:"read",  buttons: makeButtonsOnlyLast(btnCount) }
      ];
    }

    function normalizeRow(row, btnCount){
      const username = String(row?.username || "").trim();
      const password = String(row?.password || "");
      const level = mapRole(row?.level ?? row?.role) || "read";

      let buttons = [];
      if(Array.isArray(row?.buttons)) buttons = row.buttons.slice();
      else{
        const legacy = [];
        LEGACY_BUTTON_KEYS.forEach(k=>{
          if(Object.prototype.hasOwnProperty.call(row, k)) legacy.push(!!row[k]);
        });
        buttons = legacy;
      }
      const outBtns = [];
      for(let i=0;i<btnCount;i++) outBtns[i] = !!buttons[i];
      return { username, password, level, role: level, buttons: outBtns };
    }

    function loadNavCount(){
      const nav = safeJsonParse(localStorage.getItem(NAV_KEY) || "null", null);
      if(Array.isArray(nav) && nav.length) return nav.length;
      return 5; // é è¨­ btn1~btn5
    }

    function loadAuth(){
      const btnCount = loadNavCount();
      const raw = localStorage.getItem(AUTH_KEY);
      if(!raw){
        const def = getDefaultAuthTable(btnCount);
        localStorage.setItem(AUTH_KEY, JSON.stringify(def));
        return def.map(r=> normalizeRow(r, btnCount));
      }
      const arr = safeJsonParse(raw, null);
      if(Array.isArray(arr) && arr.length){
        const fixed = arr.map(r=> normalizeRow(r, btnCount));
        localStorage.setItem(AUTH_KEY, JSON.stringify(fixed));
        return fixed;
      }
      const def = getDefaultAuthTable(btnCount);
      localStorage.setItem(AUTH_KEY, JSON.stringify(def));
      return def.map(r=> normalizeRow(r, btnCount));
    }

    function saveAuthToLocal(authRows){
      localStorage.setItem(AUTH_KEY, JSON.stringify(authRows));
    }

    // ==========================
    // render
    // ==========================
    let AUTH_TABLE = [];
    let isAdmin = false;

    function clearMsg(){
      msgErr.style.display = "none";
      msgOk.style.display = "none";
      msgErr.textContent = "";
      msgOk.textContent = "";
    }
    function showErr(t){
      msgOk.style.display = "none";
      msgErr.style.display = "block";
      msgErr.textContent = "âœ– " + t;
    }
    function showOk(t){
      msgErr.style.display = "none";
      msgOk.style.display = "block";
      msgOk.textContent = "âœ” " + t;
    }

    function setEditable(flag){
      isAdmin = !!flag;
      subHint.innerHTML = isAdmin
        ? 'åªæœ‰ <b>admin</b> å¯ä»¥ç·¨è¼¯ï¼›å…¶ä»–æ¬Šé™åªèƒ½æŸ¥çœ‹ã€‚<br>(<b>å¯ç·¨è¼¯</b>)'
        : 'åªæœ‰ <b>admin</b> å¯ä»¥ç·¨è¼¯ï¼›å…¶ä»–æ¬Šé™åªèƒ½æŸ¥çœ‹ã€‚<br>(<b>å”¯è®€</b>)';
      btnAdd.disabled = !isAdmin;
      btnSaveLocal.disabled = !isAdmin;
      btnCloudPush.disabled = !isAdmin;
    }

    function render(){
      tbody.innerHTML = "";
      const btnCount = 5; // æ§åˆ¶é¦–é  1~5
      AUTH_TABLE.forEach((row, idx)=>{
        const tr = document.createElement("tr");
        tr.className = "row-card";

        const tdUser = document.createElement("td");
        const inpUser = document.createElement("input");
        inpUser.className = "cell-input";
        inpUser.value = row.username;
        inpUser.disabled = !isAdmin;
        inpUser.addEventListener("input", ()=>{
          row.username = String(inpUser.value||"").trim();
        });
        tdUser.appendChild(inpUser);

        const tdPwd = document.createElement("td");
        const inpPwd = document.createElement("input");
        inpPwd.className = "cell-input";
        inpPwd.value = row.password;
        inpPwd.disabled = !isAdmin;
        inpPwd.addEventListener("input", ()=>{
          row.password = String(inpPwd.value||"");
        });
        tdPwd.appendChild(inpPwd);

        const tdLvl = document.createElement("td");
        const sel = document.createElement("select");
        sel.className = "cell-select";
        ["admin","write","read"].forEach(v=>{
          const o = document.createElement("option");
          o.value = v;
          o.textContent = v;
          if(mapRole(row.level) === v) o.selected = true;
          sel.appendChild(o);
        });
        sel.disabled = !isAdmin;
        sel.addEventListener("change", ()=>{
          row.level = mapRole(sel.value) || "read";
          row.role = row.level;
        });
        tdLvl.appendChild(sel);

        function mkFlagCell(i){
          const td = document.createElement("td");
          const cb = document.createElement("input");
          cb.type = "checkbox";
          cb.className = "flag";
          cb.checked = !!(row.buttons && row.buttons[i]);
          cb.disabled = !isAdmin;
          cb.addEventListener("change", ()=>{
            if(!Array.isArray(row.buttons)) row.buttons = [];
            row.buttons[i] = !!cb.checked;
          });
          td.appendChild(cb);
          return td;
        }

        const tdB1 = mkFlagCell(0);
        const tdB2 = mkFlagCell(1);
        const tdB3 = mkFlagCell(2);
        const tdB4 = mkFlagCell(3);
        const tdB5 = mkFlagCell(4);

        // ç¬¬ 6 é¡†ã€Œç³»çµ±/æ¬Šé™ã€å›ºå®šï¼šåªæœ‰ admin é¡¯ç¤ºï¼ˆé€™è£¡é¡¯ç¤ºç‚ºå”¯è®€ï¼‰
        const tdSys = document.createElement("td");
        const sys = document.createElement("span");
        const lvl = mapRole(row.level) || "read";
        sys.textContent = (lvl === "admin") ? "âœ“" : "â€”";
        sys.style.opacity = "0.9";
        tdSys.appendChild(sys);

        const tdDel = document.createElement("td");
        const bDel = document.createElement("button");
        bDel.className = "btn ghost";
        bDel.textContent = "åˆªé™¤";
        bDel.disabled = !isAdmin;
        bDel.addEventListener("click", ()=>{
          if(!confirm("ç¢ºå®šåˆªé™¤é€™ä¸€åˆ—ï¼Ÿ")) return;
          AUTH_TABLE.splice(idx, 1);
          saveAuthToLocal(AUTH_TABLE);
          render();
          notifyConfigChanged();
        });
        tdDel.appendChild(bDel);

        tr.appendChild(tdUser);
        tr.appendChild(tdPwd);
        tr.appendChild(tdLvl);
        tr.appendChild(tdB1);
        tr.appendChild(tdB2);
        tr.appendChild(tdB3);
        tr.appendChild(tdB4);
        tr.appendChild(tdB5);
        tr.appendChild(tdSys);
        tr.appendChild(tdDel);

        tbody.appendChild(tr);
      });

      pillStatus.textContent = dbxEnabled() ? "ç‹€æ…‹ï¼šå·²è¨­å®š Tokenï¼ˆå¯åŒæ­¥ï¼‰" : "ç‹€æ…‹ï¼šæœªè¨­å®š Tokenï¼ˆæœ¬æ©Ÿæ¨¡å¼ï¼‰";
    }

    // ==========================
    // Broadcast + watch (æ‰‹æ©ŸåŒæ­¥ä¿®æ­£)
    // ==========================
    function bcPost(msg){
      if(!bcReady || !bc) return;
      try{ bc.postMessage({ ...msg, _from: TAB_ID, _ts: Date.now() }); }catch(e){}
    }
    function notifyConfigChanged(){
      // âœ… é€šçŸ¥ index.html ç«‹å³åˆ·æ–°ï¼ˆä¸ç”¨ç­‰åˆ° intervalï¼‰
      bcPost({ type:"configChanged" });
    }

    function initBridge(){
      if(typeof BroadcastChannel === "undefined") return;
      try{
        bc = new BroadcastChannel(AUTH_BRIDGE_CH);
        bcReady = true;
        bc.onmessage = async (ev)=>{
          const m = ev && ev.data ? ev.data : null;
          if(!m || m._from === TAB_ID) return;

          if(m.type === "configChanged"){
            // âœ… å…¶ä»–åˆ†é ï¼ˆæˆ–å…¶ä»–é ï¼‰å‰›æ›´æ–°äº†æ¬Šé™/æŒ‰éˆ•è¨­å®šï¼šç«‹åˆ»é‡è®€ä¸¦é‡ç•«
            await syncNowIfNew({ force:true, from:"bc" });
            return;
          }

          if(m.type === "login" && m.user && m.user.username){
            // åªæ›´æ–° pill é¡¯ç¤ºï¼›æ¬Šé™ä»ä»¥æœ¬é  current user æ±ºå®š
            await syncNowIfNew({ force:false, from:"bc-login" });
            return;
          }
        };
      }catch(e){
        bcReady = false;
        bc = null;
      }
    }

    const WATCH_MS = 1200;
    const CLOUD_MS = 4000;
    let tLocal = null;
    let tCloud = null;
    let busy = false;

    let lastAuthRaw = "";
    let lastNavRaw  = "";

    function readRaw(){
      return {
        auth: localStorage.getItem(AUTH_KEY) || "",
        nav:  localStorage.getItem(NAV_KEY)  || ""
      };
    }

    async function syncNowIfNew({ force=false, from="watch" } = {}){
      if(busy) return false;
      busy = true;
      try{
        if(dbxEnabled()){
          await cloudPullToLocalStorage({ force:false });
        }

        const raw = readRaw();
        const changed = force || raw.auth !== lastAuthRaw || raw.nav !== lastNavRaw;
        if(!changed) return false;

        lastAuthRaw = raw.auth;
        lastNavRaw  = raw.nav;

        AUTH_TABLE = loadAuth();

        // ä¾ current user æ±ºå®šå¯å¦ç·¨è¼¯
        const cu = getCurrentUser();
        const cuName = cu && cu.username ? cu.username : "(æœªç™»å…¥)";
        const cuRole = cu && cu.level ? mapRole(cu.level) : "read";
        pillUser.textContent = `ç›®å‰ä½¿ç”¨è€…ï¼š${cuName} (${cuRole})`;

        setEditable(cuRole === "admin");
        render();

        return true;
      } finally {
        busy = false;
      }
    }

    function startWatchers(){
      if(tLocal) clearInterval(tLocal);
      if(tCloud) clearInterval(tCloud);

      tLocal = setInterval(()=> syncNowIfNew({ force:false, from:"local" }), WATCH_MS);
      tCloud = setInterval(()=> syncNowIfNew({ force:false, from:"cloud" }), CLOUD_MS);

      window.addEventListener("storage", (ev)=>{
        if(!ev) return;
        if(ev.key === AUTH_KEY || ev.key === NAV_KEY){
          syncNowIfNew({ force:false, from:"storage" });
        }
      });

      document.addEventListener("visibilitychange", ()=>{
        if(!document.hidden) syncNowIfNew({ force:false, from:"visible" });
      });
    }

    // ==========================
    // Token overlay actions
    // ==========================
    function showTokenOverlay(){
      tokenOverlay.style.display = "flex";
      tokenOverlay.setAttribute("aria-hidden","false");
      appNameInput.value = getDbxAppName();
      appKeyInput.value  = getDbxAppKey();
      tokenInput.value   = getDbxToken();
      tokenMsg.textContent = `Dropbox ç¶²ç«™ä½ç½®ï¼ˆApp folderï¼‰ï¼š\n${dropboxWebFolderUrl()}`;
      setTimeout(()=> appNameInput.focus(), 80);
    }
    function hideTokenOverlay(){
      tokenOverlay.style.display = "none";
      tokenOverlay.setAttribute("aria-hidden","true");
      tokenMsg.textContent = "";
    }

    tokenEyeBtn.addEventListener("click", ()=>{
      tokenInput.type = (tokenInput.type === "password") ? "text" : "password";
    });

    btnOpenPerm.addEventListener("click", ()=>{
      syncAppKeyFromInput();
      openConsoleTab(getConsolePermUrl(), "Permissions");
    });
    btnOpenSet.addEventListener("click", ()=>{
      syncAppKeyFromInput();
      openConsoleTab(getConsoleSetUrl(), "Settings");
    });

    btnGuide.addEventListener("click", ()=>{
      const kNow = syncAppKeyFromInput();
      alert("æ¥ä¸‹ä¾†é€²å…¥å°è¦½ã€‚\næŒ‰ç¢ºå®šé–‹å§‹ã€‚");
      if(!kNow){
        alert("ä½ ç›®å‰é‚„æ²’å¡« App keyã€‚\næˆ‘å…ˆå¹«ä½ é–‹ Apps åˆ—è¡¨ï¼šé»é€² App å¾Œï¼Œçœ‹ç¶²å€ info/<é€™ä¸²>#settingsï¼ŒæŠŠ <é€™ä¸²> è²¼å›ä¾†ã€‚");
        window.open("https://www.dropbox.com/developers/apps", "_blank", "noopener");
        return;
      }
      openConsoleTab(getConsolePermUrl(), "Permissions");
      openConsoleTab(getConsoleSetUrl(), "Settings");
    });

    btnCloseToken.addEventListener("click", hideTokenOverlay);

    btnSaveToken.addEventListener("click", async ()=>{
      clearMsg();

      const appName = String(appNameInput.value||"").trim() || DEFAULT_APP_NAME;
      setDbxAppName(appName);
      syncAppKeyFromInput();

      const t = String(tokenInput.value||"").trim();
      if(!t){
        tokenMsg.textContent = "è«‹å…ˆè²¼ä¸Š Access Tokenã€‚";
        return;
      }
      setDbxToken(t);

      tokenMsg.textContent = "æ­£åœ¨æ¸¬è©¦ Tokenâ€¦";
      const chk = await testTokenAndGetEmail();
      if(!chk.ok){
        tokenMsg.textContent = chk.msg;
        return;
      }

      let emailHint = "";
      if(chk.email && chk.email.toLowerCase() !== EXPECT_EMAIL.toLowerCase()){
        emailHint = `\nâš ï¸ é€™å€‹ token å°æ‡‰ emailï¼š${chk.email}\nä½ æœŸæœ›ï¼š${EXPECT_EMAIL}`;
      }else if(chk.email){
        emailHint = `\nâœ… token å°æ‡‰ emailï¼š${chk.email}`;
      }

      tokenMsg.textContent = chk.msg + emailHint + "\n\næ­£åœ¨ç¢ºèªè³‡æ–™å¤¾â€¦";
      const folderChk = await ensureFolder();
      if(!folderChk.ok){
        tokenMsg.textContent = chk.msg + emailHint + "\n\n" + folderChk.msg;
        return;
      }

      tokenMsg.textContent = chk.msg + emailHint + "\n" + folderChk.msg + "\n\nâœ… Token OK";
      setTimeout(()=> hideTokenOverlay(), 650);

      // è®“ç•«é¢ç‹€æ…‹æ›´æ–°
      await syncNowIfNew({ force:true, from:"token" });
    });

    // ==========================
    // page actions
    // ==========================
    btnHome.addEventListener("click", ()=> location.href = "index.html");
    btnToken.addEventListener("click", showTokenOverlay);

    btnSwitch.addEventListener("click", ()=>{
      clearCurrentUser({ broadcast:true });
      alert("å·²æ¸…é™¤ç™»å…¥ç‹€æ…‹ï¼Œè«‹å›é¦–é é‡æ–°ç™»å…¥ã€‚");
      location.href = "index.html";
    });

    btnAdd.addEventListener("click", ()=>{
      clearMsg();
      if(!isAdmin){
        showErr("åªæœ‰ admin å¯ä»¥æ–°å¢ã€‚");
        return;
      }
      AUTH_TABLE.push({ username:"", password:"", level:"read", role:"read", buttons:[false,false,false,false,false] });
      saveAuthToLocal(AUTH_TABLE);
      render();
      notifyConfigChanged();
    });

    btnSaveLocal.addEventListener("click", ()=>{
      clearMsg();
      if(!isAdmin){
        showErr("åªæœ‰ admin å¯ä»¥å„²å­˜ã€‚");
        return;
      }
      // å»é™¤ç©º username
      AUTH_TABLE = AUTH_TABLE.filter(r => String(r.username||"").trim());
      // normalize
      AUTH_TABLE = AUTH_TABLE.map(r=>{
        const lvl = mapRole(r.level ?? r.role) || "read";
        const btns = Array.isArray(r.buttons) ? r.buttons.slice(0,5) : [false,false,false,false,false];
        while(btns.length<5) btns.push(false);
        return { username:String(r.username||"").trim(), password:String(r.password||""), level:lvl, role:lvl, buttons:btns };
      });
      saveAuthToLocal(AUTH_TABLE);
      showOk("å·²å„²å­˜åˆ°æœ¬æ©Ÿ localStorageã€‚");
      render();
      notifyConfigChanged();
    });

    btnCloudPull.addEventListener("click", async ()=>{
      clearMsg();
      if(!dbxEnabled()){
        showErr("å°šæœªè¨­å®š Tokenï¼Œç„¡æ³•é›²ç«¯ä¸‹è¼‰ã€‚");
        return;
      }
      pillStatus.textContent = "ç‹€æ…‹ï¼šé›²ç«¯ä¸‹è¼‰ä¸­â€¦";
      const changed = await cloudPullToLocalStorage({ force:true });
      await syncNowIfNew({ force:true, from:"pull" });
      if(changed) showOk("å·²å¾é›²ç«¯ä¸‹è¼‰ä¸¦æ›´æ–°æœ¬æ©Ÿã€‚");
      else showOk("é›²ç«¯æ²’æœ‰è¼ƒæ–°ç‰ˆæœ¬ï¼ˆæˆ–å·²åŒæ­¥ï¼‰ã€‚");
      notifyConfigChanged();
    });

    btnCloudPush.addEventListener("click", async ()=>{
      clearMsg();
      if(!isAdmin){
        showErr("åªæœ‰ admin å¯ä»¥ä¸Šå‚³ã€‚");
        return;
      }
      if(!dbxEnabled()){
        showErr("å°šæœªè¨­å®š Tokenï¼Œç„¡æ³•ä¸Šå‚³ã€‚");
        return;
      }

      // å…ˆå­˜æœ¬æ©Ÿï¼ˆç¢ºä¿ä¸Šå‚³è³‡æ–™ä¸€è‡´ï¼‰
      btnSaveLocal.click();
      if(msgErr.style.display === "block") return;

      pillStatus.textContent = "ç‹€æ…‹ï¼šä¸Šå‚³ä¸­â€¦";
      const up = await cloudPushFromLocalStorage();
      if(!up.ok){
        showErr(up.msg);
        pillStatus.textContent = "ç‹€æ…‹ï¼šä¸Šå‚³å¤±æ•—";
        return;
      }
      showOk(up.msg + "\n" + dropboxWebFolderUrl());
      pillStatus.textContent = "ç‹€æ…‹ï¼šå·²ä¸Šå‚³";
      notifyConfigChanged();
    });

    // ==========================
    // boot
    // ==========================
    (async function boot(){
      initBridge();

      // init snapshot
      const raw = readRaw();
      lastAuthRaw = raw.auth;
      lastNavRaw  = raw.nav;

      // è‹¥æœ¬æ©Ÿæ²’è³‡æ–™å…ˆè£œé è¨­
      AUTH_TABLE = loadAuth();
      saveAuthToLocal(AUTH_TABLE);

      startWatchers();
      await syncNowIfNew({ force:true, from:"boot" });
    })();
  </script>
</body>
</html>
