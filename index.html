<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Tasun è³‡æ–™é¦–é  Â· ç©ºç„¡æ˜</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <!-- âœ…âœ…âœ… GitHub Pages å¼·åˆ¶åˆ·æ–°ï¼ˆä¸€æ¬¡æ€§ï¼‰+ å…¨ç«™è³‡æº cache-bustï¼ˆæœ€æœ‰æ•ˆã€æœ€ç©©å®šï¼‰ -->
  <script>
  (function () {
    const KEY = "tasun_force_refresh_once_v1";
    const u = new URL(location.href);

    // è‹¥ç¶²å€æ²’æœ‰ vï¼Œä¸”æœ¬ session é‚„æ²’åšéä¸€æ¬¡æ€§åˆ·æ–° â†’ ç«‹åˆ»æ›æˆå¸¶ v çš„ç¶²å€
    if (!u.searchParams.has("v") && !sessionStorage.getItem(KEY)) {
      sessionStorage.setItem(KEY, "1");
      u.searchParams.set("v", String(Date.now()));   // âœ… ä¹Ÿå¯æ”¹æˆå›ºå®šç‰ˆè™Ÿï¼šä¾‹å¦‚ "20260115"
      location.replace(u.toString());
      return;
    }

    // ä¾›å¾ŒçºŒ JS ä½¿ç”¨ï¼ˆåŒä¸€å€‹ vï¼‰
    window.__CACHE_V = u.searchParams.get("v") || "";
  })();
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

  <!-- âœ… preload ä¹ŸåŠ  vï¼ˆé¿å…èˆŠåœ–ï¼‰ -->
  <link id="preloadZen" rel="preload" as="image" href="ä½›æ•™ç¦ªæ„ä¸»è¦–è¦º.png">

  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- âœ… è®“ preload çš„ href ä¹Ÿå¸¶ v -->
  <script>
  (function(){
    const v = window.__CACHE_V || "";
    if(!v) return;

    const withV = (url) => {
      try{
        const u = new URL(url, document.baseURI);
        if (u.origin === location.origin) u.searchParams.set("v", v);
        return u.toString();
      }catch(e){ return url; }
    };

    const pre = document.getElementById("preloadZen");
    if(pre) pre.href = withV(pre.getAttribute("href") || pre.href);
  })();
  </script>

  <style>
    :root{
      --gold:#f6d37a;

      --outer-side: clamp(18px, 2.2vw, 64px);

      /* frame */
      --frame-inset: clamp(0.55rem, 1.0vw, 1.1rem);
      --frame-radius: clamp(22px, 2vw, 34px);
      --stage-top: clamp(4.0rem, 7vh, 5.4rem);
      --glass-inset: clamp(8px, 0.9vw, 14px);

      /* âœ… æŒ‰éµé›¢èˆå°é‚Šæ¡†çš„å®‰å…¨å…§ç¸®ï¼ˆæ¡Œæ©Ÿ/æ‰‹æ©Ÿéƒ½ç”¨ï¼‰ */
      --nav-pad: clamp(16px, 1.9vw, 40px);

      /* âœ… æŒ‰éµå°ºå¯¸ */
      --btn-w: clamp(240px, 19.0vw, 400px);
      --btn-h: clamp(70px, 8.0vh, 110px);
      --btn-font-max: clamp(0.98rem, 1.02vw, 1.16rem);
      --btn-font-min: 0.82rem;

      /* âœ… mobile varsï¼ˆJS æœƒæ”¹ï¼‰ */
      --nav-gap: .72rem;
      --btn-h-mobile-min: 50px;
      --nav-cols: 2;

      /* âœ… mobile overlay zoneï¼ˆJS æœƒæ”¹ï¼‰ */
      --nav-top: 52%;
      --nav-bottom: 14%;

      /* ã€Œç©ºç„¡æ˜ã€ä½ç½® */
      --title-top: calc(var(--stage-top) + clamp(58px, 9.2vh, 96px));
      --title-h: clamp(150px, 18vh, 220px);

      /* âœ… ä¸»è¦–è¦ºèå…¥ */
      --zen-opacity: .66;
      --zen-scale: 1.14;
      --zen-contrast: 1.10;
      --zen-bright: 1.02; /* âœ… èˆå°æ›´äº®ä¸€é»ï¼Œä¸å£“å­— */

      /* ç»ç’ƒæ¶²åŒ–ï¼ˆèˆå°ï¼‰ */
      --liquid-op: .26;
      --liquid-blur: 16px;
      --liquid-speed: 16s;
      --liquid-shift: 4%;

      /* å·¦å³æ°´æ³¢ç´‹ç»ç’ƒ */
      --sideglass-w: clamp(70px, 6.2vw, 150px);
      --sideglass-op: .26;
      --ripple-op: .12;
      --ripple-speed: 20s;

      /* âœ… æŒ‰éµå±€éƒ¨ã€Œç‡ˆå…‰ç…§æ„Ÿ/æ¸…æ™°åº¦ã€ */
      --btn-glass-alpha: .085;
      --btn-dark-alpha: .28;
      --btn-light-alpha: .32;
      --btn-sheen-alpha: .18;

      /* âœ… é»ƒè‰²æ°´æ™¶æ–‡å­—ï¼ˆæ›´æ·±é‡‘ã€æ›´éŠ³åˆ©ã€æ›´èšç„¦ï¼‰ */
      --crystal-stroke-dark: rgba(10, 7, 4, 0.80);
      --crystal-stroke-dark-2: rgba(10, 7, 4, 0.90);

      --crystal-glow-strong: rgba(246,211,122,0.54);
      --crystal-glow-soft: rgba(246,211,122,0.20);

      /* âœ… ç»ç’ƒ blur çµ±ä¸€æ§åˆ¶ï¼ˆå†é™ä¸€é»ï¼Œä¿ç•™ç»ç’ƒä½†ä¸éœ§å­—ï¼‰ */
      --stage-blur: 7px;     /* åŸ 8px â†’ å†é™ï¼Œå­—æ›´åˆ© */
      --panel-blur: 9px;     /* åŸ 10px â†’ å†é™ */
      --btn-blur: 4.5px;     /* åŸ 5px */
      --btn-blur-m: 3.2px;   /* åŸ 3.5px */

      /* âœ… ä½›å…‰ */
      --beam-op: .22;        /* ä¸Šâ†’ä¸‹æ™®ç…§å¼·åº¦ */
      --aura-op: .22;        /* å…§â†’å¤–æ™®ç…§ */
      --fog-op: .22;         /* ä¹¾å†°ç…™éœ§ */

      /* âœ… âœ… æ·±é‡‘/éŠ…é‡‘ä¸€éšï¼šçµ±ä¸€æ°´æ™¶é‡‘éšï¼ˆæ›´æ·±é‡‘/æ›´åéŠ…ï¼‰ */
      --gold-deep-1: linear-gradient(180deg,
        rgba(255,252,242,0.82) 0%,
        rgba(255,236,196,0.72) 10%,
        rgba(255,198,118,0.86) 26%,
        rgba(232,162,62,1.00) 50%,
        rgba(160,86,22,0.98) 78%,
        rgba(255,220,158,0.74) 100%);
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    html, body { height: 100%; }

    body{
      min-height:100dvh;
      font-family:"Noto Serif TC","æ¨™æ¥·é«”","Microsoft JhengHei",serif;
      background:#050302;
      color:var(--gold);
      overflow-x:hidden;

      /* âœ… æ–‡å­—éŠ³åˆ© */
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;
    }

    body.locked{ overflow:hidden; }
    body.locked main.hero{ visibility:hidden; }
    body:not(.locked) main.hero{ visibility:visible; }

    /* ========================== Loginï¼ˆä¿ç•™ï¼‰ ========================== */
    .login-overlay{
      position:fixed; inset:0;
      background: radial-gradient(circle at 50% 18%, rgba(255,228,170,0.35), rgba(0,0,0,0.98));
      display:flex; align-items:center; justify-content:center;
      z-index:999;
    }
    .login-box{
      width:min(380px,90vw);
      padding:2.4rem 2.6rem 2.2rem;
      border-radius:18px;
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.28), rgba(0,0,0,0.94));
      border:1px solid rgba(246,211,122,0.35);
      box-shadow:0 0 24px rgba(0,0,0,0.9), 0 0 32px rgba(246,211,122,0.25);
      color:rgba(246,211,122,0.75);
    }
    .login-title{
      text-align:center;
      font-size:1.4rem;
      letter-spacing:.2em;
      text-indent:.2em;
      margin-bottom:1.2rem;
      text-shadow:0 0 8px rgba(246,211,122,0.8), 0 0 18px rgba(246,211,122,0.5);
    }
    .login-sub{
      text-align:center;
      font-size:.86rem;
      letter-spacing:.12em;
      text-indent:.12em;
      margin:-.3rem 0 1.2rem;
      color: rgba(246,211,122,0.66);
      min-height:1.1rem;
    }
    .login-field{ margin-bottom:1rem; }
    .login-field label{
      display:block;
      font-size:.85rem;
      letter-spacing:.18em;
      text-indent:.18em;
      margin-bottom:.3rem;
      color:rgba(246,211,122,0.75);
    }
    .login-field input, .login-field select{
      width:100%;
      padding:.55rem .7rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.5);
      background:rgba(0,0,0,0.8);
      color:var(--gold);
      outline:none;
    }
    .login-field input:focus, .login-field select:focus{
      border-color:rgba(255,238,190,0.9);
      box-shadow:0 0 12px rgba(246,211,122,0.7);
    }
    .login-pwd-wrapper{ display:flex; align-items:center; gap:.45rem; }
    .login-pwd-input{ flex:1 1 auto; }
    .btn-eye-login{
      padding:.25rem .7rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.8);
      background:rgba(0,0,0,0.85);
      color:var(--gold);
      font-size:.8rem;
      cursor:pointer;
      box-shadow:0 0 8px rgba(0,0,0,0.6);
    }
    .btn-eye-login:hover{ background:rgba(246,211,122,0.2); }
    .login-error{
      min-height:1.1rem;
      margin-bottom:.4rem;
      font-size:.8rem;
      color:#ffb3b3;
      text-align:center;
    }
    .login-actions{ margin-top:.8rem; display:flex; justify-content:center; gap:.6rem; flex-wrap:wrap; }
    .btn-login{
      padding:.55rem 2.2rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.9);
      background:radial-gradient(circle at 0% 0%, rgba(246,211,122,0.36), rgba(0,0,0,0.98));
      color:var(--gold);
      font-size:.95rem;
      letter-spacing:.22em;
      text-indent:.22em;
      cursor:pointer;
      box-shadow:0 10px 18px rgba(0,0,0,0.95), 0 0 18px rgba(246,211,122,0.5);
      transition:transform .15s ease-out, box-shadow .2s ease-out, background .2s ease-out, border-color .2s ease-out;
    }
    .btn-login:hover{
      transform:translateY(-1px);
      box-shadow:0 12px 22px rgba(0,0,0,0.98), 0 0 22px rgba(246,211,122,0.8);
      border-color:#fff4cf;
      background:radial-gradient(circle at 0% 0%, rgba(255,244,208,0.45), rgba(0,0,0,0.97));
    }
    .btn-secondary{
      padding:.55rem 1.6rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.55);
      background: rgba(0,0,0,0.78);
      color: rgba(246,211,122,0.92);
      font-size:.88rem;
      letter-spacing:.16em;
      text-indent:.16em;
      cursor:pointer;
      box-shadow:0 8px 16px rgba(0,0,0,0.85);
      transition:transform .15s ease-out, border-color .2s ease-out;
    }
    .btn-secondary:hover{ transform:translateY(-1px); border-color:#fff4cf; }

    /* ========================== Hero ========================== */
    .hero{
      position:relative;
      min-height:100dvh;
      height:100dvh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      color:var(--gold);
    }

    /* âœ… èƒŒæ™¯ä¸å†é‚£éº¼æ·±ï¼šèˆå°æ›´äº®ã€å­—æ›´ç«™å¾—ä½ */
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 50% 12%,
          rgba(255,237,180,0.78) 0,
          rgba(255,237,180,0.34) 18%,
          rgba(255,237,180,0.12) 42%,
          rgba(255,237,180,0.00) 64%),
        linear-gradient(to bottom,
          rgba(0,0,0,0.84) 0%,
          rgba(0,0,0,0.62) 34%,
          rgba(0,0,0,0.48) 60%,
          rgba(0,0,0,0.60) 100%);
      z-index:-6;
    }
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 50% 56%, rgba(246,211,122,0.10) 0, rgba(0,0,0,0.00) 54%),
        radial-gradient(circle at 50% 70%, rgba(0,0,0,0.00) 0, rgba(0,0,0,0.18) 62%, rgba(0,0,0,0.56) 100%);
      z-index:-5;
      pointer-events:none;
    }

    .hero-inner{
      position:relative;
      width: calc(100vw - (2 * var(--outer-side)));
      height:100dvh;
      margin:0 var(--outer-side);
      padding: clamp(1.0rem, 1.6vw, 1.6rem);
      isolation:isolate;
      contain: layout paint;
    }

    .hero-inner::before{
      content:"";
      position:absolute;
      inset:var(--frame-inset);
      border-radius:var(--frame-radius);
      background:
        radial-gradient(circle at 50% 46%, rgba(255,244,210,0.12), rgba(0,0,0,0.00) 62%),
        radial-gradient(circle at 18% 55%, rgba(246,211,122,0.06), rgba(0,0,0,0.00) 60%),
        radial-gradient(circle at 82% 55%, rgba(246,211,122,0.06), rgba(0,0,0,0.00) 60%),
        linear-gradient(180deg, rgba(255,255,255,0.04), rgba(0,0,0,0.20));

      backdrop-filter: blur(var(--stage-blur));
      -webkit-backdrop-filter: blur(var(--stage-blur));

      opacity: .96;
      z-index:-6;
      pointer-events:none;
    }
    .hero-inner::after{
      content:"";
      position:absolute;
      inset:var(--frame-inset);
      border-radius:var(--frame-radius);
      background:
        radial-gradient(circle at 50% 18%, rgba(255,244,210,0.06), rgba(255,244,210,0.00) 58%),
        linear-gradient(180deg, rgba(255,255,255,0.06), rgba(255,255,255,0.015));
      border:1px solid rgba(246,211,122,0.14);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.05),
        0 0 28px rgba(0,0,0,0.52),
        0 0 26px rgba(246,211,122,0.10);
      z-index:-5;
      pointer-events:none;
    }

    .ripple-film{
      position:absolute;
      inset:var(--frame-inset);
      border-radius:var(--frame-radius);
      pointer-events:none;
      z-index:-4;
      opacity: var(--ripple-op);
      mix-blend-mode: screen;
      background:
        repeating-radial-gradient(circle at 30% 40%,
          rgba(255,255,255,0.18) 0 1px,
          rgba(255,255,255,0.00) 6px 18px),
        repeating-radial-gradient(circle at 72% 58%,
          rgba(246,211,122,0.12) 0 1px,
          rgba(0,0,0,0.00) 7px 22px);

      filter: blur(.14px);

      mask-image: radial-gradient(circle at 50% 55%, rgba(0,0,0,1) 0 62%, rgba(0,0,0,0) 90%);
      -webkit-mask-image: radial-gradient(circle at 50% 55%, rgba(0,0,0,1) 0 62%, rgba(0,0,0,0) 90%);
      animation: rippleMove var(--ripple-speed) ease-in-out infinite;
      will-change: transform, background-position;
    }
    @keyframes rippleMove{
      0%{ background-position: 0% 0%, 0% 0%; transform: translateY(0px); }
      50%{ background-position: 14% 8%, -10% 12%; transform: translateY(-1px); }
      100%{ background-position: 0% 0%, 0% 0%; transform: translateY(0px); }
    }
    @media (prefers-reduced-motion: reduce){
      .ripple-film{ animation:none; }
    }

    .side-glass{
      position:absolute;
      top: var(--stage-top);
      bottom: calc(var(--frame-inset) + var(--glass-inset));
      width: var(--sideglass-w);
      pointer-events:none;
      border-radius: calc(var(--frame-radius) - 12px);
      z-index:-4;
      opacity: var(--sideglass-op);
      background:
        radial-gradient(140% 120% at 20% 20%, rgba(255,255,255,0.14), rgba(255,255,255,0.02) 48%, rgba(0,0,0,0.10) 100%),
        radial-gradient(circle at 50% 45%, rgba(246,211,122,0.10), rgba(0,0,0,0.00) 62%),
        linear-gradient(180deg, rgba(255,255,255,0.05), rgba(0,0,0,0.10));

      backdrop-filter: blur(var(--panel-blur)) saturate(1.10);
      -webkit-backdrop-filter: blur(var(--panel-blur)) saturate(1.10);

      box-shadow:
        0 18px 60px rgba(0,0,0,0.28),
        0 0 22px rgba(246,211,122,0.10),
        inset 0 0 0 1px rgba(255,255,255,0.04),
        inset 0 18px 32px rgba(255,255,255,0.04);
      overflow:hidden;
    }
    .side-glass::before{
      content:"";
      position:absolute; inset:-28%;
      opacity:.46;
      mix-blend-mode: screen;
      background:
        repeating-radial-gradient(circle at 40% 35%,
          rgba(255,255,255,0.18) 0 1px,
          rgba(255,255,255,0.00) 6px 18px),
        conic-gradient(from 120deg at 50% 50%,
          rgba(255,255,255,0.00) 0deg,
          rgba(255,255,255,0.06) 70deg,
          rgba(246,211,122,0.06) 145deg,
          rgba(255,255,255,0.00) 230deg,
          rgba(255,255,255,0.05) 305deg,
          rgba(255,255,255,0.00) 360deg);
      filter: blur(10px);
      animation: sideRipple 18s ease-in-out infinite;
    }
    @keyframes sideRipple{
      0%{ transform: translate(-2%, -1%) rotate(-0.2deg) scale(1.02); }
      50%{ transform: translate(2%, 1%) rotate(0.2deg) scale(1.03); }
      100%{ transform: translate(-2%, -1%) rotate(-0.2deg) scale(1.02); }
    }
    @media (prefers-reduced-motion: reduce){
      .side-glass::before{ animation:none; opacity:.36; }
    }
    .side-glass-left{ left: calc(var(--frame-inset) + var(--glass-inset)); }
    .side-glass-right{ right: calc(var(--frame-inset) + var(--glass-inset)); }

    .lotus-stage{
      position:absolute;
      top:var(--stage-top);
      bottom: calc(var(--frame-inset) + var(--glass-inset));
      left:  calc(var(--frame-inset) + var(--glass-inset));
      right: calc(var(--frame-inset) + var(--glass-inset));
      border-radius: calc(var(--frame-radius) - 2px);
      overflow:hidden;
      pointer-events:none;
      z-index:-3;

      background:
        radial-gradient(circle at 50% 22%, rgba(255,244,210,0.18), rgba(0,0,0,0.00) 54%),
        radial-gradient(circle at 50% 68%, rgba(246,211,122,0.12), rgba(0,0,0,0.00) 60%),
        linear-gradient(180deg, rgba(255,255,255,0.06), rgba(0,0,0,0.18));

      box-shadow:
        0 30px 90px rgba(0,0,0,0.50),
        0 0 40px rgba(246,211,122,0.10),
        inset 0 18px 36px rgba(255,255,255,0.04);

      backdrop-filter: blur(var(--panel-blur)) saturate(1.10);
      -webkit-backdrop-filter: blur(var(--panel-blur)) saturate(1.10);

      transform: translateZ(0);
    }
    .lotus-stage::before{
      content:"";
      position:absolute; inset:-18%;
      z-index:3;
      background:
        radial-gradient(ellipse at 20% 30%, rgba(255,255,255,0.12), rgba(0,0,0,0.00) 52%),
        radial-gradient(ellipse at 80% 36%, rgba(255,248,220,0.10), rgba(0,0,0,0.00) 55%),
        radial-gradient(ellipse at 52% 72%, rgba(246,211,122,0.10), rgba(0,0,0,0.00) 58%),
        conic-gradient(from 200deg at 50% 55%,
          rgba(255,255,255,0.00) 0deg,
          rgba(255,255,255,0.06) 55deg,
          rgba(246,211,122,0.05) 120deg,
          rgba(255,255,255,0.00) 200deg,
          rgba(255,255,255,0.04) 280deg,
          rgba(255,255,255,0.00) 360deg);
      filter: blur(12px);
      opacity: .82;
      mix-blend-mode: screen;
      pointer-events:none;
    }

    .lotus-stage .liquid-flow{
      position:absolute;
      inset:-22%;
      z-index:4;
      pointer-events:none;
      mix-blend-mode: screen;
      opacity: var(--liquid-op);
      filter: blur(var(--liquid-blur));
      transform: translateZ(0);
      background:
        radial-gradient(ellipse at 18% 34%, rgba(255,255,255,0.18), rgba(0,0,0,0.00) 58%),
        radial-gradient(ellipse at 80% 44%, rgba(255,248,220,0.16), rgba(0,0,0,0.00) 60%),
        radial-gradient(ellipse at 52% 72%, rgba(246,211,122,0.16), rgba(0,0,0,0.00) 62%),
        conic-gradient(from 120deg at 50% 55%,
          rgba(255,255,255,0.00) 0deg,
          rgba(255,255,255,0.10) 65deg,
          rgba(246,211,122,0.08) 140deg,
          rgba(255,255,255,0.00) 220deg,
          rgba(255,255,255,0.07) 300deg,
          rgba(255,255,255,0.00) 360deg);
      animation: liquidDrift var(--liquid-speed) ease-in-out infinite;
      will-change: transform;
    }
    @keyframes liquidDrift{
      0%{   transform: translate(calc(-1 * var(--liquid-shift)), calc(-0.6 * var(--liquid-shift))) rotate(-0.35deg) scale(1.02); }
      50%{  transform: translate(var(--liquid-shift), calc(0.9 * var(--liquid-shift))) rotate(0.35deg) scale(1.03); }
      100%{ transform: translate(calc(-1 * var(--liquid-shift)), calc(-0.6 * var(--liquid-shift))) rotate(-0.35deg) scale(1.02); }
    }
    @media (prefers-reduced-motion: reduce){
      .lotus-stage .liquid-flow{ animation:none; opacity:.18; }
    }

    /* âœ… ä½›å…‰ï¼šä¸Šâ†’ä¸‹æ™®ç…§ */
    .lotus-stage .divine-beam{
      position:absolute;
      inset:-6% -10% -10%;
      z-index:5;
      pointer-events:none;
      mix-blend-mode: screen;
      opacity: var(--beam-op);
      background:
        radial-gradient(ellipse at 50% 0%,
          rgba(255,250,225,0.75) 0%,
          rgba(246,211,122,0.40) 22%,
          rgba(246,211,122,0.12) 48%,
          rgba(0,0,0,0.00) 70%),
        linear-gradient(to bottom,
          rgba(255,252,235,0.38) 0%,
          rgba(246,211,122,0.16) 32%,
          rgba(246,211,122,0.06) 52%,
          rgba(0,0,0,0.00) 80%);
      filter: blur(10px);
      transform: translateZ(0);
    }

    /* âœ… è“®èŠ±å‘¨åœï¼šå…§â†’å¤–æ™®ç…§ï¼ˆå…‰æšˆåœˆï¼‰ */
    .lotus-stage .lotus-aura{
      position:absolute;
      left:50%;
      bottom:-6%;
      width: 120%;
      height: 72%;
      transform: translateX(-50%);
      z-index:6;
      pointer-events:none;
      mix-blend-mode: screen;
      opacity: var(--aura-op);
      background:
        radial-gradient(circle at 50% 88%,
          rgba(255,250,230,0.46) 0%,
          rgba(246,211,122,0.28) 18%,
          rgba(246,211,122,0.12) 34%,
          rgba(0,0,0,0.00) 60%);
      filter: blur(12px);
    }

    /* âœ… ä¹¾å†°ç…™éœ§ */
    .lotus-stage .lotus-fog{
      position:absolute;
      left:50%;
      bottom:-10%;
      width: 120%;
      height: 60%;
      transform: translateX(-50%);
      z-index:7;
      pointer-events:none;
      opacity: var(--fog-op);
      mix-blend-mode: screen;
      background:
        radial-gradient(ellipse at 30% 80%, rgba(255,255,255,0.22), rgba(255,255,255,0.00) 58%),
        radial-gradient(ellipse at 52% 86%, rgba(255,255,255,0.18), rgba(255,255,255,0.00) 62%),
        radial-gradient(ellipse at 74% 78%, rgba(255,255,255,0.20), rgba(255,255,255,0.00) 60%),
        radial-gradient(ellipse at 50% 90%, rgba(246,211,122,0.10), rgba(0,0,0,0.00) 68%);
      filter: blur(16px);
      animation: fogDrift 10s ease-in-out infinite;
      will-change: transform;
    }
    @keyframes fogDrift{
      0%{   transform: translateX(-50%) translateY(0) scale(1.02); }
      50%{  transform: translateX(-50%) translateY(-10px) scale(1.03); }
      100%{ transform: translateX(-50%) translateY(0) scale(1.02); }
    }
    @media (prefers-reduced-motion: reduce){
      .lotus-stage .lotus-fog{ animation:none; }
    }

    .zen-visual{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      opacity: var(--zen-opacity);
      pointer-events:none;
      z-index:2;
    }
    .zen-visual img{
      width: 116%;
      height: 116%;
      object-fit: cover;
      object-position: center;
      transform: scale(var(--zen-scale)) translateZ(0);
      filter:
        saturate(1.04)
        contrast(var(--zen-contrast))
        brightness(var(--zen-bright))
        drop-shadow(0 26px 40px rgba(0,0,0,0.40));
    }

    /* ========================== Top UI ========================== */
    .user-bar{
      position:fixed;
      top: calc(.8rem + env(safe-area-inset-top));
      left: calc(.9rem + env(safe-area-inset-left));
      display:flex;
      align-items:center;
      gap:.75rem;
      pointer-events:none;
      z-index:40;
    }
    .user-pill, .btn-switch{ pointer-events:auto; }

    .user-pill{
      padding:.28rem 1.02rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.46);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.10), rgba(0,0,0,0.70));
      font-size:.82rem;
      letter-spacing:.10em;
      text-indent:.10em;
      opacity:.88;
      box-shadow:0 3px 8px rgba(0,0,0,0.65), 0 0 10px rgba(246,211,122,0.12);
      white-space:nowrap;

      color: transparent;
      background-image: var(--gold-deep-1);
      -webkit-background-clip:text;
      background-clip:text;
      -webkit-text-stroke: .90px rgba(10,7,4,0.82);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.28),
        0 4px 10px rgba(0,0,0,0.55);

      -webkit-text-fill-color: transparent;
    }

    .btn-switch{
      padding:.24rem .98rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.50);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.12), rgba(0,0,0,0.72));
      font-size:.80rem;
      letter-spacing:.10em;
      text-indent:.10em;
      cursor:pointer;
      opacity:.84;
      box-shadow:0 4px 9px rgba(0,0,0,0.70), 0 0 10px rgba(246,211,122,0.12);
      transition:transform .15s ease-out, box-shadow .2s ease-out, background .2s ease-out, opacity .2s ease-out;
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;

      color: transparent;
      background-image: var(--gold-deep-1);
      -webkit-background-clip:text;
      background-clip:text;
      -webkit-text-stroke: .95px rgba(10,7,4,0.86);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.28),
        0 4px 10px rgba(0,0,0,0.60);

      -webkit-text-fill-color: transparent;
    }
    .btn-switch:hover{
      transform:translateY(-1px);
      opacity:.95;
      background: radial-gradient(circle at 0% 0%, rgba(255,244,208,0.18), rgba(0,0,0,0.72));
      box-shadow:0 7px 14px rgba(0,0,0,0.78), 0 0 14px rgba(246,211,122,0.18);
    }

    .site-title-wrapper{
      position:fixed;
      top: calc(.18rem + env(safe-area-inset-top));
      left:50%;
      transform:translateX(-50%);
      text-align:center;
      letter-spacing:.38em;
      text-indent:.38em;
      z-index:39;
      pointer-events:none;
    }

    /* ========================== é»ƒæ°´æ™¶ 3Dï¼ˆçµ±ä¸€æ·±é‡‘/èšç„¦ï¼‰ ========================== */
    .crystal{
      color: transparent !important;
      background: var(--gold-deep-1);
      -webkit-background-clip:text;
      background-clip:text;

      -webkit-text-stroke: 1.20px var(--crystal-stroke-dark);

      /* âœ… é™°å½±æ›´èšç„¦ */
      text-shadow:
        -1px 0   0 rgba(0,0,0,0.58),
         1px 0   0 rgba(0,0,0,0.58),
         0  -1px 0 rgba(0,0,0,0.56),
         0   1px 0 rgba(0,0,0,0.56),
         0   2px 0 rgba(0,0,0,0.22),
         0   9px 14px rgba(0,0,0,0.68),
         0   0 10px var(--crystal-glow-soft),
         0   0 18px rgba(246,211,122,0.12);

      -webkit-font-smoothing: antialiased;
      text-rendering: geometricPrecision;

      -webkit-text-fill-color: transparent;
    }

    .crystal-strong{
      -webkit-text-stroke: 1.32px var(--crystal-stroke-dark-2);
      text-shadow:
        -1px 0   0 rgba(0,0,0,0.62),
         1px 0   0 rgba(0,0,0,0.62),
         0  -1px 0 rgba(0,0,0,0.60),
         0   1px 0 rgba(0,0,0,0.60),
         0   3px 0 rgba(0,0,0,0.24),
         0  10px 14px rgba(0,0,0,0.76),
         0   0 12px rgba(246,211,122,0.14),
         0   0 18px rgba(246,211,122,0.10);
    }

    .crystal-shine{
      position: relative;
      display:inline-block;
      isolation:isolate;
    }
    .crystal-shine::after{
      content:"";
      position:absolute;
      inset: 0;
      pointer-events:none;
      z-index: 1;
      background: linear-gradient(115deg,
        rgba(255,255,255,0.00) 0%,
        rgba(255,255,255,0.00) 44%,
        rgba(255,255,255,0.40) 50%,
        rgba(255,255,255,0.00) 56%,
        rgba(255,255,255,0.00) 100%);
      mix-blend-mode: screen;
      opacity:.20;
      transform: translateZ(0);
    }

    /* ========================== ç«™åï¼šé»ƒæ°´æ™¶ 3D ========================== */
    .site-title{
      font-family:"DFKai-SB","æ¨™æ¥·é«”","BiauKai","KaiTi","STKaiti","Kaiti TC","Noto Serif TC",serif;
      font-size: clamp(2.6rem, 4.6vw, 4.0rem);
      font-weight:900;

      color: transparent;
      background: var(--gold-deep-1);
      -webkit-background-clip:text;
      background-clip:text;

      -webkit-text-stroke: 1.30px var(--crystal-stroke-dark-2);

      text-shadow:
        -1px 0   0 rgba(0,0,0,0.62),
         1px 0   0 rgba(0,0,0,0.62),
         0  -1px 0 rgba(0,0,0,0.60),
         0   1px 0 rgba(0,0,0,0.60),
         0   3px 0 rgba(0,0,0,0.20),
         0  14px 18px rgba(0,0,0,0.78),
         0   0 14px rgba(246,211,122,0.16),
         0   0 24px rgba(246,211,122,0.10);

      -webkit-font-smoothing: antialiased;
      text-rendering: geometricPrecision;

      -webkit-text-fill-color: transparent;
    }

    /* ========================== é»ƒæ°´æ™¶å­—ï¼ˆåŸ zen-textï¼‰ ========================== */
    .zen-text{
      position:absolute;
      white-space:nowrap;
      pointer-events:none;
      z-index:10;
      font-family:"DFKai-SB","æ¨™æ¥·é«”","BiauKai","KaiTi","STKaiti","Kaiti TC","Noto Serif TC",serif;
      font-weight:900;
    }

    /* âœ… ç©ºç„¡æ˜ï¼ˆä¸‰å­—ï¼‰ä¿æŒ normal */
    .hero-title{
      left: 0; right: 0;
      top: var(--title-top);
      height: var(--title-h);
      width:auto;
      transform:none;
      pointer-events:none;
      mix-blend-mode: normal;
      z-index:11;
    }
    .hero-title span{
      position:absolute;
      font-size: clamp(3.2rem, 5.4vw, 4.8rem);
      line-height:1;
      letter-spacing:.06em;
      text-indent:.06em;
      opacity: 1;
    }
    .hero-title span:nth-child(1){
      left: 30%;
      top: 28%;
      transform: translate(-50%,-50%) rotate(-12deg) scale(1.03);
    }
    .hero-title span:nth-child(2){
      left: 50%;
      top: 18%;
      transform: translate(-50%,-50%) rotate(0deg) scale(1.03);
    }
    .hero-title span:nth-child(3){
      left: 70%;
      top: 28%;
      transform: translate(-50%,-50%) rotate(12deg) scale(1.03);
    }

    .hero-left, .hero-right{
      top: 58%;
      transform: translateY(-50%);
      display:flex;
      flex-direction:column;
      align-items:center;
      font-size: clamp(1.9rem, 2.7vw, 2.6rem);
      opacity:.92;
      z-index:12;
      filter:none;
    }
    .hero-left { left: calc(50% - clamp(250px, 20vw, 360px)); }
    .hero-right{ left: calc(50% + clamp(250px, 20vw, 360px)); }
    .hero-left span, .hero-right span{
      line-height: 1.18;
      letter-spacing: .14em;
    }
    .char-space{ margin-top: .75em; margin-bottom: .25em; }

    .hero-bottom{
      left:50%;
      bottom: calc(11% + env(safe-area-inset-bottom));
      transform: translateX(-50%);
      display:flex;
      gap: 1.9em;
      font-size: clamp(1.6rem, 2.2vw, 2.2rem);
      opacity: .66;
      z-index:10;
      pointer-events:none;
    }

    /* ========================== Buttons ========================== */
    .nav-area{ position:absolute; inset:0; z-index:25; }

    .nav-btn{
      position:absolute;
      width: var(--btn-w);
      height: var(--btn-h);
      border-radius: 999px;

      border: 1px solid rgba(246, 211, 122, 0.58);

      background:
        radial-gradient(120% 140% at 18% 18%, rgba(255,255,255,0.06), rgba(255,255,255,0.00) 52%),
        radial-gradient(120% 140% at 70% 62%, rgba(246,211,122,0.05), rgba(0,0,0,0.00) 62%),
        linear-gradient(180deg,
          rgba(0,0,0, calc(var(--btn-glass-alpha) * 0.50)),
          rgba(0,0,0, calc(var(--btn-glass-alpha) * 0.70)));

      text-decoration:none;
      cursor:pointer;

      box-shadow:
        0 18px 40px rgba(0,0,0,0.46),
        0 8px 16px rgba(0,0,0,0.30),
        0 0 20px rgba(246,211,122,0.10),
        inset 0 0 0 1px rgba(255,255,255,0.06),
        inset 0 18px 28px rgba(255,255,255,0.03);

      display:flex;
      align-items:center;
      justify-content:center;

      padding: 0 clamp(.90rem, 1.35vw, 1.70rem);

      backdrop-filter: blur(var(--btn-blur)) saturate(1.12);
      -webkit-backdrop-filter: blur(var(--btn-blur)) saturate(1.12);

      transition: transform .18s ease-out, box-shadow .22s ease-out, border-color .2s ease-out, filter .2s ease-out;
      z-index:26;
      transform: translateZ(0);
      overflow:hidden;

      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;

      contain: paint;
      will-change: transform;
    }

    .nav-btn::before{
      content:"";
      position:absolute; inset:-48%;
      background:
        radial-gradient(ellipse at 25% 20%, rgba(255,255,255,0.12), rgba(255,255,255,0.00) 60%),
        radial-gradient(ellipse at 72% 70%, rgba(246,211,122,0.08), rgba(0,0,0,0.00) 64%),
        conic-gradient(from 105deg at 50% 52%,
          rgba(255,255,255,0.00) 0deg,
          rgba(255,255,255,0.05) 70deg,
          rgba(246,211,122,0.05) 150deg,
          rgba(255,255,255,0.00) 240deg,
          rgba(255,255,255,0.04) 320deg,
          rgba(255,255,255,0.00) 360deg);
      opacity: var(--btn-sheen-alpha);
      filter: blur(8px);
      mix-blend-mode: screen;
      pointer-events:none;
      animation: btnSheen 18s ease-in-out infinite;
    }

    .nav-btn::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(ellipse at 50% 26%,
          rgba(255,255,255, calc(var(--btn-light-alpha) * 0.66)) 0%,
          rgba(255,255,255,0.00) 60%),
        radial-gradient(ellipse at 50% 56%,
          rgba(0,0,0, var(--btn-dark-alpha)) 0%,
          rgba(0,0,0,0.00) 72%),
        linear-gradient(180deg,
          rgba(255,255,255,0.02),
          rgba(0,0,0,0.10));
      opacity:.64;
      pointer-events:none;
      mix-blend-mode: normal;
    }

    @keyframes btnSheen{
      0%{ transform: translate(-2%, -1%) rotate(-0.25deg); }
      50%{ transform: translate(2%, 1%) rotate(0.25deg); }
      100%{ transform: translate(-2%, -1%) rotate(-0.25deg); }
    }
    @media (prefers-reduced-motion: reduce){
      .nav-btn::before{ animation:none; }
    }

    .nav-btn:hover{
      transform: translateY(-3px) translateZ(0);
      border-color: rgba(255,235,180,0.90);
      box-shadow:
        0 22px 50px rgba(0,0,0,0.56),
        0 10px 18px rgba(0,0,0,0.36),
        0 0 30px rgba(246,211,122,0.14),
        inset 0 0 0 1px rgba(255,255,255,0.08),
        inset 0 18px 28px rgba(255,255,255,0.04);
      filter: brightness(1.02);
    }

    .nav-btn span{
      position:relative;
      z-index:2;
      display:inline-block;
      width:100%;
      max-width:100%;
      text-align:center;

      line-height:1.12;
      font-size: var(--btn-font-max);
      font-weight: 900;

      letter-spacing: clamp(0.10em, 0.16vw, 0.14em);
      text-indent: 0.10em;

      white-space: normal;
      word-break: break-word;
      overflow-wrap: anywhere;

      color: transparent;
      background: var(--gold-deep-1);
      -webkit-background-clip:text;
      background-clip:text;

      -webkit-text-stroke: 1.30px var(--crystal-stroke-dark-2);

      text-shadow:
        -1px 0 0 rgba(0,0,0,0.62),
         1px 0 0 rgba(0,0,0,0.62),
         0 -1px 0 rgba(0,0,0,0.60),
         0  1px 0 rgba(0,0,0,0.60),
         0  3px 0 rgba(0,0,0,0.20),
         0 10px 14px rgba(0,0,0,0.78),
         0  0 10px rgba(246,211,122,0.12),
         0  0 16px rgba(246,211,122,0.10);

      -webkit-font-smoothing: antialiased;
      text-rendering: geometricPrecision;

      -webkit-text-fill-color: transparent;
    }

    .nav-btn span::before{
      content:"";
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width: calc(86% + .45rem);
      height: calc(86% + .22rem);
      border-radius:999px;
      background: radial-gradient(circle at 40% 35%,
        rgba(255,255,255,0.14),
        rgba(255,255,255,0.06) 46%,
        rgba(255,255,255,0.00) 78%);
      opacity:.16;
      z-index:-1;
      pointer-events:none;
    }

    /* ========================== Mobileï¼šblur å†é™ä½†ç•™ç»ç’ƒ ========================== */
    @media (max-width: 900px){
      :root{
        --outer-side: 10px;
        --stage-top: clamp(3.4rem, 6.2vh, 4.8rem);
        --title-top: calc(var(--stage-top) + clamp(46px, 7.0vh, 76px));
        --title-h: clamp(120px, 15vh, 180px);

        --liquid-op: .18;
        --liquid-speed: 18s;
        --liquid-shift: 3%;

        --btn-h: clamp(58px, 7.2vh, 82px);
        --nav-cols: 2;

        --nav-pad: 22px;

        --sideglass-op: .22;
        --ripple-op: .10;

        --btn-glass-alpha: .08;
        --btn-dark-alpha: .26;
        --btn-light-alpha: .34;
        --btn-sheen-alpha: .18;

        --beam-op: .20;
        --aura-op: .20;
        --fog-op: .20;
      }

      .hero-inner{
        width: calc(100vw - (2 * var(--outer-side)));
        margin: 0 var(--outer-side);
        height:100dvh;
        min-height:100dvh;
        padding:
          calc(1.0rem + env(safe-area-inset-top))
          .75rem
          calc(1.0rem + env(safe-area-inset-bottom));
      }

      .side-glass{ display:none; }
      .ripple-film{
        mask-image:none;
        -webkit-mask-image:none;
        opacity:.08;
      }

      .site-title{ font-size: clamp(2.0rem, 8.2vw, 3.2rem); }
      .hero-title span{ font-size: clamp(2.6rem, 9.6vw, 4.1rem); }

      .hero-left, .hero-right{
        top: 46%;
        font-size: clamp(1.35rem, 5.6vw, 2.0rem);
        opacity:.80;
      }
      .hero-left{ left: calc(50% - 140px); }
      .hero-right{ left: calc(50% + 140px); }

      .hero-bottom{
        bottom: calc(11% + env(safe-area-inset-bottom));
        font-size: clamp(1.6rem, 2.2vw, 2.2rem);
        opacity: .66;
        gap: 1.9em;
      }

      .nav-area{
        position:absolute;
        left: 50%;
        transform: translateX(-50%);
        width: min(560px, calc(100% - (2 * (var(--frame-inset) + var(--glass-inset) + var(--nav-pad)))));
        top:   var(--nav-top);
        bottom: var(--nav-bottom);
        z-index: 28;
        display:grid;
        grid-template-columns: repeat(var(--nav-cols), minmax(0, 1fr));
        gap: var(--nav-gap);
        align-content: center;
        justify-items: stretch;
        pointer-events: auto;
      }

      .nav-btn{
        position:relative;
        width: 100%;
        height: var(--btn-h);
        max-width: 100%;
        padding: 0 .90rem;
        transform: none;

        backdrop-filter: blur(var(--btn-blur-m)) saturate(1.10);
        -webkit-backdrop-filter: blur(var(--btn-blur-m)) saturate(1.10);
      }
      .nav-btn:hover{ transform: translateY(-2px); }

      @media (max-width: 420px){
        :root{ --nav-cols: 1; }
        .nav-area{ width: min(520px, calc(100% - (2 * (var(--frame-inset) + var(--glass-inset) + var(--nav-pad))))); }
      }

      #systemBtn{
        position: relative;
        width: 100%;
        margin: 0;
      }
    }

    /* ================== FIX: é¿å…æ¼¸å±¤å¤±æ•ˆè®Šé»‘ï¼ˆåªå‰©æé‚Šï¼‰ ================== */
    /* 1) å…ˆçµ¦æ‰€æœ‰æ°´æ™¶å­—ä¸€å€‹ã€Œé‡‘è‰²å¯¦å¿ƒã€fallbackï¼Œä»»ä½•æƒ…æ³éƒ½ä¸æœƒé»‘ */
    .site-title,
    .crystal,
    .nav-btn span,
    .user-pill,
    .btn-switch{
      color: var(--gold) !important;               /* âœ… fallback é‡‘è‰² */
      -webkit-text-fill-color: currentColor !important;
    }

    /* 2) åªåœ¨ç€è¦½å™¨ç¢ºå®šæ”¯æ´ background-clip:text æ™‚ï¼Œæ‰åˆ‡æ›åˆ°æ¼¸å±¤æ°´æ™¶å­— */
    @supports ((-webkit-background-clip: text) or (background-clip: text)) {

      .site-title,
      .crystal,
      .nav-btn span,
      .user-pill,
      .btn-switch{
        background-image: var(--gold-deep-1) !important;
        background-size: 100% 100% !important;
        background-repeat: no-repeat !important;

        -webkit-background-clip: text !important;
        background-clip: text !important;

        color: transparent !important;
        -webkit-text-fill-color: transparent !important;

        /* âœ… æé‚Šæ”¹æˆã€Œæ·±é‡‘æ£•ã€è€Œä¸æ˜¯ç´”é»‘ï¼Œé¿å…çœ‹èµ·ä¾†é»‘å­— */
        -webkit-text-stroke-color: rgba(72, 40, 12, 0.82) !important;
      }
    }

    /* 3) é¿å… a é€£çµç‹€æ…‹å¹²æ“¾æ–‡å­—é¡è‰²ï¼ˆvisited/active æœ‰æ™‚æœƒè“‹æ‰ï¼‰ */
    a.nav-btn,
    a.nav-btn:visited,
    a.nav-btn:hover,
    a.nav-btn:active{
      color: inherit !important;
    }

    /* 4) Windows/Chrome å¼·åˆ¶è‰²å½©æ¨¡å¼æ™‚ï¼ˆè‹¥æœ‰ï¼‰ï¼Œç¦ç”¨æé‚Šé¿å…é»‘åˆ°çˆ† */
    @media (forced-colors: active){
      .site-title,
      .crystal,
      .nav-btn span,
      .user-pill,
      .btn-switch{
        -webkit-text-stroke: 0 !important;
        text-shadow: none !important;
      }
    }
  </style>
</head>

<body class="locked">
  <!-- ç™»å…¥é®ç½© -->
  <div class="login-overlay" id="loginOverlay">
    <div class="login-box">
      <div class="login-title">Tasun è³‡æ–™ Â· ç™»å…¥</div>
      <div class="login-sub" id="loginSub"></div>

      <form id="loginForm">
        <div class="login-field">
          <label for="username">ä½¿ç”¨è€…åç¨±</label>
          <select id="username" name="username" autocomplete="username"></select>
        </div>

        <div class="login-field">
          <label for="password">å¯†ç¢¼</label>
          <div class="login-pwd-wrapper">
            <input id="password" name="password" type="password" autocomplete="current-password" class="login-pwd-input" />
            <button type="button" class="btn-eye-login" id="btnTogglePwd">ğŸ‘</button>
          </div>
        </div>

        <div class="login-error" id="loginError"></div>

        <div class="login-actions">
          <button type="submit" class="btn-login">ç™»å…¥</button>
          <button type="button" class="btn-secondary" id="btnForceRelogin">åˆ‡æ›/é‡æ–°ç™»å…¥</button>
        </div>
      </form>
    </div>
  </div>

  <main class="hero">
    <div class="hero-inner">
      <div class="ripple-film" aria-hidden="true"></div>

      <div class="side-glass side-glass-left" aria-hidden="true"></div>
      <div class="side-glass side-glass-right" aria-hidden="true"></div>

      <div class="lotus-stage" aria-hidden="true">
        <div class="zen-visual" aria-hidden="true">
          <!-- âœ… ä¸»è¦–è¦º img ä¹ŸåŠ  vï¼ˆé¿å…èˆŠåœ–ï¼‰ -->
          <img id="zenImg" src="ä½›æ•™ç¦ªæ„ä¸»è¦–è¦º.png" alt="">
        </div>
        <div class="liquid-flow" aria-hidden="true"></div>

        <!-- âœ… ä½›å…‰ï¼ˆä¸Šâ†’ä¸‹ï¼‰ -->
        <div class="divine-beam" aria-hidden="true"></div>
        <!-- âœ… è“®èŠ±å‘¨åœæ™®ç…§ï¼ˆå…§â†’å¤–ï¼‰ -->
        <div class="lotus-aura" aria-hidden="true"></div>
        <!-- âœ… ä¹¾å†°ç…™éœ§ -->
        <div class="lotus-fog" aria-hidden="true"></div>
      </div>

      <div class="user-bar">
        <div class="user-pill" id="userInfo">ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥</div>
        <button class="btn-switch" id="btnSwitchUser" type="button">åˆ‡æ›å¸³è™Ÿ</button>
      </div>

      <div class="site-title-wrapper">
        <div class="site-title">Tasun è³‡æ–™</div>
      </div>

      <!-- âœ… ç©ºç„¡æ˜ï¼šæ›´æ·±é‡‘ã€æ›´éŠ³åˆ© -->
      <div class="zen-text hero-title">
        <span class="crystal crystal-strong crystal-shine">ç©º</span>
        <span class="crystal crystal-strong crystal-shine">ç„¡</span>
        <span class="crystal crystal-strong crystal-shine">æ˜</span>
      </div>

      <div class="zen-text hero-left">
        <span class="crystal">ç©º</span><span class="crystal">éˆ</span><span class="char-space"></span><span class="crystal">ç„¡</span><span class="crystal">æˆ‘</span>
      </div>
      <div class="zen-text hero-right">
        <span class="crystal">æ¸…</span><span class="crystal">æ˜</span><span class="char-space"></span><span class="crystal">å¯§</span><span class="crystal">éœ</span>
      </div>

      <div class="zen-text hero-bottom">
        <span class="crystal">ç©º</span><span class="crystal">ç„¡</span><span class="crystal">æ˜</span><span class="crystal">éœ</span>
      </div>

      <div class="nav-area" id="navArea"></div>
      <a class="nav-btn" id="systemBtn" href="æ¬Šé™è¡¨.html"><span>ç³»çµ± / æ¬Šé™</span></a>
    </div>
  </main>

  <script>
    const AUTH_KEY    = "tasunAuthTable_v1";
    const CURRENT_KEY = "tasunCurrentUser_v1";
    const NAV_KEY     = "tasunNavButtons_v1";
    const SESSION_KEY = "tasunSessionLogin_v1"; // sessionStorage

    const METRO_LABEL = "æ·é‹æ±æ­¢æ±æ¹–ç·š";
    const METRO_FILE  = "æ±æ±å·¥ç¨‹ç®¡ç†è¡¨.html";

    // âœ… çµ±ä¸€ cache-bust ç‰ˆè™Ÿï¼ˆä¾†è‡ª head çš„ __CACHE_Vï¼‰
    const CACHE_V = (window.__CACHE_V || "").trim();

    function metroUrl(){
      const u = new URL(METRO_FILE, document.baseURI);
      if (CACHE_V) u.searchParams.set("v", CACHE_V);
      return u.href;
    }
    function goMetroHard(){
      window.location.assign(metroUrl());
    }

    // âœ… ä¸»è¦–è¦ºåœ–ç‰‡ cache-bustï¼ˆé¿å…æŠ“åˆ°èˆŠåœ–ï¼‰
    (function(){
      if(!CACHE_V) return;

      const withV = (url) => {
        try{
          const u = new URL(url, document.baseURI);
          if (u.origin === location.origin) u.searchParams.set("v", CACHE_V);
          return u.toString();
        }catch(e){ return url; }
      };

      document.addEventListener("DOMContentLoaded", () => {
        const img = document.getElementById("zenImg");
        if(img){
          img.src = withV(img.getAttribute("src") || img.src);
        }
      });
    })();

    function installMetroGuard(){
      const isMetroTarget = (t) => {
        if(!t || t.nodeType !== 1) return false;
        return !!t.closest('#btn2Metro, a[data-metro="1"]');
      };

      const hard = (ev) => {
        try{ ev.preventDefault(); }catch(_){}
        try{ ev.stopPropagation(); }catch(_){}
        try{ ev.stopImmediatePropagation(); }catch(_){}
        goMetroHard();
      };

      document.addEventListener("pointerdown", (ev) => {
        if(isMetroTarget(ev.target)) hard(ev);
      }, { capture:true, passive:false });

      document.addEventListener("touchstart", (ev) => {
        if(isMetroTarget(ev.target)) hard(ev);
      }, { capture:true, passive:false });

      document.addEventListener("click", (ev) => {
        if(isMetroTarget(ev.target)) hard(ev);
      }, { capture:true });

      document.addEventListener("keydown", (ev) => {
        const k = ev.key || "";
        if(k !== "Enter" && k !== " " && k !== "Spacebar") return;
        const a = document.activeElement;
        if(isMetroTarget(a)) hard(ev);
      }, { capture:true });
    }
    installMetroGuard();

    // âœ… å…§éƒ¨é€£çµè‡ªå‹•åŠ ä¸ŠåŒä¸€å€‹ vï¼ˆæ•´ç«™ä¸åƒèˆŠå¿«å–ï¼‰
    function hrefToDom(href){
      const h = String(href || "").trim();
      if(!h) return "#";
      if(/^https?:\/\//i.test(h)) return h;
      if(/^mailto:/i.test(h)) return h;

      const encoded = encodeURI(h);
      if(!CACHE_V) return encoded;

      try{
        const u = new URL(encoded, document.baseURI);
        if (u.origin === location.origin) u.searchParams.set("v", CACHE_V);
        return u.toString();
      }catch(e){
        return encoded;
      }
    }

    const DEFAULT_NAV = [
      { id: "btn1", label: "è‡»é¼æ™‚ä»£å¤§å»ˆç®¡ç†è¡¨", href: "è‡»é¼ç®¡ç†è¡¨.html", target: "", roles: ["admin","write","read"] },
      { id: "btn2", label: METRO_LABEL,           href: METRO_FILE,         target: "", roles: ["admin","write","read"] },
      { id: "btn3", label: "é›²ç«¯æª”æ¡ˆ",            href: "https://www.dropbox.com/", target: "_blank", roles: ["admin","write","read"] },
      { id: "btn4", label: "å·¥ç¨‹è³‡æ–™åº«",          href: "å·¥ç¨‹è³‡æ–™åº«.html", target: "", roles: ["admin","write"] },
      { id: "btn5", label: "è³‡æ–™åº«",              href: "è³‡æ–™åº«.html", target: "", roles: ["admin","write","read"] }
    ];
    const LEGACY_BUTTON_KEYS = ["btn1", "btn2", "btn3", "btn4", "btn5"];

    const $ = (sel) => document.querySelector(sel);

    const loginOverlay = $("#loginOverlay");
    const loginForm    = $("#loginForm");
    const loginError   = $("#loginError");
    const loginSub     = $("#loginSub");
    const userInfo     = $("#userInfo");
    const btnSwitch    = $("#btnSwitchUser");
    const btnTogglePwd = $("#btnTogglePwd");
    const btnForceRelogin = $("#btnForceRelogin");
    const navArea      = $("#navArea");
    const systemBtn    = $("#systemBtn");

    const heroInner = $(".hero-inner");
    const heroBottom = $(".hero-bottom");
    const siteTitleWrapper = $(".site-title-wrapper");
    const heroTitle = $(".hero-title");

    let NAV_CONFIG = [];
    let AUTH_TABLE = [];
    let mainNavBtns = [];
    let currentVisibleBtns = [];

    function setSession(user){
      try{
        sessionStorage.setItem(SESSION_KEY, JSON.stringify({
          user: user.username,
          role: user.level,
          t: Date.now()
        }));
      }catch(e){}
    }
    function clearSession(){
      try{ sessionStorage.removeItem(SESSION_KEY); }catch(e){}
    }
    function getSession(){
      try{
        const obj = JSON.parse(sessionStorage.getItem(SESSION_KEY) || "null");
        if(!obj || typeof obj !== "object") return null;
        const u = String(obj.user || "").trim();
        const r = String(obj.role || "").trim().toLowerCase();
        if(!u) return null;
        return { user: u, role: r, t: Number(obj.t || 0) };
      }catch(e){
        return null;
      }
    }

    function normalizeNavEntry(entry, index) {
      const base = DEFAULT_NAV[index] || {};
      const label = (entry && entry.label ? String(entry.label).trim() : "") || base.label || `æŒ‰éˆ•${index + 1}`;
      const href  = (entry && entry.href  ? String(entry.href).trim()  : "") || base.href  || "#";
      const target= (entry && entry.target? String(entry.target).trim(): "") || base.target|| "";
      const roles = Array.isArray(entry && entry.roles)
        ? entry.roles.slice()
        : (Array.isArray(base.roles) ? base.roles.slice() : ["admin","write","read"]);
      return { id: `btn${index + 1}`, label, href, target, roles };
    }

    function forceMetroBtn2(arr){
      if(!Array.isArray(arr) || arr.length < 2) return arr;
      if(!arr[1]) return arr;

      arr[1].label  = METRO_LABEL;
      arr[1].href   = METRO_FILE;
      arr[1].target = "";
      arr[1].roles  = ["admin","write","read"];

      try{ localStorage.setItem(NAV_KEY, JSON.stringify(arr)); }catch(e){}
      return arr;
    }

    function loadNavConfig() {
      const raw = localStorage.getItem(NAV_KEY);
      if (!raw) {
        const init = DEFAULT_NAV.slice();
        localStorage.setItem(NAV_KEY, JSON.stringify(init));
        return forceMetroBtn2(init);
      }
      try{
        const arr = JSON.parse(raw);
        if (Array.isArray(arr) && arr.length){
          const mapped = arr.map((it, idx) => normalizeNavEntry(it, idx));
          return forceMetroBtn2(mapped);
        }
      }catch(e){}
      const reset = DEFAULT_NAV.slice();
      localStorage.setItem(NAV_KEY, JSON.stringify(reset));
      return forceMetroBtn2(reset);
    }

    function getDefaultAuthTableLegacy(btnCount){
      const keys = Array.from({length: btnCount}, (_, i) => `btn${i+1}`);
      const mkAll = () => Object.fromEntries(keys.map(k => [k, true]));
      const mkOnlyLast = () => Object.fromEntries(keys.map((k, i) => [k, i === btnCount - 1]));
      return [
        { user:"alex",  pass:"Tasun08040224", role:"admin", ...mkAll() },
        { user:"JOYCE", pass:"09220224",      role:"admin", ...mkAll() },
        { user:"tasun", pass:"tasun08040224", role:"write", ...mkAll() },
        { user:"wu",    pass:"123456",        role:"read",  ...mkOnlyLast() }
      ];
    }

    function normalizeRowFromStorage(row, btnCount){
      const username = (row?.username ?? row?.user ?? row?.name ?? row?.account ?? "").toString().trim();
      const password = (row?.password ?? row?.pass ?? "").toString();
      const level    = (row?.level ?? row?.role ?? "read").toString().trim().toLowerCase();

      let buttons = [];
      if(Array.isArray(row?.buttons)) buttons = row.buttons.slice();
      else{
        const legacy = [];
        LEGACY_BUTTON_KEYS.forEach(k => {
          if(Object.prototype.hasOwnProperty.call(row,k)) legacy.push(!!row[k]);
        });
        buttons = legacy;
      }

      const out = [];
      for(let i=0;i<btnCount;i++) out[i] = !!buttons[i];
      return { username, password, level, buttons: out };
    }

    function loadAuthTable(btnCount){
      const raw = localStorage.getItem(AUTH_KEY);

      if(!raw){
        const legacy = getDefaultAuthTableLegacy(btnCount);
        localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
        return legacy.map(r => normalizeRowFromStorage(r, btnCount));
      }

      try{
        const parsed = JSON.parse(raw);
        const arr = Array.isArray(parsed) ? parsed : (parsed && Array.isArray(parsed.users) ? parsed.users : null);
        if(Array.isArray(arr)){
          const mapped = arr.map(r => normalizeRowFromStorage(r, btnCount)).filter(x => x.username);
          if(mapped.length) return mapped;
        }
      }catch(e){}

      const legacy = getDefaultAuthTableLegacy(btnCount);
      localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
      return legacy.map(r => normalizeRowFromStorage(r, btnCount));
    }

    function buildMainButtons(){
      NAV_CONFIG = loadNavConfig();
      AUTH_TABLE = loadAuthTable(NAV_CONFIG.length);

      mainNavBtns = [];
      navArea.innerHTML = "";

      NAV_CONFIG.forEach((cfg, index) => {
        const a = document.createElement("a");
        a.className = "nav-btn";

        const span = document.createElement("span");
        span.textContent = cfg.label;
        a.appendChild(span);

        if(index === 1){
          a.id = "btn2Metro";
          a.dataset.metro = "1";
          a.setAttribute("href", metroUrl());

          const hard = (ev) => {
            ev.preventDefault();
            ev.stopPropagation();
            ev.stopImmediatePropagation();
            goMetroHard();
          };
          a.addEventListener("pointerdown", hard, {capture:true, passive:false});
          a.addEventListener("touchstart",  hard, {capture:true, passive:false});
          a.addEventListener("click",       hard, true);
          a.addEventListener("keydown", (ev) => {
            const k = ev.key || "";
            if(k === "Enter" || k === " " || k === "Spacebar") hard(ev);
          }, true);
        }else{
          a.setAttribute("href", hrefToDom(cfg.href));
        }

        if(cfg.target){
          a.target = cfg.target;
          if(cfg.target === "_blank") a.rel = "noopener noreferrer";
        }

        a.style.display = "none";
        navArea.appendChild(a);
        mainNavBtns.push(a);
      });

      // âœ… ç³»çµ±/æ¬Šé™ ä¹ŸåŠ  vï¼ˆå…§éƒ¨é€£çµï¼‰
      if(systemBtn){
        const href0 = systemBtn.getAttribute("href") || "æ¬Šé™è¡¨.html";
        systemBtn.setAttribute("href", hrefToDom(href0));
        systemBtn.style.display = "none";
      }
    }

    function isRoleAllowedForIndex(index, level){
      const cfg = NAV_CONFIG[index];
      if(!cfg || !Array.isArray(cfg.roles)) return true;
      return cfg.roles.includes(level);
    }

    function fitTextInButton(btn){
      const span = btn && btn.querySelector("span");
      if(!btn || !span) return;

      span.style.fontSize = "";

      const rootCS = getComputedStyle(document.documentElement);
      const maxPx = parseFloat(getComputedStyle(span).fontSize) || 16;
      const minPx = parseFloat(rootCS.getPropertyValue("--btn-font-min")) || 13.5;

      const btnH = btn.clientHeight || 90;
      const usableH = Math.max(44, btnH - 24);

      let f = maxPx;
      let guard = 40;
      while(guard-- > 0){
        const overH = span.scrollHeight > usableH;
        const overW = span.scrollWidth > (btn.clientWidth - 24);
        if(!overH && !overW) break;
        f -= 0.7;
        if(f <= minPx) { f = minPx; break; }
        span.style.fontSize = f + "px";
      }
    }

    function fitAllButtonText(){
      const btns = [];
      (currentVisibleBtns || []).forEach(b => btns.push(b));
      if(systemBtn && systemBtn.style.display !== "none") btns.push(systemBtn);
      btns.forEach(b => fitTextInButton(b));
    }

    function setRootVar(name, value){
      document.documentElement.style.setProperty(name, value);
    }
    function getRootPxVar(name, fallback){
      const v = (getComputedStyle(document.documentElement).getPropertyValue(name) || "").trim();
      const n = parseFloat(v);
      return Number.isFinite(n) ? n : fallback;
    }

    function updateMobileOverlayLayout(){
      const width  = window.innerWidth  || document.documentElement.clientWidth  || 1024;
      const height = window.innerHeight || document.documentElement.clientHeight || 800;

      if(width > 900) return;
      if(!heroInner || !navArea) return;

      const sysVisible = !!(systemBtn && systemBtn.style.display !== "none");
      const visibleBtns = (currentVisibleBtns || []).filter(b => b && b.style.display !== "none");
      const btnCount = visibleBtns.length;
      if(btnCount === 0 && !sysVisible) return;

      const innerRect = heroInner.getBoundingClientRect();

      const topCandidates = [siteTitleWrapper, heroTitle];
      let topBound = innerRect.top + Math.round(height * 0.26);
      topCandidates.forEach(el => {
        if(!el) return;
        const r = el.getBoundingClientRect();
        topBound = Math.max(topBound, r.bottom + 10);
      });

      let bottomBound = innerRect.top + Math.round(height * 0.86);
      if(heroBottom){
        const br = heroBottom.getBoundingClientRect();
        bottomBound = Math.min(bottomBound, br.top - 10);
      }
      bottomBound = Math.min(bottomBound, (innerRect.bottom - 12));

      const topPx = Math.max(0, Math.floor(topBound - innerRect.top));
      const bottomPx = Math.max(0, Math.floor(innerRect.bottom - bottomBound));

      setRootVar("--nav-top", topPx + "px");
      setRootVar("--nav-bottom", bottomPx + "px");

      let cols = 2;
      if(width <= 420) cols = 1;
      else{
        const isVeryLow = height <= 520;
        const wideEnough = width >= 720;
        if(isVeryLow && wideEnough && btnCount >= 6) cols = 3;
      }
      setRootVar("--nav-cols", String(cols));

      const rows = Math.ceil(btnCount / cols);
      const minBtnH = getRootPxVar("--btn-h-mobile-min", 50);

      const navTopAbs = innerRect.top + topPx;
      const navBottomAbs = innerRect.bottom - bottomPx;
      const availableH = Math.max(120, navBottomAbs - navTopAbs);

      let gap = getRootPxVar("--nav-gap", 12);
      gap = Math.max(8, Math.min(gap, Math.floor(availableH * 0.045)));

      const k = rows + (sysVisible ? 1 : 0);
      const maxBtnH = Math.floor((availableH - gap * (Math.max(0, rows - 1) + (sysVisible ? 1 : 0))) / Math.max(1, k));
      const btnH = Math.max(minBtnH, Math.min(getComputedBtnH(), maxBtnH));

      setRootVar("--nav-gap", gap + "px");
      setRootVar("--btn-h", btnH + "px");

      requestAnimationFrame(fitAllButtonText);
    }

    function getComputedBtnH(){
      const probe = document.createElement("div");
      probe.style.position = "fixed";
      probe.style.left = "-9999px";
      probe.style.top = "-9999px";
      probe.style.height = "var(--btn-h)";
      probe.style.width = "10px";
      document.body.appendChild(probe);
      const px = probe.getBoundingClientRect().height || 84;
      probe.remove();
      return px;
    }

    function layoutDesktopButtons(){
      const width = window.innerWidth || document.documentElement.clientWidth || 1024;
      if(width <= 900) return;

      const stage = document.querySelector(".lotus-stage");
      const leftText = document.querySelector(".hero-left");
      const rightText = document.querySelector(".hero-right");
      if(!heroInner || !stage) return;

      const heroRect  = heroInner.getBoundingClientRect();
      const stageRect = stage.getBoundingClientRect();
      const leftRect  = leftText ? leftText.getBoundingClientRect() : null;
      const rightRect = rightText ? rightText.getBoundingClientRect() : null;

      const btnsAll = (currentVisibleBtns || []).slice();
      if(systemBtn && systemBtn.style.display !== "none") btnsAll.push(systemBtn);

      const count = btnsAll.length;
      if(!count) return;

      btnsAll.forEach(b => { b.style.display = "flex"; });

      const safe = Math.max(28, Math.min(58, width * 0.032));
      const edgePad = Math.max(38, Math.min(78, width * 0.042));

      const stageLeft  = stageRect.left + safe;
      const stageRight = stageRect.right - safe;

      const leftZoneL = stageLeft + edgePad;
      const leftZoneR = leftRect ? (leftRect.left - safe) : (stageRect.left + stageRect.width * 0.40);

      const rightZoneL = rightRect ? (rightRect.right + safe) : (stageRect.left + stageRect.width * 0.60);
      const rightZoneR = stageRight - edgePad;

      const rowCount = Math.ceil(count / 2);

      const uiTopSafe = heroRect.top + 140;
      let yStart = stageRect.top + stageRect.height * 0.22;
      let yEnd   = stageRect.top + stageRect.height * 0.70;

      if(yStart < uiTopSafe) yStart = uiTopSafe;
      if(yEnd < yStart + 80){
        yEnd = Math.min(stageRect.bottom - 90, yStart + 220);
      }

      const step   = rowCount > 1 ? (yEnd - yStart) / (rowCount - 1) : 0;

      btnsAll.forEach((btn, idx) => {
        const row = Math.floor(idx / 2);
        const col = idx % 2;

        btn.style.width = "";
        btn.style.right = "";

        const rect0 = btn.getBoundingClientRect();
        const desiredW = rect0.width || 330;

        let zoneL, zoneR, x;
        if(col === 0){
          zoneL = leftZoneL;
          zoneR = leftZoneR;
          const maxW = Math.max(210, zoneR - zoneL);
          const w = Math.min(desiredW, maxW);
          btn.style.width = w + "px";
          x = zoneL;
        }else{
          zoneL = rightZoneL;
          zoneR = rightZoneR;
          const maxW = Math.max(210, zoneR - zoneL);
          const w = Math.min(desiredW, maxW);
          btn.style.width = w + "px";
          x = zoneR - w;
        }

        if(!(zoneR > zoneL)){
          const w = Math.min(desiredW, Math.max(230, (stageRect.width * 0.36)));
          btn.style.width = w + "px";
          x = (col === 0) ? (stageRect.left + edgePad) : (stageRect.right - edgePad - w);
        }

        const y = yStart + step * row;

        btn.style.left = (x - heroRect.left) + "px";
        btn.style.top  = (y - heroRect.top)  + "px";
      });

      requestAnimationFrame(fitAllButtonText);
    }

    let layoutScheduled = false;
    function scheduleLayout(){
      if(layoutScheduled) return;
      layoutScheduled = true;
      requestAnimationFrame(() => {
        layoutScheduled = false;
        const width = window.innerWidth || document.documentElement.clientWidth || 1024;
        if(width <= 900) updateMobileOverlayLayout();
        else layoutDesktopButtons();
      });
    }

    window.addEventListener("resize", scheduleLayout, { passive:true });
    window.addEventListener("orientationchange", scheduleLayout, { passive:true });

    function applyUser(user){
      document.body.classList.remove("locked");
      loginOverlay.style.display = "none";
      loginSub.textContent = "";

      setSession(user);
      localStorage.setItem(CURRENT_KEY, JSON.stringify({ user: user.username, role: user.level }));

      userInfo.textContent = `ç›®å‰ä½¿ç”¨è€…ï¼š${user.username} (${user.level})`;

      const visibleMain = [];
      mainNavBtns.forEach((btn, index) => {
        const allowedByRole = isRoleAllowedForIndex(index, user.level);

        const flags = Array.isArray(user.buttons) ? user.buttons : [];
        let allowedByAuth = index < flags.length ? !!flags[index] : true;

        if(user.level === "read" && index === 1){
          allowedByAuth = true;
        }

        if(allowedByRole && allowedByAuth){
          btn.style.display = "flex";
          visibleMain.push(btn);
        }else{
          btn.style.display = "none";
        }
      });
      currentVisibleBtns = visibleMain;

      if(systemBtn){
        systemBtn.style.display = (user.level === "admin") ? "flex" : "none";
      }

      scheduleLayout();
      requestAnimationFrame(fitAllButtonText);
    }

    function populateUserSelect(){
      const sel = document.getElementById("username");
      const btnCount = (NAV_CONFIG && NAV_CONFIG.length) ? NAV_CONFIG.length : DEFAULT_NAV.length;

      AUTH_TABLE = loadAuthTable(btnCount);
      sel.innerHTML = "";

      if(!AUTH_TABLE.length){
        const opt = document.createElement("option");
        opt.value = "";
        opt.textContent = "ï¼ˆå°šç„¡ä½¿ç”¨è€…ï¼Œè«‹å…ˆåˆ°ã€Œç³»çµ± / æ¬Šé™ã€æ–°å¢ï¼‰";
        opt.disabled = true;
        opt.selected = true;
        sel.appendChild(opt);
        return;
      }

      const ph = document.createElement("option");
      ph.value = "";
      ph.textContent = "è«‹é¸æ“‡ä½¿ç”¨è€…";
      ph.disabled = true;
      ph.selected = true;
      sel.appendChild(ph);

      const names = Array.from(new Set(AUTH_TABLE.map(r => r.username).filter(Boolean)));
      names.sort((a,b)=>a.localeCompare(b, "zh-Hant"));

      names.forEach(name => {
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        sel.appendChild(opt);
      });
    }

    function resetButtonsForLogout(){
      currentVisibleBtns = [];
      mainNavBtns.forEach(btn => {
        btn.style.display = "none";
        btn.style.top=""; btn.style.left=""; btn.style.right="";
        btn.style.width = "";
      });
      if(systemBtn){
        systemBtn.style.display="none";
        systemBtn.style.top=""; systemBtn.style.left=""; systemBtn.style.right="";
        systemBtn.style.width = "";
      }
    }

    function findUser(username, password){
      const u = (username || "").trim();
      return AUTH_TABLE.find(row => row.username === u && row.password === password);
    }

    function getCurrentUserNameFromStorage(){
      try{
        const obj = JSON.parse(localStorage.getItem(CURRENT_KEY) || "null");
        if(!obj || typeof obj !== "object") return "";
        return String(obj.user || obj.username || "").trim();
      }catch(e){
        return "";
      }
    }

    function showLogin(){
      document.body.classList.add("locked");
      loginOverlay.style.display = "flex";
      loginError.textContent = "";
      loginSub.textContent = "";
      document.getElementById("password").value = "";

      populateUserSelect();
      resetButtonsForLogout();
      userInfo.textContent = "ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥";

      const last = getCurrentUserNameFromStorage();
      const sel = document.getElementById("username");
      if(last && sel){
        const opt = Array.from(sel.options).find(o => o.value === last);
        if(opt) sel.value = last;
      }

      autoEnterIfSessionValid();
    }

    function autoEnterIfSessionValid(){
      const sess = getSession();
      if(!sess) return;

      const u = AUTH_TABLE.find(r => r.username === sess.user);
      if(!u){
        clearSession();
        return;
      }
      if(String(u.level || "").toLowerCase() !== String(sess.role || "").toLowerCase()){
        clearSession();
        return;
      }

      loginSub.textContent = `å·²ç™»å…¥ï¼š${u.username}ï¼ˆ${u.level}ï¼‰â€¦ æ­£åœ¨é€²å…¥`;
      setTimeout(() => {
        if(!getSession()) return;
        applyUser(u);
      }, 280);
    }

    buildMainButtons();
    showLogin();

    window.addEventListener("storage", (e) => {
      if(e.key === AUTH_KEY){
        try{ AUTH_TABLE = loadAuthTable((NAV_CONFIG && NAV_CONFIG.length) ? NAV_CONFIG.length : DEFAULT_NAV.length); }catch(_){}
        if(document.body.classList.contains("locked")){
          populateUserSelect();
          autoEnterIfSessionValid();
        }
      }
      if(e.key === NAV_KEY){
        try{
          buildMainButtons();
          if(document.body.classList.contains("locked")){
            populateUserSelect();
            autoEnterIfSessionValid();
          }else{
            const name = getCurrentUserNameFromStorage();
            const u = AUTH_TABLE.find(r => r.username === name);
            if(u) applyUser(u);
            else showLogin();
          }
        }catch(_){}
      }
    });

    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      if(!username){
        loginError.textContent = "è«‹å…ˆé¸æ“‡ä½¿ç”¨è€…åç¨±ã€‚";
        return;
      }

      const user = findUser(username, password);
      if(!user){
        loginError.textContent = "å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚";
        return;
      }
      loginError.textContent = "";
      applyUser(user);
      document.getElementById("password").value = "";
    });

    btnForceRelogin.addEventListener("click", () => {
      clearSession();
      loginSub.textContent = "è«‹é‡æ–°è¼¸å…¥å¯†ç¢¼ç™»å…¥";
      loginError.textContent = "";
      document.getElementById("password").value = "";
      document.getElementById("password").focus();
    });

    btnSwitch.addEventListener("click", () => {
      clearSession();
      localStorage.removeItem(CURRENT_KEY);
      showLogin();
    });

    btnTogglePwd.addEventListener("click", () => {
      const pwd = document.getElementById("password");
      pwd.type = (pwd.type === "password") ? "text" : "password";
    });

    window.addEventListener("load", scheduleLayout, { once:true });
  </script>
</body>
</html>
