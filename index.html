<!DOCTYPE html>  
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Tasun Ë≥áÊñôÈ¶ñÈ†Å ¬∑ Á©∫ÁÑ°Êòé</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --gold: #f6d37a;

      /* ‚úÖ ÊåâÈçµËàá‰∏ªË¶ñË¶∫Ë∑ùÈõ¢Ôºà‰Ω†Ë¶Å 0.2cmÔºâ */
      --stage-gap: 0.2cm;

      --side-btn-offset: clamp(5%, 8vw, 10%);
      --btn-w: clamp(240px, 22vw, 420px);
      --stage-inset-x: calc(var(--side-btn-offset) + var(--btn-w) + var(--stage-gap));

      --frame-inset: clamp(0.6rem, 1.2vw, 1.2rem);
      --frame-radius: clamp(22px, 2vw, 34px);
      --stage-top: clamp(4.0rem, 7vh, 5.4rem);

      /* ‚úÖ Á¶™Â≠óÈù†Ëøë‰∏≠ÂøÉÔºàÂ∞è‰∏ÄÈªû=Êõ¥Èù†‰∏≠ÂøÉÔºâÔºå‰ΩÜË¶ÅÈÅøÂÖçÊíûÂà∞ÂºßÂΩ¢Â≠ó */
      --text-instage: clamp(1.2rem, 2.6vw, 2.6rem);

      /* ‚úÖ ÂéüÊú¨ÂºßÂΩ¢ÂèÉÊï∏‰øùÁïô */
      --arc-top: clamp(16%, 18vh, 18%);
      --arc-w: min(520px, 56vw);

      /* ‚úÖ Â≠óÈ´îÂ§ßÂ∞è */
      --arc-font: clamp(3.2rem, 5.2vw, 4.4rem);
      --side-font: clamp(2.1rem, 3.0vw, 2.8rem);
      --bottom-font: clamp(1.7rem, 2.4vw, 2.3rem);

      /* ‚úÖ ‰∏ªË¶ñË¶∫ËûçÂÖ•ËÉåÊôØ */
      --zen-opacity: 0.72;
      --zen-scale: 1.14;
      --zen-contrast: 1.06;
      --zen-bright: 1.07;

      /* ‚úÖ ‰∏≠Â§ÆÂ∑¶Âè≥ÈäúÊé•ÔºöÁæΩÂåñÂº∑Â∫¶ */
      --edge-fade: 18%;

      /* ‚úÖ„ÄåÁ©∫ÁÑ°Êòé„Äç‰ΩçÁΩÆ */
      --title-top: calc(var(--stage-top) + clamp(58px, 9.2vh, 96px));
      --title-h: clamp(150px, 18vh, 220px);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body{
      min-height:100vh;
      font-family:"Noto Serif TC","Ê®ôÊ•∑È´î","Microsoft JhengHei",serif;
      background:#050302;
      color:var(--gold);
      overflow-x:hidden;
    }
    body.locked { overflow:hidden; }
    body.locked main.hero { visibility:hidden; }
    body:not(.locked) main.hero { visibility:visible; }

    /* ========================== Login ========================== */
    .login-overlay{
      position:fixed; inset:0;
      background: radial-gradient(circle at 50% 18%, rgba(255,228,170,0.35), rgba(0,0,0,0.98));
      display:flex; align-items:center; justify-content:center;
      z-index:999;
    }
    .login-box{
      width:min(380px,90vw);
      padding:2.4rem 2.6rem 2.2rem;
      border-radius:18px;
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.28), rgba(0,0,0,0.94));
      border:1px solid rgba(246,211,122,0.35);
      box-shadow:0 0 24px rgba(0,0,0,0.9), 0 0 32px rgba(246,211,122,0.25);
      color:rgba(246,211,122,0.75);
    }
    .login-title{
      text-align:center;
      font-size:1.4rem;
      letter-spacing:.2em;
      text-indent:.2em;
      margin-bottom:1.6rem;
      text-shadow:0 0 8px rgba(246,211,122,0.8), 0 0 18px rgba(246,211,122,0.5);
    }
    .login-field{ margin-bottom:1rem; }
    .login-field label{
      display:block;
      font-size:.85rem;
      letter-spacing:.18em;
      text-indent:.18em;
      margin-bottom:.3rem;
      color:rgba(246,211,122,0.75);
    }
    .login-field input, .login-field select{
      width:100%;
      padding:.55rem .7rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.5);
      background:rgba(0,0,0,0.8);
      color:var(--gold);
      outline:none;
    }
    .login-field input:focus, .login-field select:focus{
      border-color:rgba(255,238,190,0.9);
      box-shadow:0 0 12px rgba(246,211,122,0.7);
    }
    .login-pwd-wrapper{ display:flex; align-items:center; gap:.45rem; }
    .login-pwd-input{ flex:1 1 auto; }
    .btn-eye-login{
      padding:.25rem .7rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.8);
      background:rgba(0,0,0,0.85);
      color:var(--gold);
      font-size:.8rem;
      cursor:pointer;
      box-shadow:0 0 8px rgba(0,0,0,0.6);
    }
    .btn-eye-login:hover{ background:rgba(246,211,122,0.2); }
    .login-error{
      min-height:1.1rem;
      margin-bottom:.4rem;
      font-size:.8rem;
      color:#ffb3b3;
      text-align:center;
    }
    .login-actions{ margin-top:.8rem; display:flex; justify-content:center; }
    .btn-login{
      padding:.55rem 2.8rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.9);
      background:radial-gradient(circle at 0% 0%, rgba(246,211,122,0.36), rgba(0,0,0,0.98));
      color:var(--gold);
      font-size:.95rem;
      letter-spacing:.22em;
      text-indent:.22em;
      cursor:pointer;
      box-shadow:0 10px 18px rgba(0,0,0,0.95), 0 0 18px rgba(246,211,122,0.5);
      transition:transform .15s ease-out, box-shadow .2s ease-out, background .2s ease-out, border-color .2s ease-out;
    }
    .btn-login:hover{
      transform:translateY(-1px);
      box-shadow:0 12px 22px rgba(0,0,0,0.98), 0 0 22px rgba(246,211,122,0.8);
      border-color:#fff4cf;
      background:radial-gradient(circle at 0% 0%, rgba(255,244,208,0.45), rgba(0,0,0,0.97));
    }

    /* ========================== Hero ========================== */
    .hero{
      position:relative;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      color:var(--gold);
    }
    .hero::before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 50% 12%,
          rgba(255,237,180,0.92) 0,
          rgba(255,237,180,0.42) 18%,
          rgba(255,237,180,0.10) 40%,
          rgba(255,237,180,0.00) 60%),
        linear-gradient(to bottom,
          rgba(0,0,0,0.86) 0%,
          rgba(0,0,0,0.62) 30%,
          rgba(0,0,0,0.46) 56%,
          rgba(0,0,0,0.58) 100%);
      z-index:-6;
    }
    .hero::after{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(circle at 50% 60%, rgba(246,211,122,0.10) 0, rgba(0,0,0,0.00) 55%),
        radial-gradient(circle at 50% 64%, rgba(0,0,0,0.00) 0, rgba(0,0,0,0.28) 58%, rgba(0,0,0,0.66) 100%);
      z-index:-5;
      pointer-events:none;
    }

    .hero-inner{
      position:relative;
      width:100%;
      max-width:1400px;
      height:100vh;
      margin:0 auto;
      padding:clamp(1.2rem,2vw,1.8rem);
      isolation:isolate;
    }

    .hero-inner::after{
      content:"";
      position:absolute;
      inset:var(--frame-inset);
      border-radius:var(--frame-radius);
      background:
        radial-gradient(circle at 50% 18%, rgba(255,244,210,0.06), rgba(255,244,210,0.00) 58%),
        linear-gradient(180deg, rgba(255,255,255,0.05), rgba(255,255,255,0.015));
      border:1px solid rgba(246,211,122,0.22);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.06),
        0 0 28px rgba(0,0,0,0.55),
        0 0 26px rgba(246,211,122,0.10);
      z-index:-4;
      pointer-events:none;
    }

    .lotus-stage{
      position:absolute;
      top:var(--stage-top);
      bottom:var(--frame-inset);
      left:var(--stage-inset-x);
      right:var(--stage-inset-x);
      border-radius:calc(var(--frame-radius) - 6px);
      background:none;
      z-index:-3;
      pointer-events:none;
      overflow:hidden;
    }
    .lotus-stage::before{
      content:"";
      position:absolute; inset:-12%;
      background:
        radial-gradient(ellipse at 50% 55%,
          rgba(246,211,122,0.12) 0%,
          rgba(246,211,122,0.06) 30%,
          rgba(0,0,0,0.00) 70%),
        radial-gradient(circle at 50% 60%,
          rgba(0,0,0,0.00) 0%,
          rgba(0,0,0,0.16) 58%,
          rgba(0,0,0,0.72) 100%);
      filter: blur(16px);
      opacity: .88;
      pointer-events:none;
    }
    .lotus-stage::after{
      content:"";
      position:absolute; inset:0;
      background:
        linear-gradient(90deg,
          rgba(0,0,0,0.78) 0%,
          rgba(0,0,0,0.28) var(--edge-fade),
          rgba(0,0,0,0.00) 50%,
          rgba(0,0,0,0.28) calc(100% - var(--edge-fade)),
          rgba(0,0,0,0.78) 100%);
      pointer-events:none;
      opacity:.92;
    }

    .zen-visual{
      position:absolute; inset:0;
      display:flex; align-items:center; justify-content:center;
      opacity: var(--zen-opacity);
      pointer-events:none;
    }
    .zen-visual img{
      width: 120%;
      height: 120%;
      object-fit: cover;
      object-position: center;
      transform: scale(var(--zen-scale)) translateZ(0);
      filter:
        saturate(1.03)
        contrast(var(--zen-contrast))
        brightness(var(--zen-bright))
        drop-shadow(0 26px 40px rgba(0,0,0,0.55));
    }

    /* ========================== Top UI ========================== */
    .user-bar{
      position:fixed;
      top:.8rem;
      left:.9rem;
      display:flex;
      align-items:center;
      gap:.75rem;
      z-index:10;
    }
    .user-pill{
      padding:.30rem 1.05rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.55);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.18), rgba(0,0,0,0.88));
      font-size:.82rem;
      letter-spacing:.10em;
      text-indent:.10em;
      opacity:.90;
      box-shadow:0 3px 8px rgba(0,0,0,0.75), 0 0 10px rgba(246,211,122,0.18);
      white-space:nowrap;
    }
    .btn-switch{
      padding:.26rem 1.00rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.62);
      background: radial-gradient(circle at 0% 0%, rgba(246,211,122,0.22), rgba(0,0,0,0.92));
      color:var(--gold);
      font-size:.80rem;
      letter-spacing:.10em;
      text-indent:.10em;
      cursor:pointer;
      opacity:.86;
      box-shadow:0 4px 9px rgba(0,0,0,0.82), 0 0 10px rgba(246,211,122,0.20);
      transition:transform .15s ease-out, box-shadow .2s ease-out, background .2s ease-out, opacity .2s ease-out;
    }
    .btn-switch:hover{
      transform:translateY(-1px);
      opacity:.96;
      background: radial-gradient(circle at 0% 0%, rgba(255,244,208,0.30), rgba(0,0,0,0.93));
      box-shadow:0 7px 14px rgba(0,0,0,0.90), 0 0 14px rgba(246,211,122,0.30);
    }

    .site-title-wrapper{
      position:fixed;
      top:.18rem;
      left:50%;
      transform:translateX(-50%);
      text-align:center;
      letter-spacing:.38em;
      text-indent:.38em;
      z-index:9;
      pointer-events:none;
    }
    .site-title{
      font-family:"DFKai-SB","Ê®ôÊ•∑È´î","BiauKai","KaiTi","STKaiti","Kaiti TC","Noto Serif TC",serif;
      font-size: clamp(2.6rem, 4.6vw, 4.0rem);
      font-weight:700;
      -webkit-text-stroke:.8px rgba(255,244,208,0.42);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.65),
        0 2px 0 rgba(0,0,0,0.55),
        0 10px 22px rgba(0,0,0,0.88),
        0 0 18px rgba(246,211,122,0.92),
        0 0 40px rgba(246,211,122,0.65);
      filter: drop-shadow(0 10px 18px rgba(0,0,0,0.85));
    }

    /* ========================== ÈªÉÊ∞¥Êô∂Â≠ó ========================== */
    .zen-text{
      position:absolute;
      white-space:nowrap;
      pointer-events:none;
      z-index:6;
      font-family:"DFKai-SB","Ê®ôÊ•∑È´î","BiauKai","KaiTi","STKaiti","Kaiti TC","Noto Serif TC",serif;
      font-weight:700;
    }
    .zen-text span{
      display:inline-block;
      color: transparent;
      background:
        linear-gradient(180deg,
          rgba(255,255,255,0.95) 0%,
          rgba(255,248,220,0.90) 16%,
          rgba(255,228,160,0.96) 34%,
          rgba(246,211,122,1.00) 54%,
          rgba(214,142,48,0.96) 78%,
          rgba(255,238,190,0.92) 100%);
      -webkit-background-clip:text;
      background-clip:text;

      -webkit-text-stroke: 1px rgba(255,220,140,0.38);

      text-shadow:
        0 1px 0 rgba(255,255,255,0.18),
        0 3px 0 rgba(0,0,0,0.18),
        0 10px 22px rgba(0,0,0,0.66),
        0 0 16px rgba(255,248,220,0.70),
        0 0 34px rgba(246,211,122,0.70),
        0 0 78px rgba(246,211,122,0.26);

      filter:
        drop-shadow(0 14px 14px rgba(0,0,0,0.34))
        drop-shadow(0 0 18px rgba(246,211,122,0.40));
      opacity:.98;
    }

    /* ========================== Á©∫ÁÑ°ÊòéÔºà‰∏âÂ≠óÔºâ ========================== */
    .hero-title{
      left: var(--stage-inset-x);
      right: var(--stage-inset-x);
      top: var(--title-top);
      height: var(--title-h);
      width:auto;
      transform:none;
      pointer-events:none;
      mix-blend-mode: screen;
      z-index:6;
    }
    .hero-title span{
      position:absolute;
      font-size: var(--arc-font);
      line-height:1;
      letter-spacing:.06em;
      text-indent:.06em;
    }
    .hero-title span:nth-child(1){
      left: 18%;
      top: 28%;
      transform: translate(-50%,-50%) rotate(-12deg) scale(1.02);
      opacity:.98;
    }
    /* ‚úÖ ÁÑ°Ôºö‰ΩçÁΩÆ‰∏çÂãïÔºåÂè™ÊääÂ≠óÈ´îÊì∫Ê≠£Ôºà‰∏çÊóãËΩâÔºâ */
    .hero-title span:nth-child(2){
      left: 50%;
      top: 18%;
      transform: translate(-50%,-50%) rotate(0deg) scale(1.02);
      opacity:.98;
    }
    .hero-title span:nth-child(3){
      left: 82%;
      top: 28%;
      transform: translate(-50%,-50%) rotate(12deg) scale(1.02);
    }

    /* ‚úÖ Â∑¶Âè≥Á¶™Â≠ó */
    .hero-left, .hero-right{
      top: 60%;
      transform: translateY(-50%);
      display:flex;
      flex-direction:column;
      align-items:center;
      font-size: var(--side-font);
      opacity:.94;
    }
    .hero-left { left: calc(var(--stage-inset-x) + var(--text-instage)); }
    .hero-right{ right: calc(var(--stage-inset-x) + var(--text-instage)); }
    .hero-left span, .hero-right span{
      line-height: 1.20;
      letter-spacing: .14em;
    }
    .char-space{ margin-top: .75em; margin-bottom: .25em; }

    /* ‚úÖ ‰∏ãÊéí */
    .hero-bottom{
      left:50%;
      bottom: 11%;
      transform: translateX(-50%);
      display:flex;
      gap: 1.9em;
      font-size: var(--bottom-font);
      opacity: .68;
      z-index:5;
    }

    /* ========================== Buttons ========================== */
    .nav-area{ position:absolute; inset:0; z-index:8; }

    .nav-btn{
      position:absolute;
      width: var(--btn-w);
      height: clamp(78px, 9.5vh, 112px);
      border-radius: 999px;
      border: 1px solid rgba(246, 211, 122, 0.92);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.14), rgba(255,255,255,0.04)),
        radial-gradient(circle at 0% 0%, rgba(246, 211, 122, 0.26), rgba(0,0,0,0.84));
      color: var(--gold);
      text-decoration:none;
      cursor:pointer;
      box-shadow:
        0 14px 26px rgba(0,0,0,0.95),
        0 0 26px rgba(246, 211, 122, 0.36);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 clamp(1.6rem, 2.6vw, 3.0rem);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      transition: transform .2s ease-out, box-shadow .2s ease-out, border-color .2s ease-out, background .25s ease-out;
      z-index:9;
    }
    .nav-btn span{
      display:-webkit-box;
      -webkit-box-orient:vertical;
      -webkit-line-clamp:2;
      overflow:hidden;
      text-align:center;
      line-height:1.22;
      font-size: clamp(1.02rem, 1.15vw, 1.22rem);
      letter-spacing: clamp(0.10em, 0.20vw, 0.18em);
      text-indent: 0.12em;
      word-break: keep-all;
    }
    .nav-btn:hover{
      transform: translateY(-3px);
      box-shadow:
        0 18px 34px rgba(0,0,0,0.95),
        0 0 34px rgba(246, 211, 122, 0.72);
      border-color: rgba(255,235,180,0.98);
      background:
        linear-gradient(180deg, rgba(255,255,255,0.18), rgba(255,255,255,0.06)),
        radial-gradient(circle at 0% 0%, rgba(255,240,200,0.30), rgba(0,0,0,0.86));
    }

    /* ========================== Mobile ========================== */
    @media (max-width: 900px){
      :root{
        --stage-inset-x: clamp(0.8rem, 3vw, 1.1rem);
        --arc-font: 3.1rem;
        --side-font: 2.0rem;
        --bottom-font: 1.8rem;
        --text-instage: .9rem;

        --zen-opacity: 0.68;
        --zen-scale: 1.18;
        --edge-fade: 22%;

        --title-top: calc(var(--stage-top) + clamp(54px, 8.6vh, 86px));
        --title-h: clamp(140px, 18vh, 200px);
      }

      .hero-inner{
        width:100vw;
        height:auto;
        min-height:100vh;
        max-width:none;
        padding:1.2rem .75rem 2.2rem;
      }

      .lotus-stage{
        left: var(--stage-inset-x);
        right: var(--stage-inset-x);
      }

      .hero-left,.hero-right{ top: 60%; }

      .nav-area{
        position: static;
        display:flex;
        flex-wrap:wrap;
        justify-content:center;
        gap: .9rem;
        margin: min(56vh, 430px) auto .8rem;
        padding: 0 .6rem 0;
      }
      .nav-btn{
        position: relative;
        flex: 0 1 calc(50% - .9rem);
        max-width: 360px;
        width:auto;
        height:78px;
        padding: 0 1.2rem;
      }
      #systemBtn{
        position: relative;
        right:auto; left:auto; top:auto; bottom:auto;
      }

      .hero-title span:nth-child(1){
        left: 20%;
        top: 30%;
        transform: translate(-50%,-50%) rotate(-12deg) scale(1.02);
        opacity:.98;
      }
      .hero-title span:nth-child(2){
        left: 50%;
        top: 20%;
        transform: translate(-50%,-50%) rotate(0deg) scale(1.02);
        opacity:.98;
      }
      .hero-title span:nth-child(3){
        left: 80%;
        top: 30%;
        transform: translate(-50%,-50%) rotate(12deg) scale(1.02);
      }
    }

    @media (min-width: 901px) {
      .nav-btn {
        max-width: calc(var(--stage-inset-x) - var(--side-btn-offset) - 1.2vw);
      }
    }
  </style>
</head>

<body class="locked">
  <!-- ÁôªÂÖ•ÈÅÆÁΩ© -->
  <div class="login-overlay" id="loginOverlay">
    <div class="login-box">
      <div class="login-title">Tasun Ë≥áÊñô ¬∑ ÁôªÂÖ•</div>
      <form id="loginForm">
        <div class="login-field">
          <label for="username">‰ΩøÁî®ËÄÖÂêçÁ®±</label>
          <select id="username" name="username" autocomplete="username"></select>
        </div>
        <div class="login-field">
          <label for="password">ÂØÜÁ¢º</label>
          <div class="login-pwd-wrapper">
            <input id="password" name="password" type="password" autocomplete="current-password" class="login-pwd-input" />
            <button type="button" class="btn-eye-login" id="btnTogglePwd">üëÅ</button>
          </div>
        </div>
        <div class="login-error" id="loginError"></div>
        <div class="login-actions">
          <button type="submit" class="btn-login">ÁôªÂÖ•</button>
        </div>
      </form>
    </div>
  </div>

  <main class="hero">
    <div class="hero-inner">

      <!-- ‰∏≠Â§ÆËàûÂè∞ + ‰∏ªË¶ñË¶∫ -->
      <div class="lotus-stage" aria-hidden="true">
        <div class="zen-visual" aria-hidden="true">
          <img src="‰ΩõÊïôÁ¶™ÊÑè‰∏ªË¶ñË¶∫.png" alt="">
        </div>
      </div>

      <!-- ‰ΩøÁî®ËÄÖË≥áË®äÂàó -->
      <div class="user-bar">
        <div class="user-pill" id="userInfo">ÁõÆÂâç‰ΩøÁî®ËÄÖÔºöÊú™ÁôªÂÖ•</div>
        <button class="btn-switch" id="btnSwitchUser">ÂàáÊèõÂ∏≥Ëôü</button>
      </div>

      <!-- Ê®ôÈ°å -->
      <div class="site-title-wrapper">
        <div class="site-title">Tasun Ë≥áÊñô</div>
      </div>

      <!-- Á©∫ÁÑ°Êòé -->
      <div class="zen-text hero-title">
        <span>Á©∫</span><span>ÁÑ°</span><span>Êòé</span>
      </div>

      <!-- Â∑¶Âè≥Á¶™Â≠ó -->
      <div class="zen-text hero-left">
        <span>Á©∫</span><span>Èùà</span><span class="char-space"></span><span>ÁÑ°</span><span>Êàë</span>
      </div>
      <div class="zen-text hero-right">
        <span>Ê∏Ö</span><span>Êòé</span><span class="char-space"></span><span>ÂØß</span><span>Èùú</span>
      </div>

      <!-- ‰∏ãÊéí -->
      <div class="zen-text hero-bottom">
        <span>Á©∫</span><span>ÁÑ°</span><span>Êòé</span><span>Èùú</span>
      </div>

      <!-- ‰∏ªÊåâÈàïÂçÄ -->
      <div class="nav-area" id="navArea"></div>

      <!-- Á≥ªÁµ±/Ê¨äÈôêÔºàadminÔºâ -->
      <a class="nav-btn nav-right bottom" id="systemBtn" href="Ê¨äÈôêË°®.html"><span>Á≥ªÁµ± / Ê¨äÈôê</span></a>

    </div>
  </main>

  <script>
    const AUTH_KEY    = "tasunAuthTable_v1";
    const CURRENT_KEY = "tasunCurrentUser_v1";
    const NAV_KEY     = "tasunNavButtons_v1";

    // ‚úÖ Êú¨Ê¨°ÁÄèË¶ΩÂô®ÈñãÂïüÊúüÈñìÁôªÂÖ•ÊóóÊ®ôÔºàSession CookieÔºöÈóúÈñâÁÄèË¶ΩÂô®Â∞±Ê∂àÂ§±Ôºâ
    const SESSION_COOKIE = "tasunSessionLogin_v1";

    const DEFAULT_NAV = [
      { id: "btn1", label: "ËáªÈºéÊôÇ‰ª£Â§ßÂªàÁÆ°ÁêÜË°®", href: "ËáªÈºéÁÆ°ÁêÜË°®.html", target: "", roles: ["admin","write","read"] },
      { id: "btn2", label: "Áº∫Â§± / ÂìÅË≥™",       href: "ÁîÑÈºéquality.html", target: "", roles: ["admin","write","read"] },
      { id: "btn3", label: "Èõ≤Á´ØÊ™îÊ°à",          href: "https://www.dropbox.com/", target: "_blank", roles: ["admin","write","read"] },
      { id: "btn4", label: "Â∑•Á®ãË≥áÊñôÂ∫´",        href: "Â∑•Á®ãË≥áÊñôÂ∫´.html", target: "", roles: ["admin","write"] },
      { id: "btn5", label: "Ë≥áÊñôÂ∫´",            href: "Ë≥áÊñôÂ∫´.html", target: "", roles: ["admin","write","read"] }
    ];
    const LEGACY_BUTTON_KEYS = ["btn1", "btn2", "btn3", "btn4", "btn5"];

    const loginOverlay = document.getElementById("loginOverlay");
    const loginForm    = document.getElementById("loginForm");
    const loginError   = document.getElementById("loginError");
    const userInfo     = document.getElementById("userInfo");
    const btnSwitch    = document.getElementById("btnSwitchUser");
    const btnTogglePwd = document.getElementById("btnTogglePwd");
    const navArea      = document.getElementById("navArea");
    const systemBtn    = document.getElementById("systemBtn");

    let NAV_CONFIG = [];
    let AUTH_TABLE = [];
    let mainNavBtns = [];
    let currentVisibleBtns = [];

    // ===== Cookie helpers (session cookie) =====
    function getCookie(name){
      const m = document.cookie.match(new RegExp("(?:^|; )" + name.replace(/([.$?*|{}()[\]\\/+^])/g, "\\$1") + "=([^;]*)"));
      return m ? decodeURIComponent(m[1]) : "";
    }
    function hasSessionLogin(){ return getCookie(SESSION_COOKIE) === "1"; }
    function setSessionLogin(){ document.cookie = `${SESSION_COOKIE}=1; path=/; SameSite=Lax`; }
    function clearSessionLogin(){ document.cookie = `${SESSION_COOKIE}=; Max-Age=0; path=/; SameSite=Lax`; }

    function normalizeNavEntry(entry, index) {
      const base = DEFAULT_NAV[index] || {};
      const label = (entry && entry.label ? String(entry.label).trim() : "") || base.label || `ÊåâÈàï${index + 1}`;
      const href  = (entry && entry.href  ? String(entry.href).trim()  : "") || base.href  || "#";
      const target= (entry && entry.target? String(entry.target).trim(): "") || base.target|| "";
      const roles = Array.isArray(entry && entry.roles)
        ? entry.roles.slice()
        : (Array.isArray(base.roles) ? base.roles.slice() : ["admin","write","read"]);
      return { id: `btn${index + 1}`, label, href, target, roles };
    }

    function loadNavConfig() {
      const raw = localStorage.getItem(NAV_KEY);
      if (!raw) { localStorage.setItem(NAV_KEY, JSON.stringify(DEFAULT_NAV.slice())); return DEFAULT_NAV.slice(); }
      try{
        const arr = JSON.parse(raw);
        if (Array.isArray(arr) && arr.length) return arr.map((it, idx) => normalizeNavEntry(it, idx));
      }catch(e){}
      localStorage.setItem(NAV_KEY, JSON.stringify(DEFAULT_NAV.slice()));
      return DEFAULT_NAV.slice();
    }

    // ‚úÖ Ëàá„ÄåÊ¨äÈôêË°®.html„ÄçÁõ∏ÂÆπÁöÑ legacy seedÔºàuser/pass/role + btn1..Ôºâ
    function getDefaultAuthTableLegacy(btnCount){
      const keys = Array.from({length: btnCount}, (_, i) => `btn${i+1}`);
      const mkAll = () => Object.fromEntries(keys.map(k => [k, true]));
      const mkOnlyLast = () => Object.fromEntries(keys.map((k, i) => [k, i === btnCount - 1]));
      return [
        { user:"alex",  pass:"Tasun08040224", role:"admin", ...mkAll() },
        { user:"JOYCE", pass:"09220224",      role:"admin", ...mkAll() },
        { user:"tasun", pass:"tasun08040224", role:"write", ...mkAll() },
        { user:"wu",    pass:"123456",        role:"read",  ...mkOnlyLast() }
      ];
    }

    function normalizeRowFromStorage(row, btnCount){
      const username = (row?.username ?? row?.user ?? row?.name ?? row?.account ?? "").toString().trim();
      const password = (row?.password ?? row?.pass ?? "").toString();
      const level    = (row?.level ?? row?.role ?? "read").toString().trim().toLowerCase();

      let buttons = [];
      if(Array.isArray(row?.buttons)) buttons = row.buttons.slice();
      else{
        const legacy = [];
        LEGACY_BUTTON_KEYS.forEach(k => {
          if(Object.prototype.hasOwnProperty.call(row,k)) legacy.push(!!row[k]);
        });
        buttons = legacy;
      }

      const out = [];
      for(let i=0;i<btnCount;i++) out[i] = !!buttons[i];
      return { username, password, level, buttons: out };
    }

    // ‚úÖÔºàÊ†∏ÂøÉ‰øÆÊ≠£ÔºâÊØèÊ¨°ÈÉΩÂæû localStorage ÈáçÊñ∞ÊäìÊ¨äÈôêË°®ÔºåÈÅøÂÖç‰∏ãÊãâËÆäÁ©∫
    function loadAuthTable(btnCount){
      const raw = localStorage.getItem(AUTH_KEY);

      if(!raw){
        const legacy = getDefaultAuthTableLegacy(btnCount);
        localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
        return legacy.map(r => normalizeRowFromStorage(r, btnCount));
      }

      try{
        const parsed = JSON.parse(raw);

        // ÂÖÅË®±ÔºöÈô£Âàó Êàñ {users:[...]}ÔºàÊõ¥‰øùÈö™Ôºâ
        const arr = Array.isArray(parsed) ? parsed : (parsed && Array.isArray(parsed.users) ? parsed.users : null);
        if(Array.isArray(arr)){
          const mapped = arr.map(r => normalizeRowFromStorage(r, btnCount)).filter(x => x.username);
          if(mapped.length) return mapped;
        }
      }catch(e){}

      const legacy = getDefaultAuthTableLegacy(btnCount);
      localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
      return legacy.map(r => normalizeRowFromStorage(r, btnCount));
    }

    function buildMainButtons(){
      NAV_CONFIG = loadNavConfig();
      AUTH_TABLE = loadAuthTable(NAV_CONFIG.length);

      mainNavBtns = [];
      navArea.innerHTML = "";

      NAV_CONFIG.forEach((cfg) => {
        const a = document.createElement("a");
        a.className = "nav-btn";
        const span = document.createElement("span");
        span.textContent = cfg.label;
        a.appendChild(span);

        a.href = cfg.href || "#";
        if(cfg.target){
          a.target = cfg.target;
          if(cfg.target === "_blank") a.rel = "noopener noreferrer";
        }

        a.style.display = "none";
        navArea.appendChild(a);
        mainNavBtns.push(a);
      });

      if(systemBtn) systemBtn.style.display = "none";
    }

    function layoutMainButtonsResponsive(){
      const width = window.innerWidth || document.documentElement.clientWidth || 1024;
      if(width <= 900) return;

      const btns = (currentVisibleBtns || []).slice();
      if(systemBtn && systemBtn.style.display !== "none") btns.push(systemBtn);

      const count = btns.length;
      if(!count) return;

      const rowCount = Math.ceil(count / 2);
      const topStart = 30, topEnd = 70;
      const step = rowCount > 1 ? (topEnd - topStart) / (rowCount - 1) : 0;

      btns.forEach((btn, idx) => {
        const row = Math.floor(idx / 2);
        const col = idx % 2;
        const top = topStart + step * row;

        btn.style.top = top + "%";
        btn.style.left = "";
        btn.style.right = "";
        if(col === 0) btn.style.left = "var(--side-btn-offset)";
        else btn.style.right = "var(--side-btn-offset)";
        btn.style.display = "flex";
      });
    }

    window.addEventListener("resize", layoutMainButtonsResponsive);

    function isRoleAllowedForIndex(index, level){
      const cfg = NAV_CONFIG[index];
      if(!cfg || !Array.isArray(cfg.roles)) return true;
      return cfg.roles.includes(level);
    }

    function applyUser(user){
      document.body.classList.remove("locked");
      loginOverlay.style.display = "none";

      // ‚úÖ Ë®≠ÂÆöÊú¨Ê¨°ÁÄèË¶ΩÂô® session Â∑≤ÁôªÂÖ•ÔºàÈóúÈñâÁÄèË¶ΩÂô®Â∞±ÊúÉÊ∂àÂ§±Ôºâ
      setSessionLogin();

      // ‚úÖ Ê¨äÈôêË°®ËÆÄÂæóÊáÇÁöÑÊ†ºÂºè
      localStorage.setItem(CURRENT_KEY, JSON.stringify({ user: user.username, role: user.level }));

      userInfo.textContent = `ÁõÆÂâç‰ΩøÁî®ËÄÖÔºö${user.username} (${user.level})`;

      const visibleMain = [];
      mainNavBtns.forEach((btn, index) => {
        const allowedByRole = isRoleAllowedForIndex(index, user.level);
        const flags = Array.isArray(user.buttons) ? user.buttons : [];
        const allowedByAuth = index < flags.length ? !!flags[index] : true;

        if(allowedByRole && allowedByAuth){
          btn.style.display = "flex";
          visibleMain.push(btn);
        }else{
          btn.style.display = "none";
        }
      });
      currentVisibleBtns = visibleMain;

      if(systemBtn){
        systemBtn.style.display = (user.level === "admin") ? "flex" : "none";
      }

      layoutMainButtonsResponsive();
    }

    // ‚úÖÔºàÊ†∏ÂøÉ‰øÆÊ≠£Ôºâ‰∏ãÊãâÈÅ∏ÂñÆÊ∞∏ÈÅ†‰æù AUTH_KEY Âç≥ÊôÇÁîüÊàê
    function populateUserSelect(){
      const sel = document.getElementById("username");
      const btnCount = (NAV_CONFIG && NAV_CONFIG.length) ? NAV_CONFIG.length : DEFAULT_NAV.length;

      AUTH_TABLE = loadAuthTable(btnCount);

      sel.innerHTML = "";

      if(!AUTH_TABLE.length){
        const opt = document.createElement("option");
        opt.value = "";
        opt.textContent = "ÔºàÂ∞öÁÑ°‰ΩøÁî®ËÄÖÔºåË´ãÂÖàÂà∞„ÄåÁ≥ªÁµ± / Ê¨äÈôê„ÄçÊñ∞Â¢ûÔºâ";
        opt.disabled = true;
        opt.selected = true;
        sel.appendChild(opt);
        return;
      }

      // placeholder
      const ph = document.createElement("option");
      ph.value = "";
      ph.textContent = "Ë´ãÈÅ∏Êìá‰ΩøÁî®ËÄÖ";
      ph.disabled = true;
      ph.selected = true;
      sel.appendChild(ph);

      // unique + sort
      const names = Array.from(new Set(AUTH_TABLE.map(r => r.username).filter(Boolean)));
      names.sort((a,b)=>a.localeCompare(b, "zh-Hant"));

      names.forEach(name => {
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        sel.appendChild(opt);
      });
    }

    function resetButtonsForLogout(){
      currentVisibleBtns = [];
      mainNavBtns.forEach(btn => { btn.style.display = "none"; btn.style.top=""; btn.style.left=""; btn.style.right=""; });
      if(systemBtn){ systemBtn.style.display="none"; systemBtn.style.top=""; systemBtn.style.left=""; systemBtn.style.right=""; }
    }

    function findUser(username, password){
      const u = (username || "").trim();
      return AUTH_TABLE.find(row => row.username === u && row.password === password);
    }

    // ‚úÖ ËÆÄÂèñÁõÆÂâç‰ΩøÁî®ËÄÖÔºàÂÖºÂÆπËàäÊ¨Ñ‰ΩçÔºöusername/levelÔºâ
    function getCurrentUserNameFromStorage(){
      try{
        const obj = JSON.parse(localStorage.getItem(CURRENT_KEY) || "null");
        if(!obj || typeof obj !== "object") return "";
        return String(obj.user || obj.username || "").trim();
      }catch(e){
        return "";
      }
    }

    // ‚úÖ È°ØÁ§∫ÁôªÂÖ•Áï´Èù¢Ôºà‰ΩÜ‰∏çÂà™ session cookieÔºõÂè™ÊòØË¶ÅÊ±ÇÈáçÊñ∞ÁôªÂÖ•Ôºâ
    function showLogin(){
      document.body.classList.add("locked");
      loginOverlay.style.display = "flex";
      loginError.textContent = "";
      document.getElementById("password").value = "";

      // ‚úÖ ÊØèÊ¨°È°ØÁ§∫ÁôªÂÖ•ÈÉΩÈáçÊäìÊ¨äÈôêË°® ‚Üí ‰∏ãÊãâ‰∏çÊúÉÁ©∫
      populateUserSelect();

      resetButtonsForLogout();
      userInfo.textContent = "ÁõÆÂâç‰ΩøÁî®ËÄÖÔºöÊú™ÁôªÂÖ•";
    }

    // ===== init =====
    buildMainButtons();
    resetButtonsForLogout();
    populateUserSelect();

    // ‚úÖ Á¨¨‰∏ÄÊ¨°ÈñãÂïü(Ê≤íÊúâ session cookie) => Ê∏ÖÊéâ CURRENT_KEYÔºåÂº∑Âà∂ÁôªÂÖ•
    if(!hasSessionLogin()){
      localStorage.removeItem(CURRENT_KEY);
    }

    // ‚úÖ Â∑≤Âú®Âêå‰∏ÄÁÄèË¶ΩÂô®ÈñãÂïüÊúüÈñìÁôªÂÖ•ÈÅéÔºöÂèØËá™ÂãïÈÄ≤ÂÖ•Ôºå‰∏çÂøÖÂÜçÁôªÂÖ•ÔºàÂê´Âà∑Êñ∞/Êñ∞ÂàÜÈ†ÅÔºâ
    const curName = getCurrentUserNameFromStorage();
    if(hasSessionLogin() && curName){
      const u = AUTH_TABLE.find(r => r.username === curName);
      if(u){
        applyUser(u);
        document.getElementById("password").value = "";
      }else{
        showLogin();
      }
    }else{
      showLogin();
    }

    // ‚úÖ Ëã•Ê¨äÈôêË°®Âú®Âè¶‰∏ÄÂàÜÈ†ÅË¢´Êõ¥Êñ∞ÔºåÈÄôË£°Á´ãÂàªÂà∑Êñ∞‰∏ãÊãâ
    window.addEventListener("storage", (e) => {
      if(e.key === AUTH_KEY){
        try{ AUTH_TABLE = loadAuthTable((NAV_CONFIG && NAV_CONFIG.length) ? NAV_CONFIG.length : DEFAULT_NAV.length); }catch(_){}
        if(document.body.classList.contains("locked")) populateUserSelect();
      }
    });

    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const username = document.getElementById("username").value;
      const password = document.getElementById("password").value;

      if(!username){
        loginError.textContent = "Ë´ãÂÖàÈÅ∏Êìá‰ΩøÁî®ËÄÖÂêçÁ®±„ÄÇ";
        return;
      }

      const user = findUser(username, password);
      if(!user){
        loginError.textContent = "Â∏≥ËôüÊàñÂØÜÁ¢ºÈåØË™§ÔºåË´ãÂÜçË©¶‰∏ÄÊ¨°„ÄÇ";
        return;
      }
      loginError.textContent = "";
      applyUser(user);
      document.getElementById("password").value = "";
    });

    // ÂàáÊèõÂ∏≥ËôüÔºöÊ∏ÖÊéâÁõÆÂâç‰ΩøÁî®ËÄÖÔºåÁ´ãÂàªÂõûÁôªÂÖ•Áï´Èù¢ÔºàÂêå‰∏ÄÁÄèË¶ΩÂô® session ‰ªçÊúâÊïàÔºâ
    btnSwitch.addEventListener("click", () => {
      localStorage.removeItem(CURRENT_KEY);
      showLogin();
    });

    btnTogglePwd.addEventListener("click", () => {
      const pwd = document.getElementById("password");
      pwd.type = (pwd.type === "password") ? "text" : "password";
    });
  </script>
</body>
</html>
