<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Tasun è³‡æ–™é¦–é  Â· ç©ºç„¡æ˜</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />

  <!-- âœ…æ¶ˆæ‰ favicon 404ï¼ˆä¸å½±éŸ¿åŠŸèƒ½ï¼‰ -->
  <link rel="icon" href="data:,">

  <!-- âœ…âœ…âœ… å¼·åˆ¶ã€Œæœ€æ–°ç‰ˆä¸€è‡´ã€ï¼šåªè¦æ”¹ APP_VER -->
  <meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, max-age=0">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">

  <!-- âœ… 1) æ¯æ¬¡æ”¹ç‰ˆåªæ”¹é€™è£¡ï¼ˆè¨˜å¾—èˆ‡ tasun-core.js?v åŒæ­¥ï¼‰ -->
  <script>window.TASUN_APP_VER="20260127_01";</script>

  <!-- âœ… 2) è¼‰å…¥å…±ç”¨æ ¸å¿ƒï¼ˆåŒè³‡æ–™å¤¾ï¼‰ -->
  <script src="tasun-core.js?v=20260127_01"></script>

  <!-- âœ… 3) åˆå§‹åŒ–ï¼šç‰ˆæœ¬åŒæ­¥ + ç¶²è·¯æ–·ç·šæç¤º + è³‡æºè‡ªå‹•è£œ v + appHeightVar -->
  <script>
    if(window.TasunCore){
      TasunCore.init({
        pageKey: "index",
        forceVersionSync: true,
        networkToast: true,
        patchResources: true,
        appHeightVar: true
      });
    }
  </script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <!-- âœ… preload ä¹Ÿè£œä¸Š vï¼Œé¿å…ä¸åŒé›»è…¦å¿«å–ä¸ä¸€è‡´ -->
  <link id="preloadZen" rel="preload" as="image" href="ä½›æ•™ç¦ªæ„ä¸»è¦–è¦º.png?v=20260127_01">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --gold:#f6d37a;

      /* âœ… èƒŒæ™¯ä¸å†é‚£éº¼æ·±ï¼šèˆå°æ›´äº®ã€æœ‰ç»ç’ƒæ¶²åŒ–æ„Ÿä½†ä¸å£“å­— */
      --exposure: 1.09;
      --ambient-op: 0.54;

      /* âœ… èˆå°æ›´å¤§ */
      --outer-side: clamp(10px, 1.15vw, 26px);
      --frame-inset: clamp(14px, 1.20vw, 22px);
      --frame-radius: clamp(22px, 2vw, 34px);

      --stage-top: var(--frame-inset);
      --glass-inset: var(--frame-inset);

      /* âœ…è“®èŠ±æ›´æ¸…æ¾ˆä½†ä¸åˆºçœ¼ */
      --zen-opacity: 0.985;
      --zen-scale: 1.00;
      --zen-contrast: 1.18;
      --zen-bright: 1.10;
      --zen-sat: 1.04;
      --zen-posX: 50%;
      --zen-posY: 50%;

      /* âœ…æ¶²åŒ–æ³¢ç´‹ï¼šæ¥µæ·¡ï¼Œé¿å…æ´—å­— */
      --ripple-op: .0048;
      --ripple-speed: 26s;

      /* âœ…å´ç»ç’ƒï¼šæ›´æ·¡ï¼Œæ›´å°‘éœ§åŒ– */
      --sideglass-w: clamp(120px, 8.6vw, 220px);
      --sideglass-op: .082;
      --sideglass-hi: rgba(255,255,255,.12);
      --sideglass-hi2: rgba(255,255,255,.05);
      --sideglass-gold: rgba(246,211,122,.070);
      --sideglass-dark: rgba(20,14,10,.002);

      /* âœ…é™ä½æœƒéœ§åŒ–æ–‡å­—çš„ blurï¼ˆèˆå°ç»ç’ƒ/æŒ‰éµç»ç’ƒ/å´ç»ç’ƒï¼‰ */
      --stage-blur: 2.8px;
      --panel-blur: 2.6px;
      --btn-blur: 2.2px;
      --btn-blur-m: 2.4px;

      /* æ¨™é¡Œ */
      --title-top: calc(0.9rem + env(safe-area-inset-top));
      --title-shift: clamp(44px, 6.6vh, 104px);
      --title-size: clamp(2.65rem, 4.9vw, 4.15rem);

      /* ä¸Šæ–¹ã€Œç©º/ç„¡/æ˜ã€ï¼šç”± JS è‡ªå‹•ç®— */
      --axis-top: clamp(140px, 18vh, 320px);
      --axis-gap: clamp(96px, 12vw, 240px);

      /* å·¦å³ç¸±æ’ï¼ˆè²¼è¿‘è“®èŠ±æœ¬é«”ï¼‰ï¼šç”± JS åŒæ­¥ä½ç½® */
      --zen-side-cx: 320px;
      --zen-side-cy: 50%;

      /* ===== é»ƒæ°´æ™¶ 3Dï¼ˆé—œéµå­—ç”¨ï¼‰===== */
      --txt-gold-strong: rgba(255, 226, 160, 0.998);
      --txt-stroke: rgba(112, 60, 18, 0.72);
      --txt-shadow-1: rgba(18, 9, 3, 0.34);
      --txt-shadow-2: rgba(18, 9, 3, 0.20);
      --txt-glow: rgba(255, 224, 150, 0.14);

      /* âœ…æŒ‰éµç»ç’ƒï¼šæ›´æ·¡æ›´è¼•ï¼ˆä½†å­—æ›´æ¸…æ¥šã€åå…‰ä¸æ´—å­—ï¼‰ */
      --btn-glass-a: 0.020;
      --btn-glass-b: 0.010;
      --btn-border: rgba(246, 211, 122, 0.30);

      /* âœ…ä¸­å¤®æŠ•å°„ç‡ˆï¼šæ¸›å¼±é¿å…å£“å­— */
      --lotus-spot-op: .22;

      /* ç…™éœ§ï¼šç¶­æŒæ·¡å†·ç™½ */
      --mist-op: .20;
      --mist-a: rgba(235,245,255,0.18);
      --mist-b: rgba(225,238,250,0.12);
      --mist-c: rgba(255,255,255,0.06);
      --mist-beam: rgba(240,248,255,0.10);
      --mist-blur: 22px;
      --mist-speed: 46s;

      /* æ‰‹æ©Ÿ nav å®‰å…¨å€ */
      --nav-top-m: calc(var(--frame-inset) + 96px);
      --nav-bottom-m: calc(var(--frame-inset) + 18px);

      /* ===== ç™»å…¥å€ ===== */
      --login-border: rgba(246,211,122,0.62);
      --login-border2: rgba(255,244,210,0.22);

      --login-solid-top: rgba(34, 22, 12, 0.96);
      --login-solid-bot: rgba(15, 10, 6, 0.97);
      --login-hi: rgba(255,250,235,0.16);
      --login-hi2: rgba(246,211,122,0.12);

      --login-field-bg: rgba(10, 7, 4, 0.78);
      --login-field-bg2: rgba(255,250,235,0.08);

      --login-ink: rgba(246,211,122,0.99);
      --login-stroke: rgba(0,0,0,0.40);
      --login-shadow-a: rgba(10,6,2,0.34);
      --login-shadow-b: rgba(10,6,2,0.22);

      /* âœ…âœ…âœ… ç¦ªå­—ã€Œå¿…å®šå¯è¦‹ä½†ä¸æ¶æˆ²ã€ï¼šåˆ†åˆ¥æ§åˆ¶è»¸/å´/ä¸‹ï¼ˆé¿å…ä¸åŒé›»è…¦çœ‹ä¸åˆ°ï¼‰ */
      --zw-fill: rgba(255,240,210,0.52);
      --zw-stroke: rgba(78,40,12,0.22);
      --zw-shadow: rgba(0,0,0,0.22);
      --zw-glow: rgba(255,238,200,0.06);

      --zw-axis-op: 0.44;     /* ä¸Šæ–¹ ç©ºç„¡æ˜ */
      --zw-side-op: 0.36;     /* å·¦å³ç›´æ’ */
      --zw-bottom-op: 0.40;   /* ä¸‹æ–¹æ©«æ’ */
      --zw-bottom-pad: calc(var(--frame-inset) + 14px); /* JS æœƒè‡ªå‹•ä¿åº•ï¼šé¿å…è¢«åº•éƒ¨æŒ‰éµé®ä½ */
    }

    *{ box-sizing:border-box; margin:0; padding:0; }
    html, body { height: 100%; }

    body{
      min-height:100vh;
      font-family:"Noto Serif TC","æ¨™æ¥·é«”","Microsoft JhengHei",serif;
      color:var(--gold);
      overflow-x:hidden;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      text-rendering: geometricPrecision;

      background:
        radial-gradient(1200px 760px at 50% 8%, rgba(255,255,255,var(--ambient-op)) 0, rgba(235,240,245,0.16) 46%, rgba(0,0,0,0) 82%),
        radial-gradient(980px 560px at 50% 92%, rgba(246,211,122,0.10) 0, rgba(0,0,0,0) 74%),
        linear-gradient(180deg, #6b5a46 0%, #4a3b2e 46%, #33281f 100%);
      filter: brightness(var(--exposure)) saturate(1.02);
    }
    body.locked{ overflow:hidden; }
    body.booting *{ transition:none !important; }

    /* ========== é»ƒæ°´æ™¶ 3Dï¼šåªç”¨åœ¨ã€Œé—œéµæ–‡å­—ã€ ========== */
    .crystal-ui{
      color: var(--txt-gold-strong);
      -webkit-text-stroke: 1.10px var(--txt-stroke);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.18),
        0 3px 0 rgba(0,0,0,0.22),
        0 10px 24px var(--txt-shadow-1),
        0 0 18px var(--txt-glow);
      letter-spacing: .12em;
    }

    /* ========== ä¸»èˆå°å®¹å™¨ï¼ˆåœ“è§’æ¡†ï¼‰ ========== */
    .hero{
      min-height: var(--appH, 100vh);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: var(--outer-side);
    }
    .hero-inner{
      position:relative;
      width: min(1680px, calc(100vw - (var(--outer-side) * 2)));
      height: calc(var(--appH, 100vh) - (var(--outer-side) * 2));
      min-height: 560px;
      border-radius: calc(var(--frame-radius) + 18px);
      overflow:hidden;
    }
    .hero-inner::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.07), rgba(0,0,0,0.06)),
        radial-gradient(1200px 760px at 50% 50%, rgba(255,255,255,0.12), rgba(0,0,0,0));
      box-shadow:
        0 26px 80px rgba(0,0,0,0.38),
        inset 0 1px 0 rgba(255,255,255,0.06);
      border: 1px solid rgba(246,211,122,0.18);
      pointer-events:none;
    }

    /* ========== èˆå°ï¼ˆèƒŒæ™¯åœ–æ‰€åœ¨ï¼‰ ========== */
    .lotus-stage{
      position:absolute;
      left: var(--frame-inset);
      right: var(--frame-inset);
      top: var(--stage-top);
      bottom: var(--frame-inset);
      border-radius: var(--frame-radius);
      overflow:hidden;

      background:
        radial-gradient(1200px 740px at 50% 18%, rgba(255,255,255,0.10), rgba(0,0,0,0) 62%),
        linear-gradient(180deg, rgba(30,20,12,0.16), rgba(10,7,4,0.22));

      border: 1px solid rgba(246,211,122,0.20);
      box-shadow:
        inset 0 0 0 1px rgba(255,255,255,0.04),
        inset 0 14px 34px rgba(0,0,0,0.16);

      backdrop-filter: blur(var(--stage-blur));
      -webkit-backdrop-filter: blur(var(--stage-blur));
    }

    .zen-visual{ position:absolute; inset:0; }
    .zen-visual img{
      width:100%;
      height:100%;
      object-fit: cover;
      object-position: var(--zen-posX) var(--zen-posY);
      transform: scale(var(--zen-scale));
      opacity: var(--zen-opacity);
      filter: contrast(var(--zen-contrast)) brightness(var(--zen-bright)) saturate(var(--zen-sat));
      display:block;
    }

    .spotlight{
      position:absolute;
      inset:0;
      background:
        radial-gradient(900px 520px at 50% 55%, rgba(255,255,255,var(--lotus-spot-op)) 0, rgba(0,0,0,0) 70%),
        radial-gradient(900px 520px at 50% 30%, rgba(246,211,122,0.09) 0, rgba(0,0,0,0) 72%);
      pointer-events:none;
      mix-blend-mode: screen;
    }

    /* ========== æ³¢ç´‹/ç…™éœ§è–„è†œï¼ˆéå¸¸æ·¡ï¼Œé¿å…æ´—å­—ï¼‰ ========== */
    .ripple-film, .mist-film{
      position:absolute;
      inset: var(--frame-inset);
      border-radius: var(--frame-radius);
      pointer-events:none;
      z-index: 2;
      overflow:hidden;
    }
    .ripple-film::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:
        repeating-radial-gradient(circle at 50% 70%,
          rgba(255,255,255,var(--ripple-op)) 0 2px,
          rgba(0,0,0,0) 2px 18px);
      transform: rotate(8deg);
      animation: rippleMove var(--ripple-speed) linear infinite;
    }
    @keyframes rippleMove{
      0%{ transform: translate3d(-2%,0,0) rotate(8deg); }
      100%{ transform: translate3d(2%,0,0) rotate(8deg); }
    }

    .mist-film::before{
      content:"";
      position:absolute;
      inset:-30%;
      background:
        radial-gradient(900px 520px at 30% 30%, var(--mist-a), rgba(0,0,0,0) 70%),
        radial-gradient(900px 520px at 70% 35%, var(--mist-b), rgba(0,0,0,0) 72%),
        linear-gradient(110deg, rgba(0,0,0,0), var(--mist-beam), rgba(0,0,0,0));
      filter: blur(var(--mist-blur));
      opacity: var(--mist-op);
      animation: mistDrift var(--mist-speed) ease-in-out infinite;
    }
    @keyframes mistDrift{
      0%{ transform: translate3d(-2%, -1%, 0); }
      50%{ transform: translate3d(2%, 1%, 0); }
      100%{ transform: translate3d(-2%, -1%, 0); }
    }

    /* ========== å·¦å³ç»ç’ƒå…‰å¸¶ï¼ˆæ›´æ·¡ã€æ›´ä¸éœ§å­—ï¼‰ ========== */
    .side-glass{
      position:absolute;
      top: calc(var(--frame-inset) + 10px);
      bottom: calc(var(--frame-inset) + 10px);
      width: var(--sideglass-w);
      border-radius: 999px;
      z-index: 3;
      opacity: var(--sideglass-op);
      pointer-events:none;
      background:
        linear-gradient(180deg, var(--sideglass-hi), var(--sideglass-hi2)),
        radial-gradient(420px 680px at 50% 50%, var(--sideglass-gold), rgba(0,0,0,0));
      filter: blur(0.6px);
    }
    .side-glass-left{ left: calc(var(--frame-inset) + 12px); }
    .side-glass-right{ right: calc(var(--frame-inset) + 12px); }

    /* ========== ä¸Šæ–¹å¤§æ¨™é¡Œï¼ˆé»ƒæ°´æ™¶ 3Dï¼‰ ========== */
    .site-title-wrapper{
      position:absolute;
      left: 50%;
      top: calc(var(--frame-inset) + 10px);
      transform: translateX(-50%);
      z-index: 9;
      pointer-events:none;
    }
    .site-title{
      font-size: var(--title-size);
      letter-spacing: .16em;
      text-align:center;
      opacity: .96;
    }

    /* ========== âœ…âœ…âœ… ç¦ªå­—ï¼ˆç©©å®šé¡¯ç¤º + è‡ªå‹•ä¿åº•ä½ç½®/é€æ˜åº¦ï¼‰ ========== */
    .zen-words{
      position:absolute;
      inset: 0;
      z-index: 8;
      pointer-events:none;
    }

    .zw-top-axis{
      position:absolute;
      left: 50%;
      top: var(--axis-top);
      transform: translateX(-50%);
      display:flex;
      gap: var(--axis-gap);
      opacity: var(--zw-axis-op);
      filter: drop-shadow(0 14px 22px var(--zw-shadow));
      mix-blend-mode: normal;
    }
    .zw-axis-char{
      font-size: clamp(2.1rem, 4.0vw, 4.0rem);
      font-weight: 700;
      color: var(--zw-fill);
      -webkit-text-stroke: 1px var(--zw-stroke);
      text-shadow:
        0 10px 22px rgba(0,0,0,0.14),
        0 0 12px var(--zw-glow);
      paint-order: stroke fill;
    }

    .zw-side-col{
      position:absolute;
      top: var(--zen-side-cy);
      transform: translateY(-50%);
      writing-mode: vertical-rl;
      text-orientation: mixed;
      letter-spacing: .20em;
      font-size: clamp(1.25rem, 1.8vw, 2.0rem);

      color: rgba(255,240,210,0.46);
      -webkit-text-stroke: 1px rgba(78,40,12,0.20);
      text-shadow:
        0 14px 26px rgba(0,0,0,0.16),
        0 0 10px rgba(255,238,200,0.05);

      opacity: var(--zw-side-op);
      mix-blend-mode: normal;
      paint-order: stroke fill;
      white-space: nowrap;
    }

    /* âœ…ç”¨ max() ä¿åº•ï¼šä¸æœƒè¢«æ¨åˆ°å¤–æ¡†å¤–ã€Œçœ‹ä¸åˆ°ã€ */
    .zw-side-col.left{
      left: max(calc(var(--frame-inset) + 20px), calc(50% - var(--zen-side-cx)));
    }
    .zw-side-col.right{
      right: max(calc(var(--frame-inset) + 20px), calc(50% - var(--zen-side-cx)));
    }

    .zw-bottom-line{
      position:absolute;
      left:50%;
      bottom: var(--zw-bottom-pad);
      transform: translateX(-50%);
      font-size: clamp(0.95rem, 1.6vw, 1.5rem);
      letter-spacing: .35em;

      color: rgba(255,240,210,0.42);
      -webkit-text-stroke: 0.9px rgba(78,40,12,0.18);
      text-shadow:
        0 14px 26px rgba(0,0,0,0.14),
        0 0 10px rgba(255,238,200,0.05);

      opacity: var(--zw-bottom-op);
      white-space:nowrap;
      mix-blend-mode: normal;
      paint-order: stroke fill;
    }

    /* ========== å·¦ä¸Šä½¿ç”¨è€…åˆ—ï¼ˆé»ƒæ°´æ™¶ 3Dï¼Œå±¤ç´šæœ€é«˜ï¼‰ ========== */
    .user-bar{
      position:absolute;
      left: calc(var(--frame-inset) + 10px);
      top: calc(var(--frame-inset) + 10px);
      display:flex;
      gap: 10px;
      align-items:center;
      z-index: 10;
    }
    .user-pill{
      padding: 10px 14px;
      border-radius: 999px;
      background: rgba(0,0,0,0.18);
      border: 1px solid rgba(246,211,122,0.18);
      backdrop-filter: blur(var(--panel-blur));
      -webkit-backdrop-filter: blur(var(--panel-blur));
      font-size: 14px;
      letter-spacing: .06em;
      white-space:nowrap;
      box-shadow: 0 12px 26px rgba(0,0,0,0.24);
    }
    .btn-switch{
      border: 1px solid rgba(246,211,122,0.28);
      background: rgba(0,0,0,0.16);
      padding: 10px 14px;
      border-radius: 999px;
      cursor:pointer;
      backdrop-filter: blur(var(--panel-blur));
      -webkit-backdrop-filter: blur(var(--panel-blur));
      box-shadow: 0 12px 26px rgba(0,0,0,0.24);
      letter-spacing:.08em;
    }
    .btn-switch:hover{ background: rgba(0,0,0,0.22); }
    .btn-switch:focus{ outline: none; box-shadow: 0 0 0 2px rgba(246,211,122,0.14), 0 12px 26px rgba(0,0,0,0.24); }
    .btn-export{ opacity: .92; }

    /* ========== ä¸»è¦å°è¦½æŒ‰éµï¼ˆæ›´é€æ˜ + å­—æ›´æ¸…æ¥š + åå…‰ç¸®å°é¿å…æ´—å­—ï¼‰ ========== */
    .nav-area{
      position:absolute;
      inset: var(--frame-inset);
      z-index: 7;
      pointer-events:auto;
    }
    .nav-btn{
      display:flex;
      align-items:center;
      justify-content:center;
      text-decoration:none;

      border-radius: 999px;
      border: 1px solid var(--btn-border);

      background:
        radial-gradient(240px 90px at 26% 28%, rgba(255,255,255,var(--btn-glass-a)), rgba(0,0,0,0)),
        radial-gradient(240px 90px at 74% 30%, rgba(246,211,122,var(--btn-glass-b)), rgba(0,0,0,0)),
        linear-gradient(180deg, rgba(0,0,0,0.12), rgba(0,0,0,0.22));

      box-shadow:
        0 18px 44px rgba(0,0,0,0.40),
        inset 0 1px 0 rgba(255,255,255,0.05);

      backdrop-filter: blur(var(--btn-blur));
      -webkit-backdrop-filter: blur(var(--btn-blur));

      user-select:none;
      -webkit-tap-highlight-color: transparent;

      position: relative;
      overflow: hidden;
    }
    .nav-btn::before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(220px 70px at 30% 18%, rgba(255,255,255,0.06), rgba(0,0,0,0) 60%),
        radial-gradient(260px 90px at 70% 24%, rgba(246,211,122,0.05), rgba(0,0,0,0) 68%);
      opacity: .40;
      pointer-events:none;
    }
    .nav-btn span{
      padding: 0 16px;
      font-size: clamp(1.02rem, 1.65vw, 1.28rem);
      position:relative;
      z-index: 1;

      color: var(--txt-gold-strong);
      -webkit-text-stroke: 1.05px var(--txt-stroke);
      text-shadow:
        0 1px 0 rgba(0,0,0,0.18),
        0 3px 0 rgba(0,0,0,0.22),
        0 10px 22px var(--txt-shadow-1),
        0 0 14px var(--txt-glow);
      letter-spacing: .12em;
      font-weight: 800;
    }

    .nav-btn:hover{
      box-shadow:
        0 22px 54px rgba(0,0,0,0.46),
        0 0 20px rgba(246,211,122,0.10),
        inset 0 1px 0 rgba(255,255,255,0.07);
      border-color: rgba(255,244,210,0.45);
    }
    .nav-btn:focus{
      outline:none;
      box-shadow:
        0 0 0 2px rgba(246,211,122,0.14),
        0 22px 54px rgba(0,0,0,0.46);
    }

    .nav-area.arc .nav-btn{
      position:absolute;
      left: 50%;
      top: 0;
      transform: translate(calc(-50% + var(--x, 0px)), var(--y, 0px)) rotate(var(--rot, 0deg));
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      will-change: transform;
    }

    @media (max-width: 900px){
      .hero-inner{ min-height: 540px; }
      .nav-area{
        display:flex;
        flex-direction: column;
        gap: 14px;
        justify-content:flex-start;
        padding-top: var(--nav-top-m);
        padding-bottom: var(--nav-bottom-m);
      }
      .nav-btn{
        position:relative !important;
        left:auto !important;
        top:auto !important;
        transform:none !important;
        width: 100% !important;
        min-height: 58px;
        border-radius: 18px;
        backdrop-filter: blur(var(--btn-blur-m));
        -webkit-backdrop-filter: blur(var(--btn-blur-m));
      }
      /* æ‰‹æ©Ÿï¼šå´æ¬„ä¸é¡¯ç¤ºã€ä½†ä¸Š/ä¸‹ä»ä¿åº•å¯è¦‹ï¼ˆæ›´æ·¡ï¼‰ */
      .zw-side-col{ display:none; }
      :root{
        --zw-axis-op: 0.34;
        --zw-bottom-op: 0.34;
      }
    }

    /* ========== ç™»å…¥é®ç½©ï¼ˆç½®ä¸­ï¼‰ ========== */
    .login-overlay{
      position:fixed;
      inset:0;
      z-index: 3000;
      display:none;
      align-items:center;
      justify-content:center;

      background:
        radial-gradient(900px 560px at 50% 45%, rgba(0,0,0,0.34), rgba(0,0,0,0.66)),
        radial-gradient(1200px 760px at 50% 10%, rgba(246,211,122,0.10), rgba(0,0,0,0)),
        rgba(0,0,0,0.52);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }
    .login-box{
      width: min(520px, calc(100vw - 36px));
      border-radius: 22px;
      padding: 22px 22px 18px;

      background:
        linear-gradient(180deg, var(--login-solid-top), var(--login-solid-bot));
      border: 1px solid var(--login-border);
      box-shadow:
        0 26px 90px rgba(0,0,0,0.58),
        inset 0 1px 0 rgba(255,255,255,0.06);
    }
    .login-title{
      font-size: 1.35rem;
      margin-bottom: 10px;
      text-align:center;
    }
    .login-sub{
      text-align:center;
      min-height: 18px;
      font-size: 13px;
      opacity:.78;
      margin-bottom: 14px;
      color: rgba(255,238,190,0.85);
      letter-spacing:.06em;
    }
    .login-field{
      display:flex;
      flex-direction: column;
      gap: 8px;
      margin: 12px 0;
    }
    .login-field label{
      font-size: 13px;
      letter-spacing: .12em;
      color: rgba(255,238,190,0.80);
    }

    .login-pwd-wrapper{
      display:flex;
      gap: 10px;
      align-items:center;
    }
    .login-pwd-input{
      flex:1;
      padding: .74rem .92rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.72);
      background:
        linear-gradient(180deg, var(--login-field-bg2), rgba(0,0,0,0.00)),
        linear-gradient(180deg, var(--login-field-bg), rgba(0,0,0,0.40));
      color: var(--login-ink);
      caret-color: var(--login-ink);
      -webkit-text-stroke: .70px var(--login-stroke);
      text-shadow: 0 1px 0 var(--login-shadow-b), 0 4px 8px var(--login-shadow-a);
      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.06),
        0 12px 20px rgba(0,0,0,0.22);
      outline:none;
    }
    .login-pwd-input:focus{
      border-color: rgba(255,244,210,0.94);
      box-shadow:
        0 0 0 2px rgba(246,211,122,0.16),
        0 0 20px rgba(246,211,122,0.20),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .btn-eye-login{
      width: 42px;
      height: 42px;
      border-radius: 999px;
      border:1px solid rgba(246,211,122,0.52);
      background: rgba(0,0,0,0.24);
      color: rgba(255,238,190,0.92);
      cursor:pointer;
      box-shadow: 0 12px 22px rgba(0,0,0,0.26);
    }
    .btn-eye-login:focus{ outline:none; box-shadow: 0 0 0 2px rgba(246,211,122,0.16), 0 12px 22px rgba(0,0,0,0.26); }

    .login-error{
      min-height: 18px;
      color: rgba(255,180,150,0.98);
      font-size: 13px;
      letter-spacing: .06em;
      margin-top: 6px;
      text-align:center;
    }
    .login-actions{
      display:flex;
      gap: 12px;
      justify-content:center;
      margin-top: 14px;
    }
    .btn-login, .btn-secondary{
      border-radius: 999px;
      padding: 12px 18px;
      border: 1px solid rgba(246,211,122,0.52);
      background: rgba(0,0,0,0.22);
      cursor:pointer;
      letter-spacing: .12em;
      box-shadow: 0 16px 34px rgba(0,0,0,0.32);
    }
    .btn-login:hover, .btn-secondary:hover{ background: rgba(0,0,0,0.30); }
    .btn-login:focus, .btn-secondary:focus{ outline:none; box-shadow: 0 0 0 2px rgba(246,211,122,0.16), 0 16px 34px rgba(0,0,0,0.32); }

    /* ===========================
       âœ…âœ…âœ… è‡ªè£½ä¸‹æ‹‰ï¼ˆä½¿ç”¨è€…åç¨±ï¼‰
       =========================== */
    .select-wrap{ position:relative; width:100%; }
    .select-wrap select{
      position:absolute;
      inset:0;
      opacity:0;
      pointer-events:none;
    }

    .select-display{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:flex-start;
      text-align:left;

      padding: .74rem 2.60rem .74rem .92rem;
      border-radius:999px;
      border:1px solid rgba(246,211,122,0.72);

      background:
        linear-gradient(180deg, var(--login-field-bg2), rgba(0,0,0,0.00)),
        linear-gradient(180deg, var(--login-field-bg), rgba(0,0,0,0.40));

      color: var(--login-ink);
      caret-color: var(--login-ink);

      -webkit-text-stroke: .70px var(--login-stroke);
      text-shadow: 0 1px 0 var(--login-shadow-b), 0 4px 8px var(--login-shadow-a);

      box-shadow:
        inset 0 1px 0 rgba(255,255,255,0.06),
        0 12px 20px rgba(0,0,0,0.22);

      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      position:relative;
      appearance:none;
      backdrop-filter:none;
      -webkit-backdrop-filter:none;
    }
    .select-display::after{
      content:"â–¾";
      position:absolute;
      right: .95rem;
      top: 50%;
      transform: translateY(-50%);
      opacity:.92;
      font-size: 1.05rem;
      -webkit-text-stroke: .40px rgba(0,0,0,0.35);
      text-shadow: 0 2px 10px rgba(0,0,0,0.35);
      pointer-events:none;
    }
    .select-display:focus{
      outline:none;
      border-color: rgba(255,244,210,0.94);
      box-shadow:
        0 0 0 2px rgba(246,211,122,0.16),
        0 0 20px rgba(246,211,122,0.24),
        inset 0 1px 0 rgba(255,255,255,0.08);
    }
    .select-display[disabled]{
      opacity:.60;
      cursor:not-allowed;
    }

    .select-menu{
      position:absolute;
      left:0;
      right:0;
      top: calc(100% + 10px);
      max-height: 280px;
      overflow:auto;

      border-radius: 16px;
      border: 1px solid rgba(246,211,122,0.62);
      background: rgba(8,5,3,0.98);
      box-shadow: 0 22px 60px rgba(0,0,0,0.46), 0 0 24px rgba(246,211,122,0.10);

      display:none;
      z-index: 4005;
      padding: 6px;
    }
    .select-menu.open{ display:block; }

    .select-option{
      padding: .66rem .92rem;
      border-radius: 12px;
      cursor:pointer;
      color: rgba(246,211,122,0.98);
      letter-spacing:.06em;
      -webkit-text-stroke: .40px rgba(0,0,0,0.32);
      text-shadow: 0 2px 10px rgba(0,0,0,0.35);
      user-select:none;
      border: 1px solid transparent;
    }
    .select-option:hover{ background: rgba(255,244,210,0.10); }
    .select-option[aria-selected="true"]{
      background: rgba(246,211,122,0.14);
      border-color: rgba(246,211,122,0.20);
    }
    .select-option.active{
      background: rgba(255,244,210,0.14);
      border-color: rgba(255,244,210,0.22);
      outline: none;
    }
  </style>
</head>

<body class="locked booting">
  <div class="login-overlay" id="loginOverlay">
    <div class="login-box">
      <div class="login-title crystal-ui">Tasun è³‡æ–™ Â· ç™»å…¥</div>
      <div class="login-sub" id="loginSub"></div>

      <form id="loginForm">
        <div class="login-field">
          <label for="username">ä½¿ç”¨è€…åç¨±</label>

          <div class="select-wrap" id="usernameWrap">
            <select id="username" name="username" autocomplete="username"></select>
            <button type="button" class="select-display" id="usernameDisplay"
                    aria-haspopup="listbox" aria-expanded="false">
              è«‹é¸æ“‡ä½¿ç”¨è€…
            </button>
            <div class="select-menu" id="usernameMenu" role="listbox" aria-label="ä½¿ç”¨è€…åç¨±æ¸…å–®"></div>
          </div>
        </div>

        <div class="login-field">
          <label for="password">å¯†ç¢¼</label>
          <div class="login-pwd-wrapper">
            <input id="password" name="password" type="password" autocomplete="current-password" class="login-pwd-input" />
            <button type="button" class="btn-eye-login" id="btnTogglePwd">ğŸ‘</button>
          </div>
        </div>

        <div class="login-error" id="loginError"></div>

        <div class="login-actions">
          <button type="submit" class="btn-login crystal-ui">ç™»å…¥</button>
          <button type="button" class="btn-secondary crystal-ui" id="btnForceRelogin">åˆ‡æ›/é‡æ–°ç™»å…¥</button>
        </div>
      </form>
    </div>
  </div>

  <main class="hero">
    <div class="hero-inner" id="heroInner">
      <div class="ripple-film" aria-hidden="true"></div>
      <div class="mist-film" aria-hidden="true"></div>

      <div class="side-glass side-glass-left" aria-hidden="true"></div>
      <div class="side-glass side-glass-right" aria-hidden="true"></div>

      <div class="lotus-stage" id="lotusStage" aria-hidden="true">
        <div class="spotlight" aria-hidden="true"></div>
        <div class="zen-visual" aria-hidden="true">
          <img id="zenImg"
               src="ä½›æ•™ç¦ªæ„ä¸»è¦–è¦º.png?v=20260127_01"
               alt=""
               loading="eager"
               decoding="async"
               fetchpriority="high">
        </div>
      </div>

      <div class="zen-words" aria-hidden="true">
        <div class="zw-top-axis" id="zwTopAxis">
          <span class="zw-axis-char left">ç©º</span>
          <span class="zw-axis-char mid">ç„¡</span>
          <span class="zw-axis-char right">æ˜</span>
        </div>

        <div class="zw-side-col left">ç©ºå¯§ç„¡æˆ‘</div>
        <div class="zw-side-col right">æ¸…æ˜å¯§éœ</div>

        <div class="zw-bottom-line" id="zwBottomLine">ç©ºç„¡ã€€æ˜éœ</div>
      </div>

      <div class="user-bar" id="userBar">
        <div class="user-pill crystal-ui" id="userInfo" data-text="ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥">ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥</div>
        <button class="btn-switch crystal-ui" id="btnSwitchUser" type="button">åˆ‡æ›å¸³è™Ÿ</button>
        <button class="btn-switch btn-export crystal-ui" id="btnExport" type="button">åŒ¯å‡ºå‚™ä»½</button>
      </div>

      <div class="site-title-wrapper" id="titleWrap">
        <div class="site-title crystal-ui">Tasun è³‡æ–™</div>
      </div>

      <div class="nav-area" id="navArea"></div>
    </div>
  </main>

  <!-- âœ…âœ…âœ… å–®ä¸€åŠŸèƒ½ç¨‹å¼æ–¹å¡Šï¼šé›†ä¸­ç®¡ç†ï¼ˆå¯é€æ­¥æ¬åˆ° tasun-core.jsï¼Œä¸å½±éŸ¿çµæ§‹ï¼‰ -->
  <script>
  (function(){
    "use strict";

    /* =========================
       0) å°å·¥å…·ï¼ˆå„ªå…ˆç”¨ TasunCoreï¼‰
       ========================= */
    const Core = window.TasunCore || null;

    const withV = (Core && Core.withV) ? Core.withV : (window.__withV || ((u)=>u));
    const safeJsonParse = (Core && Core.jsonParse) ? Core.jsonParse : ((s,f)=>{ try{return JSON.parse(s);}catch(e){return f;} });
    const clamp = (Core && Core.clamp) ? Core.clamp : ((n,a,b)=>Math.max(a,Math.min(b,n)));
    const lerp  = (Core && Core.lerp)  ? Core.lerp  : ((a,b,t)=>a+(b-a)*t);

    const rafDebounce = (Core && Core.rafDebounce) ? Core.rafDebounce : (fn=>{
      let r=0; return function(){ cancelAnimationFrame(r); r=requestAnimationFrame(fn); };
    });
    const onFontsReady = (Core && Core.onFontsReady) ? Core.onFontsReady : (cb=>{
      if(document.fonts && document.fonts.ready) document.fonts.ready.then(cb);
      else setTimeout(cb, 180);
    });

    const $ = (sel) => document.querySelector(sel);

    /* =========================
       1) å¸¸æ•¸ / Key
       ========================= */
    const AUTH_KEY    = "tasunAuthTable_v1";
    const CURRENT_KEY = "tasunCurrentUser_v1";
    const SESSION_KEY = "tasunSessionLogin_v1";

    const NAV_KEY     = "tasunNavButtons_v1";
    const ROUTE_KEY   = "tasunNavRoutes_v1";

    const BACKUP_RING_KEY = "tasunBackupRing_v1";
    const BACKUP_RING_MAX = 10;

    const METRO_ID    = "btn2";
    const METRO_HREF  = "æ±æ±å·¥ç¨‹ç®¡ç†è¡¨.html";

    const FIXED_ROUTES = {
      "æ·é‹æ±æ±ç·šäº‹é …ç´€éŒ„": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
      "æ·é‹æ±æ±ç·šäº‹é …è¨˜éŒ„": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
      "æ·é‹æ±æ±ç·šäº‹é …ç´€éŒ„.html": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
      "æ·é‹æ±æ±ç·šäº‹é …è¨˜éŒ„.html": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
      "æ·é‹æ±æ±ç·šè¨˜äº‹": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
      "æ·é‹æ±æ±ç·šè¨˜äº‹.html": "æ·é‹æ±æ±ç·šè¨˜äº‹.html",
    };

    const LEGACY_BUTTON_KEYS = ["btn1","btn2","btn3","btn4","btn5"];

    /* =========================
       2) DOM
       ========================= */
    const loginOverlay = $("#loginOverlay");
    const loginForm    = $("#loginForm");
    const loginError   = $("#loginError");
    const loginSub     = $("#loginSub");
    const userInfo     = $("#userInfo");
    const btnSwitch    = $("#btnSwitchUser");
    const btnExport    = $("#btnExport");
    const btnTogglePwd = $("#btnTogglePwd");
    const btnForceRelogin = $("#btnForceRelogin");
    const navArea      = $("#navArea");
    const heroInner    = $("#heroInner");
    const titleWrap    = $("#titleWrap");
    const userBar      = $("#userBar");
    const zwBottomLine = $("#zwBottomLine");
    const lotusStage   = $("#lotusStage");

    /* ===== è‡ªè£½ä¸‹æ‹‰ï¼ˆéµç›¤ï¼‰ ===== */
    const usernameWrap = document.getElementById("usernameWrap");
    const usernameSel = document.getElementById("username");
    const usernameDisplay = document.getElementById("usernameDisplay");
    const usernameMenu = document.getElementById("usernameMenu");

    /* =========================
       3) åŸºç¤å‡½å¼
       ========================= */
    function hrefToDom(href){
      const h = String(href || "").trim();
      if(!h) return "#";
      if(/^https?:\/\//i.test(h)) return h;
      if(/^mailto:/i.test(h)) return h;
      return withV(encodeURI(h));
    }

    function labelToFile(label){
      let s = String(label || "").trim();
      if(!s) return "#";
      if(s.endsWith(".html")) return s;
      s = s.replace(/[\\\/:*?"<>|]/g, "").trim();
      s = s.replace(/\s+/g, "");
      return s + ".html";
    }

    function shouldIncludeKey(k){
      const key = String(k || "");
      return (
        key.startsWith("tasun") ||
        key.includes("æ±æ±") ||
        key.includes("æ·é‹") ||
        key.includes("æ°´ç’°") ||
        key.includes("å¯©æŸ¥") ||
        key.includes("æ–‡ä»¶") ||
        key.includes("è³‡æ–™åº«")
      );
    }

    /* =========================
       4) å‚™ä»½/ç›£è½ï¼ˆæ•ˆèƒ½ï¼šç¯€æµ + é˜²é‡è¤‡ patchï¼‰
       ========================= */
    function collectBackupPayload(reason){
      const now = new Date();
      const keys = [];
      for(let i=0;i<localStorage.length;i++){
        const k = localStorage.key(i);
        if(shouldIncludeKey(k)) keys.push(k);
      }
      keys.sort((a,b)=>a.localeCompare(b, "zh-Hant"));

      const data = {};
      keys.forEach(k => {
        const raw = localStorage.getItem(k);
        const parsed = safeJsonParse(raw, null);
        data[k] = (parsed === null && raw !== "null" && raw !== null) ? raw : parsed;
      });

      const sess = safeJsonParse(sessionStorage.getItem(SESSION_KEY) || "null", null);

      return {
        meta: {
          app: "Tasun index.html",
          reason: String(reason || "manual"),
          ts: now.toISOString(),
          href: location.href,
          cacheV: (window.__CACHE_V || "")
        },
        session: sess,
        data
      };
    }

    function storeBackupRing(payload){
      try{
        const arr = safeJsonParse(localStorage.getItem(BACKUP_RING_KEY) || "[]", []);
        const next = Array.isArray(arr) ? arr : [];
        next.unshift(payload);
        next.length = Math.min(next.length, BACKUP_RING_MAX);
        localStorage.setItem(BACKUP_RING_KEY, JSON.stringify(next));
      }catch(e){}
    }

    function downloadJson(payload){
      const ts = new Date().toISOString().replace(/[:.]/g, "-");
      const filename = `Tasunå‚™ä»½_${ts}.json`;
      const blob = new Blob([JSON.stringify(payload, null, 2)], { type: "application/json;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      a.style.display = "none";
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        URL.revokeObjectURL(url);
        a.remove();
      }, 0);
    }

    let _exportTimer = 0;
    let _pendingReason = "";
    let _exportOnceExit = false;

    function exportBackupNow(reason, opts){
      const o = opts || {};
      const payload = collectBackupPayload(reason);
      storeBackupRing(payload);
      if(o.download){
        try{ downloadJson(payload); }catch(e){}
      }
    }

    function scheduleExport(reason){
      const r = String(reason || "auto");
      _pendingReason = _pendingReason ? (_pendingReason + " | " + r) : r;
      clearTimeout(_exportTimer);
      _exportTimer = setTimeout(() => {
        const rr = _pendingReason || "auto";
        _pendingReason = "";
        exportBackupNow(rr, { download:false });
      }, 350);
    }

    function tryExportOnExit(){
      if(_exportOnceExit) return;
      _exportOnceExit = true;
      exportBackupNow("exit/pagehide", { download:false });
    }

    (function patchLocalStorageOnce(){
      try{
        if(localStorage.__tasun_patched__) return;
        Object.defineProperty(localStorage, "__tasun_patched__", { value: true, enumerable:false });

        const _set = localStorage.setItem.bind(localStorage);
        const _remove = localStorage.removeItem.bind(localStorage);

        localStorage.setItem = function(k, v){
          _set(k, v);
          if(shouldIncludeKey(k)) scheduleExport("save:setItem:" + k);
        };
        localStorage.removeItem = function(k){
          _remove(k);
          if(shouldIncludeKey(k)) scheduleExport("save:removeItem:" + k);
        };
      }catch(e){}
    })();

    window.addEventListener("storage", (e) => {
      if(!e || !e.key) return;
      if(shouldIncludeKey(e.key)) scheduleExport("storage:" + e.key);
    });

    window.addEventListener("pagehide", tryExportOnExit, { passive:true });
    document.addEventListener("visibilitychange", () => {
      if(document.visibilityState === "hidden") tryExportOnExit();
    }, { passive:true });

    /* =========================
       5) Routes / Nav
       ========================= */
    function applyFixedRoutes(obj){
      const out = (obj && typeof obj === "object") ? { ...obj } : {};
      Object.keys(FIXED_ROUTES).forEach(k => { out[k] = FIXED_ROUTES[k]; });
      out[METRO_ID] = METRO_HREF;
      out["systemBtn"] = out["systemBtn"] || "æ¬Šé™è¡¨.html";
      return out;
    }

    function loadRoutes(){
      const seed = applyFixedRoutes({
        "btn3": "https://www.dropbox.com/",
        "systemBtn": "æ¬Šé™è¡¨.html",
        [METRO_ID]: METRO_HREF
      });

      const raw = localStorage.getItem(ROUTE_KEY);
      if(!raw){
        localStorage.setItem(ROUTE_KEY, JSON.stringify(seed, null, 2));
        return seed;
      }

      const parsed = safeJsonParse(raw, null);
      const base = (parsed && typeof parsed === "object") ? parsed : {};
      const merged = applyFixedRoutes({ ...base, ...seed });

      if(JSON.stringify(base) !== JSON.stringify(merged)){
        localStorage.setItem(ROUTE_KEY, JSON.stringify(merged, null, 2));
      }
      return merged;
    }

    function loadNavButtonsSeedIfMissing(){
      const seed = [
        { id:"btn1", label:"è‡»é¼æ™‚ä»£å¤§å»ˆç®¡ç†è¡¨" },
        { id:"btn2", label:"æ·é‹æ±æ­¢æ±æ¹–ç·š" },
        { id:"btn3", label:"é›²ç«¯æª”æ¡ˆ" },
        { id:"btn4", label:"å·¥ç¨‹è³‡æ–™åº«" },
        { id:"btn5", label:"è³‡æ–™åº«" }
      ];
      const raw = localStorage.getItem(NAV_KEY);
      if(!raw){
        localStorage.setItem(NAV_KEY, JSON.stringify(seed));
        return seed;
      }
      const arr = safeJsonParse(raw, null);
      if(Array.isArray(arr) && arr.length) return arr;
      localStorage.setItem(NAV_KEY, JSON.stringify(seed));
      return seed;
    }

    function resolveHref(cfg, routes){
      const id = String(cfg?.id || "").trim();
      const label = String(cfg?.label || "").trim();

      if(label && FIXED_ROUTES[label]) return FIXED_ROUTES[label];

      if(id === METRO_ID) return METRO_HREF;
      if(routes && routes[id]) return routes[id];
      if(routes && label && routes[label]) return routes[label];

      const guess = labelToFile(label);
      if(FIXED_ROUTES[guess]) return FIXED_ROUTES[guess];
      return guess;
    }

    /* =========================
       6) Auth
       ========================= */
    function getDefaultAuthTableLegacy(btnCount){
      const keys = Array.from({length: btnCount}, (_, i) => `btn${i+1}`);
      const mkAll = () => Object.fromEntries(keys.map(k => [k, true]));
      const mkOnlyLast = () => Object.fromEntries(keys.map((k, i) => [k, i === btnCount - 1]));
      return [
        { user:"alex",  pass:"Tasun08040224", role:"admin", ...mkAll() },
        { user:"JOYCE", pass:"09220224",      role:"admin", ...mkAll() },
        { user:"tasun", pass:"tasun08040224", role:"write", ...mkAll() },
        { user:"wu",    pass:"123456",        role:"read",  ...mkOnlyLast() }
      ];
    }

    function normalizeRowFromStorage(row, btnCount){
      const username = (row?.username ?? row?.user ?? row?.name ?? row?.account ?? "").toString().trim();
      const password = (row?.password ?? row?.pass ?? "").toString();
      const level    = (row?.level ?? row?.role ?? "read").toString().trim().toLowerCase();

      const buttons = [];
      for(let i=0;i<btnCount;i++){
        const k = `btn${i+1}`;
        buttons[i] = !!row?.[k];
      }
      return { username, password, level, buttons };
    }

    function loadAuthTable(btnCount){
      const raw = localStorage.getItem(AUTH_KEY);
      if(!raw){
        const legacy = getDefaultAuthTableLegacy(btnCount);
        localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
        return legacy.map(r => normalizeRowFromStorage(r, btnCount));
      }
      const parsed = safeJsonParse(raw, null);
      const arr = Array.isArray(parsed) ? parsed : (parsed && Array.isArray(parsed.users) ? parsed.users : null);
      if(Array.isArray(arr)){
        const mapped = arr.map(r => normalizeRowFromStorage(r, btnCount)).filter(x => x.username);
        if(mapped.length) return mapped;
      }
      const legacy = getDefaultAuthTableLegacy(btnCount);
      localStorage.setItem(AUTH_KEY, JSON.stringify(legacy));
      return legacy.map(r => normalizeRowFromStorage(r, btnCount));
    }

    function setSession(user){
      try{ sessionStorage.setItem(SESSION_KEY, JSON.stringify({ user: user.username, role: user.level, t: Date.now() })); }catch(e){}
    }
    function clearSession(){ try{ sessionStorage.removeItem(SESSION_KEY); }catch(e){} }
    function getSession(){
      const obj = safeJsonParse(sessionStorage.getItem(SESSION_KEY) || "null", null);
      if(!obj || typeof obj !== "object") return null;
      const u = String(obj.user || "").trim();
      const r = String(obj.role || "").trim().toLowerCase();
      if(!u) return null;
      return { user: u, role: r, t: Number(obj.t || 0) };
    }

    /* =========================
       7) Username pickerï¼ˆåŸåŠŸèƒ½ä¿ç•™ï¼‰
       ========================= */
    let _userActiveIndex = -1;
    let _typeBuf = "";
    let _typeTimer = 0;

    function menuItems(){
      return Array.from(usernameMenu ? usernameMenu.querySelectorAll(".select-option") : []);
    }
    function isMenuOpen(){
      return !!(usernameMenu && usernameMenu.classList.contains("open"));
    }
    function closeUsernameMenu(){
      if(!usernameMenu) return;
      usernameMenu.classList.remove("open");
      if(usernameDisplay) usernameDisplay.setAttribute("aria-expanded", "false");
      _userActiveIndex = -1;
      _typeBuf = "";
    }
    function openUsernameMenu(){
      if(!usernameMenu || !usernameDisplay) return;
      if(usernameDisplay.disabled) return;

      usernameMenu.classList.add("open");
      usernameDisplay.setAttribute("aria-expanded", "true");

      const items = menuItems();
      if(!items.length) return;

      const idx = items.findIndex(it => (it.dataset.value || "") === (usernameSel.value || ""));
      setActiveIndex(idx >= 0 ? idx : 0, true);
    }
    function toggleUsernameMenu(){
      if(isMenuOpen()) closeUsernameMenu();
      else openUsernameMenu();
    }

    function syncUsernameDisplay(){
      if(!usernameSel || !usernameDisplay) return;
      const opt = usernameSel.options[usernameSel.selectedIndex];
      const txt = opt ? String(opt.textContent || "").trim() : "";
      if(!txt || (opt && opt.disabled)){
        usernameDisplay.textContent = "è«‹é¸æ“‡ä½¿ç”¨è€…";
      }else{
        usernameDisplay.textContent = txt;
      }
    }

    function selectByValue(val){
      if(!val) return;
      usernameSel.value = val;
      syncUsernameDisplay();
      const items = menuItems();
      items.forEach(it => it.setAttribute("aria-selected", (it.dataset.value === val) ? "true" : "false"));
    }

    function setActiveIndex(nextIndex, scrollIntoView){
      const items = menuItems();
      if(!items.length) { _userActiveIndex = -1; return; }

      const n = items.length;
      let idx = nextIndex;
      if(idx < 0) idx = 0;
      if(idx >= n) idx = n - 1;

      _userActiveIndex = idx;
      items.forEach((it, i) => it.classList.toggle("active", i === idx));

      if(scrollIntoView){
        try{ items[idx].scrollIntoView({ block:"nearest" }); }catch(e){}
      }
    }

    function buildUsernameMenu(){
      if(!usernameMenu || !usernameSel || !usernameDisplay) return;
      usernameMenu.innerHTML = "";

      const opts = Array.from(usernameSel.options || []);
      const usable = opts.filter(o => !o.disabled && String(o.value||"").trim());

      if(!usable.length){
        usernameDisplay.textContent = "ï¼ˆå°šç„¡ä½¿ç”¨è€…ï¼Œè«‹å…ˆåˆ°ã€Œç³»çµ± / æ¬Šé™ã€æ–°å¢ï¼‰";
        usernameDisplay.disabled = true;
        closeUsernameMenu();
        return;
      }

      usernameDisplay.disabled = false;

      usable.forEach((o, i) => {
        const item = document.createElement("div");
        item.className = "select-option";
        item.setAttribute("role", "option");
        item.dataset.value = o.value;
        item.textContent = o.textContent;

        const selected = (o.value === usernameSel.value);
        item.setAttribute("aria-selected", selected ? "true" : "false");

        item.addEventListener("mouseenter", () => {
          if(isMenuOpen()) setActiveIndex(i, false);
        });

        item.addEventListener("click", () => {
          selectByValue(o.value);
          closeUsernameMenu();
          usernameDisplay.focus();
        });

        usernameMenu.appendChild(item);
      });
    }

    function refreshUsernamePicker(){
      if(!usernameSel) return;

      const opt = usernameSel.options[usernameSel.selectedIndex];
      if(opt && opt.disabled){
        const first = Array.from(usernameSel.options).find(o => !o.disabled && String(o.value||"").trim());
        if(first) usernameSel.value = first.value;
      }

      syncUsernameDisplay();
      buildUsernameMenu();
    }

    if(usernameDisplay){
      usernameDisplay.addEventListener("click", toggleUsernameMenu);

      usernameDisplay.addEventListener("keydown", (e) => {
        if(usernameDisplay.disabled) return;

        const key = e.key;

        if(key === "ArrowDown" || key === "ArrowUp"){
          e.preventDefault();
          if(!isMenuOpen()) openUsernameMenu();
          const items = menuItems();
          if(!items.length) return;

          const dir = (key === "ArrowDown") ? 1 : -1;
          const next = (_userActiveIndex < 0) ? 0 : (_userActiveIndex + dir);
          setActiveIndex(next, true);
          return;
        }

        if(key === "Enter"){
          e.preventDefault();
          if(!isMenuOpen()){
            openUsernameMenu();
            return;
          }
          const items = menuItems();
          if(!items.length) return;

          const idx = (_userActiveIndex >= 0) ? _userActiveIndex : 0;
          const val = items[idx]?.dataset?.value || "";
          if(val) selectByValue(val);
          closeUsernameMenu();
          return;
        }

        if(key === "Escape"){
          e.preventDefault();
          closeUsernameMenu();
          return;
        }

        if(key && key.length === 1 && !e.ctrlKey && !e.metaKey && !e.altKey){
          if(!isMenuOpen()) openUsernameMenu();
          _typeBuf += key.toLowerCase();
          clearTimeout(_typeTimer);
          _typeTimer = setTimeout(()=>{ _typeBuf=""; }, 650);

          const items = menuItems();
          const idx = items.findIndex(it => String(it.textContent||"").trim().toLowerCase().startsWith(_typeBuf));
          if(idx >= 0) setActiveIndex(idx, true);
        }
      });
    }

    document.addEventListener("click", (e) => {
      if(!usernameWrap || !usernameMenu) return;
      if(isMenuOpen() && !usernameWrap.contains(e.target)){
        closeUsernameMenu();
      }
    });

    document.addEventListener("keydown", (e) => {
      if(e.key === "Escape") closeUsernameMenu();
    });

    /* =========================
       8) ä¸»æŒ‰éµå»ºç«‹ + æ¬Šé™
       ========================= */
    let AUTH_TABLE = [];
    let ROUTES = loadRoutes();
    let NAV_ARR = loadNavButtonsSeedIfMissing();

    const ROLE_MAP = {
      "btn1": ["admin","write","read"],
      "btn2": ["admin","write","read"],
      "btn3": ["admin","write","read"],
      "btn4": ["admin","write"],
      "btn5": ["admin","write","read"],
      "systemBtn": ["admin"]
    };

    const SYSTEM_BTN = { id:"systemBtn", label:"ç³»çµ± / æ¬Šé™", roles:["admin"] };

    let BTN_CONFIGS = [];
    let mainNavBtns = [];

    function isRoleAllowed(cfg, level){
      if(!cfg || !Array.isArray(cfg.roles)) return true;
      return cfg.roles.includes(level);
    }
    function isAllowedByAuth(user, cfg){
      if(cfg && cfg.id === "systemBtn") return true;
      const flags = Array.isArray(user.buttons) ? user.buttons : [];
      const m = String(cfg?.id || "").match(/^btn(\d+)$/i);
      if(!m) return true;
      const idx = parseInt(m[1], 10) - 1;
      return (flags[idx] === undefined) ? true : !!flags[idx];
    }

    function populateUserSelect(){
      AUTH_TABLE = loadAuthTable(LEGACY_BUTTON_KEYS.length);
      usernameSel.innerHTML = "";

      if(!AUTH_TABLE.length){
        const opt = document.createElement("option");
        opt.value = "";
        opt.textContent = "ï¼ˆå°šç„¡ä½¿ç”¨è€…ï¼Œè«‹å…ˆåˆ°ã€Œç³»çµ± / æ¬Šé™ã€æ–°å¢ï¼‰";
        opt.disabled = true;
        opt.selected = true;
        usernameSel.appendChild(opt);
        refreshUsernamePicker();
        return;
      }

      const ph = document.createElement("option");
      ph.value = "";
      ph.textContent = "è«‹é¸æ“‡ä½¿ç”¨è€…";
      ph.disabled = true;
      ph.selected = true;
      usernameSel.appendChild(ph);

      const names = Array.from(new Set(AUTH_TABLE.map(r => r.username).filter(Boolean)));
      names.sort((a,b)=>a.localeCompare(b, "zh-Hant"));
      names.forEach(name => {
        const opt = document.createElement("option");
        opt.value = name;
        opt.textContent = name;
        usernameSel.appendChild(opt);
      });

      refreshUsernamePicker();
    }

    function buildMainButtons(){
      ROUTES = loadRoutes();
      NAV_ARR = loadNavButtonsSeedIfMissing();

      BTN_CONFIGS = NAV_ARR.map(x => {
        const id = String(x?.id || "").trim();
        const label = String(x?.label || "").trim();
        const roles = ROLE_MAP[id] || ["admin","write","read"];
        const target = (id === "btn3") ? "_blank" : "";
        return { id, label, roles, target };
      }).concat([SYSTEM_BTN]);

      mainNavBtns = [];
      navArea.innerHTML = "";

      BTN_CONFIGS.forEach((cfg) => {
        const a = document.createElement("a");
        a.className = "nav-btn";
        a.id = cfg.id || "";

        const span = document.createElement("span");
        span.textContent = cfg.label;
        a.appendChild(span);

        const finalHref = resolveHref(cfg, ROUTES);
        a.setAttribute("href", hrefToDom(finalHref));

        const t = cfg.target || "";
        if(t){
          a.target = t;
          if(t === "_blank") a.rel = "noopener noreferrer";
        }

        a.style.display = "none";
        navArea.appendChild(a);
        mainNavBtns.push(a);
      });

      scheduleAll();
    }

    function resetButtonsForLogout(){
      mainNavBtns.forEach(btn => btn.style.display = "none");
      navArea.classList.remove("arc");
      scheduleAll();
    }

    /* =========================
       9) Login flow
       ========================= */
    function showLogin(){
      document.body.classList.add("locked");
      loginOverlay.style.display = "flex";
      loginError.textContent = "";
      loginSub.textContent = "";
      $("#password").value = "";

      populateUserSelect();
      resetButtonsForLogout();

      userInfo.textContent = "ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥";
      userInfo.setAttribute("data-text", "ç›®å‰ä½¿ç”¨è€…ï¼šæœªç™»å…¥");

      autoEnterIfSessionValid();
      touchLayout();

      setTimeout(() => { try{ usernameDisplay && usernameDisplay.focus(); }catch(e){} }, 0);
    }

    function autoEnterIfSessionValid(){
      const sess = getSession();
      if(!sess) return;

      const u = AUTH_TABLE.find(r => r.username === sess.user);
      if(!u){ clearSession(); return; }
      if(String(u.level||"").toLowerCase() !== String(sess.role||"").toLowerCase()){
        clearSession(); return;
      }

      loginSub.textContent = `å·²ç™»å…¥ï¼š${u.username}ï¼ˆ${u.level}ï¼‰â€¦ æ­£åœ¨é€²å…¥`;
      setTimeout(() => {
        if(!getSession()) return;
        applyUser(u);
      }, 150);
    }

    function applyUser(user){
      document.body.classList.remove("locked");
      loginOverlay.style.display = "none";
      loginSub.textContent = "";

      setSession(user);
      localStorage.setItem(CURRENT_KEY, JSON.stringify({ user: user.username, role: user.level }));

      const t = `ç›®å‰ä½¿ç”¨è€…ï¼š${user.username} (${user.level})`;
      userInfo.textContent = t;
      userInfo.setAttribute("data-text", t);

      buildMainButtons();

      mainNavBtns.forEach((btn, index) => {
        const cfg = BTN_CONFIGS[index];
        const okRole = isRoleAllowed(cfg, user.level);
        const okAuth = isAllowedByAuth(user, cfg);

        btn.style.display = (okRole && okAuth) ? "flex" : "none";

        const finalHref = resolveHref(cfg, ROUTES);
        btn.setAttribute("href", hrefToDom(finalHref));
      });

      scheduleExport("login:applyUser");
      touchLayout();
    }

    /* =========================
       10) æ’ç‰ˆï¼šå¼§å½¢æŒ‰éµ + ç¦ªå­—ä¿åº•ï¼ˆå·¦/å³/ä¸‹å¯è¦‹ï¼‰
       ========================= */
    function fitButtonHeights(btns, baseH){
      btns.forEach(btn => {
        const span = btn.querySelector("span");
        if(!span) return;
        btn.style.height = "auto";
        const need = Math.ceil(span.scrollHeight + 26);
        const h = Math.max(baseH, need);
        btn.style.height = h + "px";
      });
    }

    function syncZenBottomPad(){
      if(!heroInner) return;

      const isDesktop = window.matchMedia("(min-width: 901px)").matches;
      const hi = heroInner.getBoundingClientRect();
      const frameInset = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--frame-inset")) || 16;

      let pad = frameInset + 14;

      if(isDesktop){
        const visible = mainNavBtns.filter(b => b.style.display !== "none");
        if(visible.length){
          // å–ã€Œæœ€ä¸‹é¢é‚£é¡†æŒ‰éµã€çš„ topï¼Œè®“ä¸‹æ–¹ç¦ªå­—é¿é–‹å®ƒï¼ˆç¢ºä¿å¯è¦‹ï¼‰
          let maxBottomBtn = null;
          let maxBottom = -1;
          visible.forEach(btn=>{
            const r = btn.getBoundingClientRect();
            if(r.bottom > maxBottom){
              maxBottom = r.bottom;
              maxBottomBtn = r;
            }
          });
          if(maxBottomBtn){
            const desiredBottom = maxBottomBtn.top - 12;     // ç¦ªå­—åº•ç·šè¦åœ¨æŒ‰éµä¸Šæ–¹ 12px
            const needPad = (hi.bottom - desiredBottom);     // bottom: pad
            pad = Math.max(pad, needPad);
          }
        }
      }

      pad = clamp(pad, frameInset + 10, 240);
      document.documentElement.style.setProperty("--zw-bottom-pad", `${Math.round(pad)}px`);
    }

    function layoutArcButtons(){
      const isDesktop = window.matchMedia("(min-width: 901px)").matches;
      if(!isDesktop){
        navArea.classList.remove("arc");
        syncZenBottomPad();
        return;
      }

      const visible = mainNavBtns.filter(b => b.style.display !== "none");
      if(!visible.length){
        navArea.classList.remove("arc");
        syncZenBottomPad();
        return;
      }

      navArea.classList.add("arc");

      const rect = navArea.getBoundingClientRect();
      const H = Math.max(1, rect.height);
      const W = Math.max(1, rect.width);

      const centerY = H * 0.56;

      const topMargin = clamp(H * 0.14, 64, 132);
      const botMargin = clamp(H * 0.12, 56, 124);

      const baseH = clamp(H * 0.12, 62, 92);

      visible.forEach(btn => {
        const span = btn.querySelector("span");
        const textW = span ? span.getBoundingClientRect().width : 240;

        const minW = clamp(W * 0.26, 280, 390);
        const maxW = clamp(W * 0.48, 420, 680);
        const targetW = clamp(textW + 190, minW, maxW);

        btn.style.width = targetW + "px";
      });

      fitButtonHeights(visible, baseH);

      const keepoutCX = clamp(W * 0.20, 200, 360);
      const keepoutW  = clamp(W * 0.12, 110, 190);
      const keepoutY1 = clamp(H * 0.30, 140, 260);
      const keepoutY2 = clamp(H * 0.78, 440, 840);

      const ls = lotusStage ? lotusStage.getBoundingClientRect() : null;

      // âœ…ç¦ªå­—å·¦å³ä½ç½®ï¼šç”¨èˆå°å¯¬åº¦æ¨ç®—ï¼Œä½†è¦ã€Œä¿åº•ä¸å‡ºç•Œã€
      let zenSideCX = clamp(W * 0.26, 220, 380);
      if(ls){
        zenSideCX = clamp(ls.width * 0.33, 210, 390);
      }
      // ä¿åº•ï¼šå·¦(50%-cx) ä¸èƒ½å°æ–¼ frameInset+20
      const frameInset = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--frame-inset")) || 16;
      const cxMax = Math.max(210, (W/2) - (frameInset + 42));
      zenSideCX = clamp(zenSideCX, 210, cxMax);
      document.documentElement.style.setProperty("--zen-side-cx", Math.round(zenSideCX) + "px");

      const left = [];
      const right = [];
      visible.forEach((btn, i) => (i % 2 === 0 ? left : right).push(btn));

      const yMin = topMargin;
      const yMax = H - botMargin;

      const angleMin = -56 * Math.PI / 180;
      const angleMax =  56 * Math.PI / 180;

      const Ry = (yMax - yMin) * 0.50;

      const baseX = clamp(W * 0.46, 360, (W/2) - 210);
      const bulge = clamp(W * 0.18, 120, 220);

      function neededAbsXToAvoidKeepout(bw, bh, y){
        const yTop = y - bh/2;
        const yBot = y + bh/2;
        const overlapY = !(yBot < keepoutY1 || yTop > keepoutY2);
        if(!overlapY) return 0;
        const margin = 28;
        return keepoutCX + keepoutW/2 + bw/2 + margin;
      }

      function place(btn, sideSign, i, count){
        const t = (count <= 1) ? 0.5 : (i / (count - 1));
        const ang = lerp(angleMin, angleMax, t);

        const bw = btn.getBoundingClientRect().width || 380;
        const bh = btn.getBoundingClientRect().height || baseH;

        let y = centerY + Math.sin(ang) * Ry;
        y = clamp(y, yMin, yMax);

        let xAbs = baseX + Math.cos(ang) * bulge;

        const maxAbsX = (W/2) - (bw/2) - 42;
        xAbs = clamp(xAbs, 240, maxAbsX);

        const needK = neededAbsXToAvoidKeepout(bw, bh, y);
        if(needK > 0) xAbs = Math.max(xAbs, needK);

        xAbs = clamp(xAbs, 240, maxAbsX);

        const rot = sideSign * (Math.sin(ang) * 5.6);

        btn.style.setProperty("--x", `${sideSign * xAbs}px`);
        btn.style.setProperty("--y", `${y}px`);
        btn.style.setProperty("--rot", `${rot}deg`);
      }

      left.forEach((btn, i) => place(btn, -1, i, left.length));
      right.forEach((btn, i) => place(btn,  1, i, right.length));

      // âœ…æ’å®ŒæŒ‰éµå¾Œï¼Œå†ä¿åº•ä¸‹æ–¹ç¦ªå­—ä¸è¢«é®ä½
      syncZenBottomPad();
    }

    function applyMobileKeepout(){
      if(!window.matchMedia("(max-width: 900px)").matches) return;
      if(!heroInner || !navArea) return;

      const hi = heroInner.getBoundingClientRect();
      const ub = userBar ? userBar.getBoundingClientRect() : null;
      const tw = titleWrap ? titleWrap.getBoundingClientRect() : null;
      const bl = zwBottomLine ? zwBottomLine.getBoundingClientRect() : null;

      const safeTop = hi.top;
      const safeBottom = hi.bottom;

      let topNeed = 0;
      if(ub) topNeed = Math.max(topNeed, (ub.bottom - safeTop) + 10);
      if(tw) topNeed = Math.max(topNeed, (tw.bottom - safeTop) + 10);

      const frameInset = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--frame-inset")) || 16;
      topNeed = Math.max(topNeed, frameInset + 64);

      let bottomNeed = frameInset + 18;
      if(bl){
        const gap = 10;
        bottomNeed = Math.max(bottomNeed, (safeBottom - bl.top) + gap);
      }

      document.documentElement.style.setProperty("--nav-top-m",  `${Math.round(topNeed)}px`);
      document.documentElement.style.setProperty("--nav-bottom-m", `${Math.round(bottomNeed)}px`);

      // âœ…æ‰‹æ©Ÿï¼šä¸‹æ–¹ç¦ªå­—ä¹Ÿè·Ÿè‘—ä¿åº•ï¼ˆé¿å…è¢«æŒ‰éµ/å®‰å…¨å€åƒæ‰ï¼‰
      document.documentElement.style.setProperty("--zw-bottom-pad", `${Math.round(bottomNeed + 6)}px`);
    }

    function syncZenWordsToArrow(){
      if(!heroInner) return;

      const hi = heroInner.getBoundingClientRect();
      const tw = titleWrap ? titleWrap.getBoundingClientRect() : null;
      const ls = lotusStage ? lotusStage.getBoundingClientRect() : null;

      let topFromTitle = tw ? ((tw.bottom - hi.top) + 16) : 140;
      let topNearLotus = ls ? ((ls.top - hi.top) + (ls.height * 0.18)) : (hi.height * 0.28);

      let top = Math.max(topFromTitle, Math.min(topNearLotus, topFromTitle + 90));

      const minTop = 110;
      const maxTop = ls ? ((ls.top - hi.top) + (ls.height * 0.30)) : (hi.height * 0.38);
      top = clamp(top, minTop, maxTop);
      document.documentElement.style.setProperty("--axis-top", `${Math.round(top)}px`);

      if(ls){
        let cy = (ls.top - hi.top) + (ls.height * 0.58);
        cy = clamp(cy, hi.height * 0.30, hi.height * 0.80);
        document.documentElement.style.setProperty("--zen-side-cy", `${Math.round(cy)}px`);

        const frameInset = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--frame-inset")) || 16;

        let cx = clamp(ls.width * 0.33, 210, 390);
        const cxMax = Math.max(210, (hi.width/2) - (frameInset + 42));
        cx = clamp(cx, 210, cxMax);
        document.documentElement.style.setProperty("--zen-side-cx", `${Math.round(cx)}px`);

        let gap = clamp(ls.width * 0.16, 96, 240);
        document.documentElement.style.setProperty("--axis-gap", `${Math.round(gap)}px`);
      }
    }

    const scheduleLayout = rafDebounce(layoutArcButtons);
    const scheduleAxisTop = rafDebounce(syncZenWordsToArrow);
    const scheduleMobileKeepout = rafDebounce(applyMobileKeepout);

    function scheduleAll(){ scheduleLayout(); scheduleMobileKeepout(); scheduleAxisTop(); }
    function touchLayout(){ scheduleMobileKeepout(); scheduleAxisTop(); scheduleLayout(); }

    /* =========================
       11) å•Ÿå‹•
       ========================= */
    AUTH_TABLE = loadAuthTable(LEGACY_BUTTON_KEYS.length);
    buildMainButtons();
    showLogin();

    requestAnimationFrame(() => {
      document.body.classList.remove("booting");
      scheduleAll();
      onFontsReady(() => { scheduleAxisTop(); scheduleLayout(); });
    });

    /* =========================
       12) äº‹ä»¶
       ========================= */
    loginForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const username = usernameSel.value;
      const password = $("#password").value;

      if(!username){
        loginError.textContent = "è«‹å…ˆé¸æ“‡ä½¿ç”¨è€…åç¨±ã€‚";
        return;
      }
      const user = AUTH_TABLE.find(row => row.username === username && row.password === password);
      if(!user){
        loginError.textContent = "å¸³è™Ÿæˆ–å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡ã€‚";
        return;
      }
      loginError.textContent = "";
      applyUser(user);
      $("#password").value = "";
    });

    btnForceRelogin.addEventListener("click", () => {
      clearSession();
      loginSub.textContent = "è«‹é‡æ–°è¼¸å…¥å¯†ç¢¼ç™»å…¥";
      loginError.textContent = "";
      const pwd = $("#password");
      pwd.value = "";
      pwd.focus();
      touchLayout();
    });

    btnSwitch.addEventListener("click", () => {
      clearSession();
      localStorage.removeItem(CURRENT_KEY);
      showLogin();
      scheduleExport("switchUser");
    });

    btnTogglePwd.addEventListener("click", () => {
      const pwd = $("#password");
      pwd.type = (pwd.type === "password") ? "text" : "password";
    });

    btnExport.addEventListener("click", () => {
      exportBackupNow("manual:button", { download:true });
    });

    window.addEventListener("resize", () => { scheduleAll(); }, { passive:true });
    if(window.visualViewport){
      window.visualViewport.addEventListener("resize", () => { scheduleAll(); }, { passive:true });
      // âœ…é¿å…æ»¾å‹•å¤ªé »ç¹é€ æˆæŠ–å‹•ï¼šä»ä¿ç•™ï¼Œä½†ä½¿ç”¨ rafDebounce çš„ scheduleAllï¼ˆå·²ç¯€æµï¼‰
      window.visualViewport.addEventListener("scroll", () => { scheduleAll(); }, { passive:true });
    }
  })();
  </script>
</body>
</html>
